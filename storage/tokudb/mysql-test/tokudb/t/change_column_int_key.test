source include/have_tokudb.inc;
# this test is generated by change_int_key.py
# ensure that changing an int column that is part of a key is not hot
--disable_warnings
DROP TABLE IF EXISTS t;
--enable_warnings
SET SESSION DEFAULT_STORAGE_ENGINE="TokuDB";
SET SESSION TOKUDB_DISABLE_SLOW_ALTER=1;

CREATE TABLE t (a TINYINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a SMALLINT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a SMALLINT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a SMALLINT;
DROP TABLE t;

CREATE TABLE t (a TINYINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT;
DROP TABLE t;

CREATE TABLE t (a TINYINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;

CREATE TABLE t (a TINYINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a TINYINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;

CREATE TABLE t (a SMALLINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT;
DROP TABLE t;
CREATE TABLE t (a SMALLINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT;
DROP TABLE t;
CREATE TABLE t (a SMALLINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT;
DROP TABLE t;

CREATE TABLE t (a SMALLINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;
CREATE TABLE t (a SMALLINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;
CREATE TABLE t (a SMALLINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;

CREATE TABLE t (a SMALLINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a SMALLINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a SMALLINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;

CREATE TABLE t (a MEDIUMINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT;
DROP TABLE t;

CREATE TABLE t (a MEDIUMINT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;

CREATE TABLE t (a INT, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a INT, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;
CREATE TABLE t (a INT, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT;
DROP TABLE t;

CREATE TABLE t (a TINYINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a SMALLINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a SMALLINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a SMALLINT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a TINYINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a TINYINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a TINYINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a TINYINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a SMALLINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a SMALLINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a SMALLINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a MEDIUMINT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a SMALLINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a SMALLINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a SMALLINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a SMALLINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a SMALLINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a SMALLINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a MEDIUMINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a INT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a MEDIUMINT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a MEDIUMINT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;

CREATE TABLE t (a INT UNSIGNED, PRIMARY KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a INT UNSIGNED, KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
CREATE TABLE t (a INT UNSIGNED, CLUSTERING KEY(a));
--replace_regex /MariaDB/XYZ/ /MySQL/XYZ/
--error ER_UNSUPPORTED_EXTENSION
ALTER TABLE t CHANGE COLUMN a a BIGINT UNSIGNED;
DROP TABLE t;
