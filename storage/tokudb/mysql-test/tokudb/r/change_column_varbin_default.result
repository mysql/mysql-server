DROP TABLE IF EXISTS t;
SET SESSION TOKUDB_DISABLE_SLOW_ALTER=ON;
CREATE TABLE t (a VARBINARY(100) NOT NULL DEFAULT '', b VARBINARY(256) NOT NULL DEFAULT '') ENGINE=TokuDB;
SHOW CREATE TABLE t;
Table	Create Table
t	CREATE TABLE `t` (
  `a` varbinary(100) NOT NULL DEFAULT '',
  `b` varbinary(256) NOT NULL DEFAULT ''
) ENGINE=TokuDB DEFAULT CHARSET=latin1
ALTER TABLE t CHANGE COLUMN a a VARBINARY(255) NOT NULL DEFAULT 'a';
SHOW CREATE TABLE t;
Table	Create Table
t	CREATE TABLE `t` (
  `a` varbinary(255) NOT NULL DEFAULT 'a',
  `b` varbinary(256) NOT NULL DEFAULT ''
) ENGINE=TokuDB DEFAULT CHARSET=latin1
ALTER TABLE t CHANGE COLUMN a a VARBINARY(256) NOT NULL DEFAULT 'b';
SHOW CREATE TABLE t;
Table	Create Table
t	CREATE TABLE `t` (
  `a` varbinary(256) NOT NULL DEFAULT 'b',
  `b` varbinary(256) NOT NULL DEFAULT ''
) ENGINE=TokuDB DEFAULT CHARSET=latin1
ALTER TABLE t CHANGE COLUMN b b VARBINARY(255) NOT NULL DEFAULT 'c';
ERROR 42000: Table 't' uses an extension that doesn't exist in this XYZ version
ALTER TABLE t CHANGE COLUMN b b VARBINARY(1024) NOT NULL DEFAULT 'd';
SHOW CREATE TABLE t;
Table	Create Table
t	CREATE TABLE `t` (
  `a` varbinary(256) NOT NULL DEFAULT 'b',
  `b` varbinary(1024) NOT NULL DEFAULT 'd'
) ENGINE=TokuDB DEFAULT CHARSET=latin1
ALTER TABLE t CHANGE COLUMN b b VARBINARY(256) NOT NULL DEFAULT 'e';
ERROR 42000: Table 't' uses an extension that doesn't exist in this XYZ version
DROP TABLE t;
