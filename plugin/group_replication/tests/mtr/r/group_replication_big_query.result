include/master-slave.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the 'START SLAVE Syntax' in the MySQL Manual for more information.
[connection master]

############################################################
#  1. Create the test table on all group members.
CREATE TABLE t1 (c1 INT NOT NULL PRIMARY KEY,
c2 VARCHAR(21800) CHARACTER SET UTF8
) ENGINE=InnoDB;
include/rpl_sync.inc

############################################################
#  2. Execute a big query on server 1 that will fail to be
#     broadcast by Corosync.
SET SESSION sql_log_bin= 0;
call mtr.add_suppression("Plugin group_replication reported: 'Error while broadcasting the transaction to the group on session.*");
call mtr.add_suppression("Run function 'before_commit' in plugin 'group_replication' failed");
SET SESSION sql_log_bin= 1;
BEGIN;
COMMIT;
ERROR HY000: Error on observer while running replication hook 'before_commit'.

############################################################
#  3. Check that table t1 is empty on server 1.
include/assert.inc ['Table t1 is empty']

############################################################
#  4. Check that table t1 is empty on server 2.
include/assert.inc ['Table t1 is empty']

############################################################
#  5. Clean data.
DROP TABLE t1;
include/rpl_end.inc
