DROP TABLE IF EXISTS t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11;
DROP DATABASE IF EXISTS world;
set names utf8;
CREATE DATABASE world;
use world;
CREATE TABLE Country (
Code char(3) NOT NULL default '',
Name char(52) NOT NULL default '',
SurfaceArea float(10,2) NOT NULL default '0.00',
Population int(11) NOT NULL default '0',
Capital int(11) default NULL
);
CREATE TABLE City (
ID int(11) NOT NULL,
Name char(35) NOT NULL default '',
Country char(3) NOT NULL default '',
Population int(11) NOT NULL default '0'
);
CREATE TABLE CountryLanguage (
Country char(3) NOT NULL default '',
Language char(30) NOT NULL default '',
Percentage float(3,1) NOT NULL default '0.0'
);
SELECT COUNT(*) FROM Country;
COUNT(*)
239
SELECT COUNT(*) FROM City;
COUNT(*)
4079
SELECT COUNT(*) FROM CountryLanguage;
COUNT(*)
984
show variables like 'join_buffer_size';
Variable_name	Value
join_buffer_size	131072
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	1
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	ALL	NULL	NULL	NULL	NULL	984	Using where; Using join buffer
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
set join_cache_level=2;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	2
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	ALL	NULL	NULL	NULL	NULL	984	Using where; Using join buffer
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
set join_cache_level=default;
set join_buffer_size=256;
show variables like 'join_buffer_size';
Variable_name	Value
join_buffer_size	256
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	1
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	ALL	NULL	NULL	NULL	NULL	984	Using where; Using join buffer
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
set join_cache_level=2;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	2
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	ALL	NULL	NULL	NULL	NULL	984	Using where; Using join buffer
1	SIMPLE	City	ALL	NULL	NULL	NULL	NULL	4079	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
set join_cache_level=default;
set join_buffer_size=default;
show variables like 'join_buffer_size';
Variable_name	Value
join_buffer_size	131072
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	1
DROP DATABASE world;
CREATE DATABASE world;
use world;
CREATE TABLE Country (
Code char(3) NOT NULL default '',
Name char(52) NOT NULL default '',
SurfaceArea float(10,2) NOT NULL default '0.00',
Population int(11) NOT NULL default '0',
Capital int(11) default NULL,
PRIMARY KEY  (Code),
UNIQUE INDEX (Name)
);
CREATE TABLE City (
ID int(11) NOT NULL auto_increment,
Name char(35) NOT NULL default '',
Country char(3) NOT NULL default '',
Population int(11) NOT NULL default '0',
PRIMARY KEY  (ID),
INDEX (Population),
INDEX (Country) 
);
CREATE TABLE CountryLanguage (
Country char(3) NOT NULL default '',
Language char(30) NOT NULL default '',
Percentage float(3,1) NOT NULL default '0.0',
PRIMARY KEY  (Country, Language),
INDEX (Percentage)
);
show variables like 'join_buffer_size';
Variable_name	Value
join_buffer_size	131072
set join_cache_level=5;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	5
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
EXPLAIN
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	eq_ref	PRIMARY	PRIMARY	33	world.Country.Code,const	1	Using where; Using join buffer
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
Name	IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
Australia	81.2
United Kingdom	97.3
Canada	60.4
United States	86.2
Zimbabwe	2.2
Japan	0.1
South Africa	8.5
Malaysia	1.6
Afghanistan	NULL
Netherlands	NULL
Algeria	NULL
Angola	NULL
Argentina	NULL
Bangladesh	NULL
Belgium	NULL
Brazil	NULL
Burkina Faso	NULL
Chile	NULL
Ecuador	NULL
Egypt	NULL
Spain	NULL
Ethiopia	NULL
Philippines	NULL
Ghana	NULL
Guatemala	NULL
Indonesia	NULL
India	NULL
Iraq	NULL
Iran	NULL
Italy	NULL
Yemen	NULL
Yugoslavia	NULL
Cambodia	NULL
Cameroon	NULL
Kazakstan	NULL
Kenya	NULL
China	NULL
Colombia	NULL
Congo, The Democratic Republic of the	NULL
North Korea	NULL
South Korea	NULL
Greece	NULL
Cuba	NULL
Madagascar	NULL
Malawi	NULL
Mali	NULL
Morocco	NULL
Mexico	NULL
Mozambique	NULL
Myanmar	NULL
Nepal	NULL
Niger	NULL
Nigeria	NULL
Côte d?Ivoire	NULL
Pakistan	NULL
Peru	NULL
Poland	NULL
France	NULL
Romania	NULL
Germany	NULL
Saudi Arabia	NULL
Somalia	NULL
Sri Lanka	NULL
Sudan	NULL
Syria	NULL
Taiwan	NULL
Tanzania	NULL
Thailand	NULL
Czech Republic	NULL
Turkey	NULL
Uganda	NULL
Ukraine	NULL
Hungary	NULL
Uzbekistan	NULL
Belarus	NULL
Venezuela	NULL
Russian Federation	NULL
Vietnam	NULL
set join_cache_level=6;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	6
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
EXPLAIN
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	eq_ref	PRIMARY	PRIMARY	33	world.Country.Code,const	1	Using where; Using join buffer
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
Name	IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
Australia	81.2
United Kingdom	97.3
Canada	60.4
United States	86.2
Zimbabwe	2.2
Japan	0.1
South Africa	8.5
Malaysia	1.6
Afghanistan	NULL
Netherlands	NULL
Algeria	NULL
Angola	NULL
Argentina	NULL
Bangladesh	NULL
Belgium	NULL
Brazil	NULL
Burkina Faso	NULL
Chile	NULL
Ecuador	NULL
Egypt	NULL
Spain	NULL
Ethiopia	NULL
Philippines	NULL
Ghana	NULL
Guatemala	NULL
Indonesia	NULL
India	NULL
Iraq	NULL
Iran	NULL
Italy	NULL
Yemen	NULL
Yugoslavia	NULL
Cambodia	NULL
Cameroon	NULL
Kazakstan	NULL
Kenya	NULL
China	NULL
Colombia	NULL
Congo, The Democratic Republic of the	NULL
North Korea	NULL
South Korea	NULL
Greece	NULL
Cuba	NULL
Madagascar	NULL
Malawi	NULL
Mali	NULL
Morocco	NULL
Mexico	NULL
Mozambique	NULL
Myanmar	NULL
Nepal	NULL
Niger	NULL
Nigeria	NULL
Côte d?Ivoire	NULL
Pakistan	NULL
Peru	NULL
Poland	NULL
France	NULL
Romania	NULL
Germany	NULL
Saudi Arabia	NULL
Somalia	NULL
Sri Lanka	NULL
Sudan	NULL
Syria	NULL
Taiwan	NULL
Tanzania	NULL
Thailand	NULL
Czech Republic	NULL
Turkey	NULL
Uganda	NULL
Ukraine	NULL
Hungary	NULL
Uzbekistan	NULL
Belarus	NULL
Venezuela	NULL
Russian Federation	NULL
Vietnam	NULL
set join_cache_level=7;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	7
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
EXPLAIN
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	eq_ref	PRIMARY	PRIMARY	33	world.Country.Code,const	1	Using where; Using join buffer
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
Name	IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
Australia	81.2
United Kingdom	97.3
Canada	60.4
United States	86.2
Zimbabwe	2.2
Japan	0.1
South Africa	8.5
Malaysia	1.6
Afghanistan	NULL
Netherlands	NULL
Algeria	NULL
Angola	NULL
Argentina	NULL
Bangladesh	NULL
Belgium	NULL
Brazil	NULL
Burkina Faso	NULL
Chile	NULL
Ecuador	NULL
Egypt	NULL
Spain	NULL
Ethiopia	NULL
Philippines	NULL
Ghana	NULL
Guatemala	NULL
Indonesia	NULL
India	NULL
Iraq	NULL
Iran	NULL
Italy	NULL
Yemen	NULL
Yugoslavia	NULL
Cambodia	NULL
Cameroon	NULL
Kazakstan	NULL
Kenya	NULL
China	NULL
Colombia	NULL
Congo, The Democratic Republic of the	NULL
North Korea	NULL
South Korea	NULL
Greece	NULL
Cuba	NULL
Madagascar	NULL
Malawi	NULL
Mali	NULL
Morocco	NULL
Mexico	NULL
Mozambique	NULL
Myanmar	NULL
Nepal	NULL
Niger	NULL
Nigeria	NULL
Côte d?Ivoire	NULL
Pakistan	NULL
Peru	NULL
Poland	NULL
France	NULL
Romania	NULL
Germany	NULL
Saudi Arabia	NULL
Somalia	NULL
Sri Lanka	NULL
Sudan	NULL
Syria	NULL
Taiwan	NULL
Tanzania	NULL
Thailand	NULL
Czech Republic	NULL
Turkey	NULL
Uganda	NULL
Ukraine	NULL
Hungary	NULL
Uzbekistan	NULL
Belarus	NULL
Venezuela	NULL
Russian Federation	NULL
Vietnam	NULL
set join_cache_level=8;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	8
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
EXPLAIN
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	ALL	NULL	NULL	NULL	NULL	239	Using where
1	SIMPLE	CountryLanguage	eq_ref	PRIMARY	PRIMARY	33	world.Country.Code,const	1	Using where; Using join buffer
SELECT Country.Name, IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
FROM Country LEFT JOIN CountryLanguage ON
(CountryLanguage.Country=Country.Code AND Language='English')
WHERE 
Country.Population > 10000000;
Name	IF(ISNULL(CountryLanguage.Country), NULL, CountryLanguage.Percentage)
Australia	81.2
United Kingdom	97.3
Canada	60.4
United States	86.2
Zimbabwe	2.2
Japan	0.1
South Africa	8.5
Malaysia	1.6
Afghanistan	NULL
Netherlands	NULL
Algeria	NULL
Angola	NULL
Argentina	NULL
Bangladesh	NULL
Belgium	NULL
Brazil	NULL
Burkina Faso	NULL
Chile	NULL
Ecuador	NULL
Egypt	NULL
Spain	NULL
Ethiopia	NULL
Philippines	NULL
Ghana	NULL
Guatemala	NULL
Indonesia	NULL
India	NULL
Iraq	NULL
Iran	NULL
Italy	NULL
Yemen	NULL
Yugoslavia	NULL
Cambodia	NULL
Cameroon	NULL
Kazakstan	NULL
Kenya	NULL
China	NULL
Colombia	NULL
Congo, The Democratic Republic of the	NULL
North Korea	NULL
South Korea	NULL
Greece	NULL
Cuba	NULL
Madagascar	NULL
Malawi	NULL
Mali	NULL
Morocco	NULL
Mexico	NULL
Mozambique	NULL
Myanmar	NULL
Nepal	NULL
Niger	NULL
Nigeria	NULL
Côte d?Ivoire	NULL
Pakistan	NULL
Peru	NULL
Poland	NULL
France	NULL
Romania	NULL
Germany	NULL
Saudi Arabia	NULL
Somalia	NULL
Sri Lanka	NULL
Sudan	NULL
Syria	NULL
Taiwan	NULL
Tanzania	NULL
Thailand	NULL
Czech Republic	NULL
Turkey	NULL
Uganda	NULL
Ukraine	NULL
Hungary	NULL
Uzbekistan	NULL
Belarus	NULL
Venezuela	NULL
Russian Federation	NULL
Vietnam	NULL
set join_buffer_size=256;
show variables like 'join_buffer_size';
Variable_name	Value
join_buffer_size	256
set join_cache_level=5;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	5
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
set join_cache_level=6;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	6
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
set join_cache_level=7;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	7
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
set join_cache_level=8;
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	8
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	Country	range	PRIMARY,Name	Name	52	NULL	10	Using index condition; Using MRR
1	SIMPLE	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
EXPLAIN
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	CountryLanguage	ALL	PRIMARY,Percentage	NULL	NULL	NULL	984	Using where
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.CountryLanguage.Country	1	Using where; Using join buffer
1	SIMPLE	City	ref	Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT City.Name, Country.Name, CountryLanguage.Language
FROM City,Country,CountryLanguage
WHERE City.Country=Country.Code AND
CountryLanguage.Country=Country.Code AND
City.Name LIKE 'L%' AND Country.Population > 3000000 AND
CountryLanguage.Percentage > 50;
Name	Name	Language
Leiden	Netherlands	Dutch
La Matanza	Argentina	Spanish
Lomas de Zamora	Argentina	Spanish
La Plata	Argentina	Spanish
Lanús	Argentina	Spanish
Las Heras	Argentina	Spanish
La Rioja	Argentina	Spanish
Liège	Belgium	Dutch
La Paz	Bolivia	Spanish
Londrina	Brazil	Portuguese
Limeira	Brazil	Portuguese
Lages	Brazil	Portuguese
Luziânia	Brazil	Portuguese
Lauro de Freitas	Brazil	Portuguese
Linhares	Brazil	Portuguese
London	United Kingdom	English
Liverpool	United Kingdom	English
Leeds	United Kingdom	English
Leicester	United Kingdom	English
Luton	United Kingdom	English
Los Angeles	Chile	Spanish
La Serena	Chile	Spanish
La Romana	Dominican Republic	Spanish
Loja	Ecuador	Spanish
Luxor	Egypt	Arabic
Las Palmas de Gran Canaria	Spain	Spanish
L´Hospitalet de Llobregat	Spain	Spanish
Leganés	Spain	Spanish
León	Spain	Spanish
Logroño	Spain	Spanish
Lleida (Lérida)	Spain	Spanish
Le-Cap-Haïtien	Haiti	Haiti Creole
La Ceiba	Honduras	Spanish
Livorno	Italy	Italian
Latina	Italy	Italian
Lecce	Italy	Italian
La Spezia	Italy	Italian
Linz	Austria	German
London	Canada	English
Laval	Canada	English
Longueuil	Canada	English
Lanzhou	China	Chinese
Luoyang	China	Chinese
Liuzhou	China	Chinese
Liaoyang	China	Chinese
Liupanshui	China	Chinese
Liaoyuan	China	Chinese
Lianyungang	China	Chinese
Leshan	China	Chinese
Linyi	China	Chinese
Luzhou	China	Chinese
Laiwu	China	Chinese
Liaocheng	China	Chinese
Laizhou	China	Chinese
Linfen	China	Chinese
Liangcheng	China	Chinese
Longkou	China	Chinese
Langfang	China	Chinese
Liu´an	China	Chinese
Longjing	China	Chinese
Lengshuijiang	China	Chinese
Laiyang	China	Chinese
Longyan	China	Chinese
Linhe	China	Chinese
Leiyang	China	Chinese
Loudi	China	Chinese
Luohe	China	Chinese
Linqing	China	Chinese
Laohekou	China	Chinese
Linchuan	China	Chinese
Lhasa	China	Chinese
Lianyuan	China	Chinese
Liyang	China	Chinese
Liling	China	Chinese
Linhai	China	Chinese
Larisa	Greece	Greek
La Habana	Cuba	Spanish
Lilongwe	Malawi	Chichewa
León	Mexico	Spanish
La Paz	Mexico	Spanish
La Paz	Mexico	Spanish
Lázaro Cárdenas	Mexico	Spanish
Lagos de Moreno	Mexico	Spanish
Lerdo	Mexico	Spanish
Los Cabos	Mexico	Spanish
Lerma	Mexico	Spanish
Las Margaritas	Mexico	Spanish
Lashio (Lasho)	Myanmar	Burmese
Lalitapur	Nepal	Nepali
León	Nicaragua	Spanish
Lambaré	Paraguay	Spanish
Lima	Peru	Spanish
Lisboa	Portugal	Portuguese
Lódz	Poland	Polish
Lublin	Poland	Polish
Legnica	Poland	Polish
Lyon	France	French
Le Havre	France	French
Lille	France	French
Le Mans	France	French
Limoges	France	French
Linköping	Sweden	Swedish
Lund	Sweden	Swedish
Leipzig	Germany	German
Lübeck	Germany	German
Ludwigshafen am Rhein	Germany	German
Leverkusen	Germany	German
Lünen	Germany	German
Lahti	Finland	Finnish
Lausanne	Switzerland	German
Latakia	Syria	Arabic
Luchou	Taiwan	Min
Lungtan	Taiwan	Min
Liberec	Czech Republic	Czech
Lviv	Ukraine	Ukrainian
Lugansk	Ukraine	Ukrainian
Lutsk	Ukraine	Ukrainian
Lysyt?ansk	Ukraine	Ukrainian
Lower Hutt	New Zealand	English
Lida	Belarus	Belorussian
Los Teques	Venezuela	Spanish
Lipetsk	Russian Federation	Russian
Ljubertsy	Russian Federation	Russian
Leninsk-Kuznetski	Russian Federation	Russian
Long Xuyen	Vietnam	Vietnamese
Los Angeles	United States	English
Las Vegas	United States	English
Long Beach	United States	English
Lexington-Fayette	United States	English
Louisville	United States	English
Lincoln	United States	English
Lubbock	United States	English
Little Rock	United States	English
Laredo	United States	English
Lakewood	United States	English
Lansing	United States	English
Lancaster	United States	English
Lafayette	United States	English
Lowell	United States	English
Livonia	United States	English
EXPLAIN
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	PRIMARY	Country	ALL	PRIMARY,Name	NULL	NULL	NULL	239	Using where
1	PRIMARY	City	ref	Population,Country	Country	3	world.Country.Code	18	Using where; Using join buffer
SELECT Name FROM City
WHERE City.Country IN (SELECT Code FROM Country WHERE Country.Name LIKE 'L%') AND
City.Population > 100000;
Name
Vientiane
Riga
Daugavpils
Maseru
Beirut
Tripoli
Monrovia
Tripoli
Bengasi
Misrata
Vilnius
Kaunas
Klaipeda
?iauliai
Panevezys
set join_cache_level=default;
set join_buffer_size=default;
show variables like 'join_buffer_size';
Variable_name	Value
join_buffer_size	131072
show variables like 'join_cache_level';
Variable_name	Value
join_cache_level	1
set join_cache_level=1;
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND City.Population > 3000000;
Name	Name
Sydney	Australia
Dhaka	Bangladesh
São Paulo	Brazil
Rio de Janeiro	Brazil
London	United Kingdom
Santiago de Chile	Chile
Cairo	Egypt
Alexandria	Egypt
Jakarta	Indonesia
Mumbai (Bombay)	India
Delhi	India
Calcutta [Kolkata]	India
Chennai (Madras)	India
Baghdad	Iraq
Teheran	Iran
Tokyo	Japan
Jokohama [Yokohama]	Japan
Shanghai	China
Peking	China
Chongqing	China
Tianjin	China
Wuhan	China
Harbin	China
Shenyang	China
Kanton [Guangzhou]	China
Chengdu	China
Santafé de Bogotá	Colombia
Kinshasa	Congo, The Democratic Republic of the
Seoul	South Korea
Pusan	South Korea
Ciudad de México	Mexico
Rangoon (Yangon)	Myanmar
Karachi	Pakistan
Lahore	Pakistan
Lima	Peru
Berlin	Germany
Riyadh	Saudi Arabia
Singapore	Singapore
Bangkok	Thailand
Istanbul	Turkey
Ankara	Turkey
Moscow	Russian Federation
St Petersburg	Russian Federation
Ho Chi Minh City	Vietnam
New York	United States
Los Angeles	United States
set join_cache_level=8;
set join_buffer_size=256;
EXPLAIN
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND City.Population > 3000000;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	City	range	Population,Country	Population	4	NULL	#	Using index condition; Using MRR
1	SIMPLE	Country	eq_ref	PRIMARY	PRIMARY	3	world.City.Country	#	Using join buffer
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND City.Population > 3000000;
Name	Name
Sydney	Australia
Dhaka	Bangladesh
Rio de Janeiro	Brazil
São Paulo	Brazil
London	United Kingdom
Santiago de Chile	Chile
Alexandria	Egypt
Cairo	Egypt
Jakarta	Indonesia
Delhi	India
Calcutta [Kolkata]	India
Mumbai (Bombay)	India
Chennai (Madras)	India
Baghdad	Iraq
Teheran	Iran
Tokyo	Japan
Jokohama [Yokohama]	Japan
Peking	China
Chongqing	China
Shanghai	China
Wuhan	China
Harbin	China
Shenyang	China
Kanton [Guangzhou]	China
Tianjin	China
Chengdu	China
Santafé de Bogotá	Colombia
Kinshasa	Congo, The Democratic Republic of the
Seoul	South Korea
Pusan	South Korea
Ciudad de México	Mexico
Rangoon (Yangon)	Myanmar
Karachi	Pakistan
Lahore	Pakistan
Lima	Peru
Berlin	Germany
Riyadh	Saudi Arabia
Singapore	Singapore
Bangkok	Thailand
Ankara	Turkey
Istanbul	Turkey
St Petersburg	Russian Federation
Moscow	Russian Federation
Ho Chi Minh City	Vietnam
Los Angeles	United States
New York	United States
set join_buffer_size=default;
set join_cache_level=6;
ALTER TABLE Country MODIFY Name varchar(52) NOT NULL default '';
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
ALTER TABLE Country MODIFY Name varchar(300) NOT NULL default '';
SELECT City.Name, Country.Name FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name
Vientiane	Laos
Riga	Latvia
Daugavpils	Latvia
Maseru	Lesotho
Beirut	Lebanon
Tripoli	Lebanon
Monrovia	Liberia
Tripoli	Libyan Arab Jamahiriya
Bengasi	Libyan Arab Jamahiriya
Misrata	Libyan Arab Jamahiriya
Vilnius	Lithuania
Kaunas	Lithuania
Klaipeda	Lithuania
?iauliai	Lithuania
Panevezys	Lithuania
ALTER TABLE Country ADD COLUMN PopulationBar text;
UPDATE Country 
SET PopulationBar=REPEAT('x', CAST(Population/100000 AS unsigned int));
SELECT City.Name, Country.Name, Country.PopulationBar FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name	PopulationBar
Vientiane	Laos	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Riga	Latvia	xxxxxxxxxxxxxxxxxxxxxxxx
Daugavpils	Latvia	xxxxxxxxxxxxxxxxxxxxxxxx
Maseru	Lesotho	xxxxxxxxxxxxxxxxxxxxxx
Beirut	Lebanon	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Tripoli	Lebanon	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Monrovia	Liberia	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Tripoli	Libyan Arab Jamahiriya	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Bengasi	Libyan Arab Jamahiriya	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Misrata	Libyan Arab Jamahiriya	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Vilnius	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Kaunas	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Klaipeda	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
?iauliai	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Panevezys	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
set join_buffer_size=256;
SELECT City.Name, Country.Name, Country.PopulationBar FROM City,Country
WHERE City.Country=Country.Code AND 
Country.Name LIKE 'L%' AND City.Population > 100000;
Name	Name	PopulationBar
Vientiane	Laos	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Riga	Latvia	xxxxxxxxxxxxxxxxxxxxxxxx
Daugavpils	Latvia	xxxxxxxxxxxxxxxxxxxxxxxx
Maseru	Lesotho	xxxxxxxxxxxxxxxxxxxxxx
Beirut	Lebanon	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Tripoli	Lebanon	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Monrovia	Liberia	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Tripoli	Libyan Arab Jamahiriya	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Bengasi	Libyan Arab Jamahiriya	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Misrata	Libyan Arab Jamahiriya	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Vilnius	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Kaunas	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Klaipeda	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
?iauliai	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Panevezys	Lithuania	xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
set join_cache_level=default;
set join_buffer_size=default;
DROP DATABASE world;
CREATE TABLE t1 (a int, b int, INDEX idx(b));
CREATE TABLE t2 (a int, b int, INDEX idx(a));
INSERT INTO t1 VALUES (5,30), (3,20), (7,40), (2,10), (8,30), (1,10), (4,20);
INSERT INTO t2 VALUES (7,10), (1,20), (2,20), (8,20), (8,10), (1,20);
INSERT INTO t2 VALUES (1,10), (4,20), (3,20), (7,20), (7,10), (1,20);
set join_buffer_size=32;
Warnings:
Warning	1292	Truncated incorrect join_buffer_size value: '32'
set join_cache_level=8;
EXPLAIN SELECT * FROM t1,t2 WHERE t1.a=t2.a AND t1.b >= 30;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	idx	NULL	NULL	NULL	7	Using where
1	SIMPLE	t2	ref	idx	idx	5	test.t1.a	2	Using join buffer
SELECT * FROM t1,t2 WHERE t1.a=t2.a AND t1.b >= 30;
a	b	a	b
7	40	7	10
7	40	7	10
7	40	7	20
8	30	8	10
8	30	8	20
DROP TABLE t1,t2;

BUG#40136: Group by is ignored when join buffer is used for an outer join

create table t1(a int PRIMARY KEY, b int);
insert into t1 values
(5, 10), (2, 70), (7, 80), (6, 20), (1, 50), (9, 40), (8, 30), (3, 60);
create table t2 (p int, a int, INDEX i_a(a));
insert into t2 values
(103, 7), (109, 3), (102, 3), (108, 1), (106, 3),
(107, 7), (105, 1), (101, 3), (100, 7), (110, 1);
set @save_join_cache_level=@@join_cache_level;
set join_cache_level=6;
The following must not show "using join cache":
explain
select t1.a, count(t2.p) as count
from t1 left join t2 on t1.a=t2.a and t2.p % 2 = 1 group by t1.a;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	4	Using index
1	SIMPLE	t2	ref	i_a	i_a	5	test.t1.a	2	Using where
select t1.a, count(t2.p) as count
from t1 left join t2 on t1.a=t2.a and t2.p % 2 = 1 group by t1.a;
a	count
1	1
2	0
3	2
5	0
6	0
7	2
8	0
9	0
drop table t1, t2;
set join_cache_level=default;
set join_buffer_size=default;
CREATE TABLE t1 (a int NOT NULL);
INSERT INTO t1 VALUES (2), (4), (3), (5), (1);
CREATE TABLE t2 (a int NOT NULL, b int NOT NULL, INDEX i_a(a));
INSERT INTO t2 VALUES (4,10), (2,10), (2,30), (2,20), (4,20);
EXPLAIN
SELECT * FROM t1 LEFT JOIN t2 ON t1.a=t2.a WHERE t2.b IS NULL;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	
1	SIMPLE	t2	ref	i_a	i_a	4	test.t1.a	2	Using where; Not exists
SELECT * FROM t1 LEFT JOIN t2 ON t1.a=t2.a WHERE t2.b IS NULL;
a	a	b
3	NULL	NULL
5	NULL	NULL
1	NULL	NULL
set join_cache_level=6;
EXPLAIN
SELECT * FROM t1 LEFT JOIN t2 ON t1.a=t2.a WHERE t2.b IS NULL;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	
1	SIMPLE	t2	ref	i_a	i_a	4	test.t1.a	2	Using where; Not exists; Using join buffer
SELECT * FROM t1 LEFT JOIN t2 ON t1.a=t2.a WHERE t2.b IS NULL;
a	a	b
3	NULL	NULL
5	NULL	NULL
1	NULL	NULL
DROP TABLE t1, t2;
set join_cache_level=default;
set join_buffer_size=default;
#
# BUG#40268: Nested outer join with not null-rejecting where condition
#            over an inner table which is not the last in the nest
#
CREATE TABLE t2 (a int, b int, c int);
CREATE TABLE t3 (a int, b int, c int);
CREATE TABLE t4 (a int, b int, c int);
INSERT INTO t2 VALUES (3,3,0), (4,2,0), (5,3,0);
INSERT INTO t3 VALUES (1,2,0), (2,2,0);
INSERT INTO t4 VALUES (3,2,0), (4,2,0);
SELECT t2.a,t2.b,t3.a,t3.b,t4.a,t4.b
FROM t2 LEFT JOIN (t3, t4) ON t2.b=t4.b
WHERE t3.a+2<t2.a OR t3.c IS NULL;
a	b	a	b	a	b
4	2	1	2	3	2
4	2	1	2	4	2
3	3	NULL	NULL	NULL	NULL
5	3	NULL	NULL	NULL	NULL
set join_cache_level=default;
DROP TABLE t2, t3, t4;
#
# Bug #40192: outer join with where clause when using BNL 
#
create table t1 (a int, b int);
insert into t1 values (2, 20), (3, 30), (1, 10);
create table t2 (a int, c int);
insert into t2 values (1, 101), (3, 102), (1, 100);
set join_cache_level=6;
select * from t1 left join t2 on t1.a=t2.a;
a	b	a	c
1	10	1	101
3	30	3	102
1	10	1	100
2	20	NULL	NULL
explain select * from t1 left join t2 on t1.a=t2.a where t2.c=102 or t2.c is null;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	3	
1	SIMPLE	t2	ALL	NULL	NULL	NULL	NULL	3	Using where; Using join buffer
select * from t1 left join t2 on t1.a=t2.a where t2.c=102 or t2.c is null;
a	b	a	c
3	30	3	102
2	20	NULL	NULL
set join_cache_level=default;
drop table t1, t2;
#
# Bug #40317: outer join with with constant on expression equal to FALSE
#
create table t1 (a int);
insert into t1 values (30), (40), (20);
create table t2 (b int);
insert into t2 values (200), (100);
set join_cache_level=6;
select * from t1 left join t2 on (1=0);
a	b
30	NULL
40	NULL
20	NULL
explain select * from t1 left join t2 on (1=0) where a=40;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	3	Using where
1	SIMPLE	t2	ALL	NULL	NULL	NULL	NULL	2	Using where; Using join buffer
select * from t1 left join t2 on (1=0) where a=40;
a	b
40	NULL
set join_cache_level=1;
explain select * from t1 left join t2 on (1=0);
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	3	
1	SIMPLE	t2	ALL	NULL	NULL	NULL	NULL	2	Using where
set join_cache_level=default;
drop table t1, t2;
#
# Bug #41204: small buffer with big rec_per_key for ref access
#
CREATE TABLE t1 (a int);
INSERT INTO t1 VALUES (0);
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1(a) SELECT a FROM t1;
INSERT INTO t1 VALUES (20000), (10000);
CREATE TABLE t2 (pk int AUTO_INCREMENT PRIMARY KEY, b int, c int, INDEX idx(b));
INSERT INTO t2(b,c) VALUES (10000, 3), (20000, 7), (20000, 1), (10000, 9), (20000, 5);
INSERT INTO t2(b,c) SELECT b,c FROM t2;
INSERT INTO t2(b,c) SELECT b,c FROM t2;
INSERT INTO t2(b,c) SELECT b,c FROM t2;
INSERT INTO t2(b,c) SELECT b,c FROM t2;
INSERT INTO t2(b,c) SELECT b,c FROM t2;
INSERT INTO t2(b,c) SELECT b,c FROM t2;
INSERT INTO t2(b,c) SELECT b,c FROM t2;
INSERT INTO t2(b,c) SELECT b,c FROM t2;
ANALYZE TABLE t1,t2;
set join_cache_level=6;
set join_buffer_size=1024;
EXPLAIN SELECT AVG(c) FROM t1,t2 WHERE t1.a=t2.b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	2050	
1	SIMPLE	t2	ref	idx	idx	5	test.t1.a	640	Using join buffer
SELECT AVG(c) FROM t1,t2 WHERE t1.a=t2.b;
AVG(c)
5.0000
set join_buffer_size=default;
set join_cache_level=default;
DROP TABLE t1, t2;
#
# Bug #41894: big join buffer of level 7 used to join records
#              with null values in place of varchar strings
#
CREATE TABLE t1 (a int NOT NULL AUTO_INCREMENT PRIMARY KEY,
b varchar(127) DEFAULT NULL);
INSERT INTO t1(a) VALUES (1);
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
INSERT INTO t1(b) SELECT b FROM t1;
CREATE TABLE t2 (a int NOT NULL PRIMARY KEY, b varchar(127) DEFAULT NULL);
INSERT INTO t2 SELECT * FROM t1;
CREATE TABLE t3 (a int NOT NULL PRIMARY KEY, b varchar(127) DEFAULT NULL);
INSERT INTO t3 SELECT * FROM t1;
set join_cache_level=7;
set join_buffer_size=1024*1024;
EXPLAIN
SELECT COUNT(*) FROM t1,t2,t3
WHERE t1.a=t2.a AND t2.a=t3.a AND
t1.b IS NULL AND t2.b IS NULL AND t3.b IS NULL;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	PRIMARY	NULL	NULL	NULL	16384	Using where
1	SIMPLE	t2	eq_ref	PRIMARY	PRIMARY	4	test.t1.a	1	Using where; Using join buffer
1	SIMPLE	t3	eq_ref	PRIMARY	PRIMARY	4	test.t1.a	1	Using where; Using join buffer
SELECT COUNT(*) FROM t1,t2,t3
WHERE t1.a=t2.a AND t2.a=t3.a AND
t1.b IS NULL AND t2.b IS NULL AND t3.b IS NULL;
COUNT(*)
16384
set join_buffer_size=default;
set join_cache_level=default;
DROP TABLE t1,t2,t3;
