--character_set gb18030

# Use the following chars to get single bytes
# 、￥ケ夯冀 
# And construct these gb18030 chars maped from SIP
# 262805525051525354

SET NAMES gb18030;
--CHARACTER_SET gb18030
SET CHARACTER_SET_DATABASE = gb18030;

CREATE DATABASE `中文`;
CREATE DATABASE `数据库`;

SELECT schema_name, HEX(schema_name)
  FROM information_schema.schemata
  WHERE schema_name NOT IN ('mtr', 'sys')
  ORDER BY schema_name;

USE `数据库`;
USE `中文`;

DROP DATABASE `数据库`;
DROP DATABASE `中文`;

USE test;

--echo 'Test for CREATE TABLE'

CREATE TABLE `表格` (`字段一` CHAR(1)) DEFAULT CHARSET = gb18030;
CREATE TABLE `模式` (`列列列` CHAR(1)) DEFAULT CHARSET = gb18030;
CREATE TABLE `J嗷90` (`列9394` CHAR(1)) DEFAULT CHARSET = gb18030;
# Table should not be created because table names exist
CREATE TABLE IF NOT EXISTS `表格`(`字段一` CHAR(1)) DEFAULT CHARSET = gb18030;
CREATE TABLE IF NOT EXISTS `模式` (`列列列` CHAR(1)) DEFAULT CHARSET = gb18030;
CREATE TABLE IF NOT EXISTS `J嗷90` (`列9394` CHAR(1)) DEFAULT CHARSET = gb18030;
# Tables should be created
CREATE TABLE IF NOT EXISTS `949494` (`939393` CHAR(1)) DEFAULT CHARSET = gb18030;
CREATE TEMPORARY TABLE `969798` (`959595` CHAR(1)) DEFAULT CHARSET = gb18030;

DESC `表格`;
DESC `模式`;
DESC `J嗷90`;
DESC `949494`;
DESC `969798`;

SHOW CREATE TABLE `表格`;
SHOW CREATE TABLE `模式`;
SHOW CREATE TABLE `J嗷90`;
SHOW CREATE TABLE `949494`;
SHOW CREATE TABLE `969798`;

DROP TABLE `表格`, `模式`, `J嗷90`, `949494`, `969798`;

--echo 'Test for ALTER TABLE'
CREATE TABLE `表格` (`字段一` CHAR(5)) DEFAULT CHARSET = gb18030;
CREATE TABLE `J嗷90` (`919293` CHAR(5)) DEFAULT CHARSET = gb18030;

INSERT INTO `表格` VALUES ('一二三四28'), ('六七八九十'), ('9495969798'), ('2628055250');
INSERT INTO `J嗷90` VALUES ('焊36菡F'), ('h汉h汉h'), ('9293969799');

ALTER TABLE `表格` ADD `新字段一` CHAR(1) FIRST;
ALTER TABLE `表格` ADD `新字段二` CHAR(1) AFTER `字段一`;
ALTER TABLE `表格` ADD `新字段三` CHAR(1);
ALTER TABLE `表格` ADD INDEX (`新字段二`);
ALTER TABLE `表格` ADD PRIMARY KEY (`字段一`);
ALTER TABLE `表格` ADD UNIQUE (`新字段三`);
ALTER TABLE `表格` CHANGE `新字段二` `3232一` CHAR(1);
ALTER TABLE `表格` MODIFY `新字段三` CHAR(6);

SELECT * FROM `表格`;
DESC `表格`;
SHOW CREATE TABLE `表格`;

ALTER TABLE `表格` DROP INDEX `新字段二`;
ALTER TABLE `表格` DROP PRIMARY KEY;
ALTER TABLE `表格` DROP INDEX `新字段三`;
ALTER TABLE `表格` DROP `3232一`;
ALTER TABLE `表格` DROP `新字段一`;
ALTER TABLE `表格` DROP `新字段三`;

SELECT * FROM `表格`;
DESC `表格`;
SHOW CREATE TABLE `表格`;

DROP TABLE `表格`, `J嗷90`;

--echo 'Test for INSERT/UPDATE/DELETE'
CREATE TABLE `表一` (`字段一` char(5)) DEFAULT CHARSET = gb18030;
INSERT INTO `表一` VALUES ('53作52阼');
SELECT INSERT(`字段一`, 1, 1, '99') FROM `表一`;
SELECT INSERT(`字段一`, 1, 2, '99') FROM `表一`;
SELECT INSERT(`字段一`, 1, 3, '99') FROM `表一`;
SELECT INSERT(`字段一`, 1, 4, '99') FROM `表一`;
SELECT INSERT(`字段一`, 1, 5, '99') FROM `表一`;

SELECT INSERT(`字段一`, 4, 1, '54') FROM `表一`;
SELECT INSERT(`字段一`, 4, 2, '54') FROM `表一`;
SELECT INSERT(`字段一`, 5, 1, '54') FROM `表一`;

SELECT INSERT(`字段一`, 1, 1, ' ') FROM `表一`;
SELECT INSERT(`字段一`, 1, 2, '  ') FROM `表一`;
SELECT INSERT(`字段一`, 1, 3, '   ') FROM `表一`;
SELECT INSERT(`字段一`, 1, 4, '    ') FROM `表一`;
SELECT INSERT(`字段一`, 1, 5, '     ') FROM `表一`;

SELECT INSERT(`字段一`, 4, 1, ' ') FROM `表一`;
SELECT INSERT(`字段一`, 4, 2, '  ') FROM `表一`;
SELECT INSERT(`字段一`, 5, 1, ' ') FROM `表一`;

SELECT INSERT(`字段一`, 1, 1, '') FROM `表一`;
SELECT INSERT(`字段一`, 1, 2, '') FROM `表一`;
SELECT INSERT(`字段一`, 1, 3, '') FROM `表一`;
SELECT INSERT(`字段一`, 1, 4, '') FROM `表一`;
SELECT INSERT(`字段一`, 1, 5, '') FROM `表一`;

SELECT INSERT(`字段一`, 4, 1, '28') FROM `表一`;
SELECT INSERT(`字段一`, 4, 2, '2828') FROM `表一`;
SELECT INSERT(`字段一`, 5, 1, '28') FROM `表一`;

UPDATE `表一` SET `字段一` = ('坐阼座28');
SELECT * FROM `表一`;
DELETE FROM `表一` WHERE `字段一` = '53作52阼';
SELECT * FROM `表一`;
DELETE FROM `表一`;
SELECT * FROM `表一`;

--echo 'Test for CHAR, VARCHAR, TEXT'
CREATE TABLE `表二` (c CHAR(5), v VARCHAR(10), t TEXT) DEFAULT CHARSET = gb18030;
INSERT INTO `表二` VALUES ('定长5250字', '变长280552字符串字段', '文本大对象525354字段');
SELECT * FROM `表二`;
TRUNCATE `表二`;

DROP TABLE `表一`, `表二`;

--echo 'Test for ENUM'
CREATE TABLE `表二` (e ENUM('口', '日', '目', '田', '晶'), INDEX(e)) DEFAULT CHARSET = gb18030;
INSERT INTO `表二` VALUES('田'), ('日'), ('目'), ('晶'), ('口');
SELECT * FROM `表二`;
ALTER TABLE `表二` ADD c CHAR(1) NOT NULL FIRST;
SHOW CREATE TABLE `表二`;
DESC `表二`;
DROP TABLE `表二`;

--echo 'Test for WHERE/LIKE'
CREATE TABLE `表一` (c1 CHAR(20), INDEX(c1)) DEFAULT CHARSET = gb18030;
INSERT INTO `表一` VALUES ('9999999999999999999999999999999999999999');
INSERT INTO `表一` VALUES ('9999999999999999999999999999990209080364');
INSERT INTO `表一` VALUES ('¤№999999999999999999999999999999999999');
INSERT INTO `表一` VALUES ('9999999999000203040299069908039909999999');
INSERT INTO `表一` VALUES ('9904050607000002090301080499999999999999');
INSERT INTO `表一` VALUES ('9999999999999999999999999999050607080900');
INSERT INTO `表一` VALUES ('0102030405070899999999999999999999999999');
INSERT INTO `表一` VALUES (' !"#$%&\'()*+,-./');
INSERT INTO `表一` VALUES ('0123456789:;<=>?');
INSERT INTO `表一` VALUES ('@ABCDEFGHIJKLMNO');
INSERT INTO `表一` VALUES ('PQRSTUVWXYZ[\\]^_');
INSERT INTO `表一` VALUES ('abcdefghijklmno');
INSERT INTO `表一` VALUES ('pqrstuvwxyz{|}~');
INSERT INTO `表一` VALUES ('9909080200090508010301030509050701070609');
INSERT INTO `表一` VALUES ('0802080500990305090701010003020602070005');
INSERT INTO `表一` VALUES ('0608010503010402050706000807010809050907');
INSERT INTO `表一` VALUES ('0103070501090302050408080207040005000201');
INSERT INTO `表一` VALUES ('0906060008010503999999999999999999999999');
INSERT INTO `表一` VALUES ('99áà010900ǎā020200040600040802éè05');
INSERT INTO `表一` VALUES ('êě09ē01070406990802íì0706ǐ99ī0106');
INSERT INTO `表一` VALUES ('0709020604建0309óò0200ǒ02ō01060008');
INSERT INTO `表一` VALUES ('020408060200úùü0409ǔ03ū050106ǘǜǚ');
INSERT INTO `表一` VALUES ('ǖ07050709020604999999999999999999999999');
INSERT INTO `表一` VALUES ('99@AB丌EGJ两丨丫MN丰QTUW乇Z');
INSERT INTO `表一` VALUES (']乜`d乩lmqv亍仃');
INSERT INTO `表一` VALUES ('仡仨へ蜇醴仿怪');
INSERT INTO `表一` VALUES ('伙媚刭');
INSERT INTO `表一` VALUES ('佟佣堇栀胫9999999999');
INSERT INTO `表一` VALUES ('99ux{|鼐鼗鼙鼢');
INSERT INTO `表一` VALUES ('鼯@B鼷鼹FG鼽HJL齄MNOY[\');
INSERT INTO `表一` VALUES (']^`cdnostuvwy{');
INSERT INTO `表一` VALUES ('999999999999999999999999');
INSERT INTO `表一` VALUES ('2628055250515253545354');

SELECT * FROM `表一`;
SELECT * FROM `表一` WHERE c1 LIKE ' %';
SELECT * FROM `表一` WHERE c1 LIKE '% %';
SELECT * FROM `表一` WHERE c1 LIKE '% ';
SELECT * FROM `表一` WHERE c1 LIKE '仡%';
SELECT * FROM `表一` WHERE c1 LIKE '%qv%';
SELECT * FROM `表一` WHERE c1 LIKE '%佘';
SELECT * FROM `表一` WHERE c1 LIKE '鼯@B鼷鼹FG鼽HJL齄MNOY[\%';
SELECT * FROM `表一` WHERE c1 LIKE '%鼯@B鼷鼹FG鼽HJL齄MNOY[\%';
SELECT * FROM `表一` WHERE c1 LIKE '%鼯@B鼷鼹FG鼽HJL齄MNOY[\';

SELECT * FROM `表一` WHERE c1 = '0608010503010402050706000807010809050907';
SELECT * FROM `表一` WHERE c1 = ']乜`d乩lmqv亍仃';
SELECT * FROM `表一` WHERE c1 = ']^`cdnostuvwy{';
SELECT * FROM `表一` WHERE c1 = '2628055250515253545354';

--echo 'Test for CONVERT'
SELECT c1, CONVERT(c1 USING gb18030) FROM `表一`;
SELECT c1, CONVERT(c1 USING utf8mb4), CONVERT(CONVERT(c1 USING utf8mb4) USING gb18030) FROM `表一`;

DROP TABLE `表一`;

--echo 'Test for sub-query'
CREATE TABLE t1a (c CHAR(1) PRIMARY KEY) DEFAULT CHARSET = gb18030;
CREATE TABLE t1b (c CHAR(1) PRIMARY KEY) DEFAULT CHARSET = gb18030;

CREATE TABLE t2a (c CHAR(1) PRIMARY KEY) DEFAULT CHARSET = gb18030;
CREATE TABLE t2b (c CHAR(1) PRIMARY KEY) DEFAULT CHARSET = gb18030;

INSERT INTO t1a VALUES ('双'), ('字'), ('52'), ('53');
INSERT INTO t1b VALUES ('双');

INSERT INTO t2a VALUES ('54'), ('y'), ('53');
INSERT INTO t2b VALUES ('54');

SELECT c FROM t1a WHERE c IN (SELECT c FROM t1b);
SELECT c FROM t1a WHERE EXISTS (SELECT c FROM t1b WHERE t1a.c = t1b.c);
SELECT c FROM t1a WHERE NOT EXISTS (SELECT c FROM t1b WHERE t1a.c = t1b.c);

SELECT c FROM t2a WHERE c IN (SELECT c FROM t2b);
SELECT c FROM t2a WHERE EXISTS (SELECT c FROM t2b WHERE t2a.c = t2b.c);
SELECT c FROM t2a WHERE NOT EXISTS (SELECT c FROM t2b WHERE t2a.c = t2b.c);

--echo 'Test for JOIN'
SELECT * FROM t1a JOIN t1b;
SELECT * FROM t1a INNER JOIN t1b;
SELECT * FROM t1a JOIN t1b USING (c);
SELECT * FROM t1a INNER JOIN t1b USING (c);
SELECT * FROM t1a CROSS JOIN t1b;
SELECT * FROM t1a LEFT JOIN t1b USING (c);
SELECT * FROM t1a LEFT JOIN t1b ON (t1a.c = t1b.c);
SELECT * FROM t1b RIGHT JOIN t1a USING (c);
SELECT * FROM t1b RIGHT JOIN t1a ON (t1a.c = t1b.c);

SELECT * FROM t2a JOIN t2b;
SELECT * FROM t2a INNER JOIN t2b;
SELECT * FROM t2a JOIN t2b USING (c);
SELECT * FROM t2a INNER JOIN t2b USING (c);
SELECT * FROM t2a CROSS JOIN t2b;
SELECT * FROM t2a LEFT JOIN t2b USING (c);
SELECT * FROM t2a LEFT JOIN t2b ON (t2a.c = t2b.c);
SELECT * FROM t2b RIGHT JOIN t2a USING (c);
SELECT * FROM t2b RIGHT JOIN t2a ON (t2a.c = t2b.c);

DROP TABLE t1a, t1b, t2a, t2b;

--echo 'Test for string functions'
CREATE TABLE `表一` (c1 CHAR(20), INDEX(c1)) DEFAULT CHARSET = gb18030;

INSERT INTO `表一` VALUES ('12345678900987654321'), ('一二三四五伍肆叁贰壹'), ('六七八'), ('九十'), ('百'), ('50515253');
INSERT INTO `表一` VALUES ('31'), ('一31二三四'), ('2805');

SELECT c1, LENGTH(c1) FROM `表一`;

SELECT c1, LPAD(c1, 20, '中') FROM `表一`;
SELECT c1, RPAD(c1, 20, '52') FROM `表一`;

TRUNCATE `表一`;

INSERT INTO `表一` VALUES ('一31二52三54四');
SELECT INSTR(c1, '一') FROM `表一`;
SELECT INSTR(c1, '二') FROM `表一`;
SELECT INSTR(c1, '三') FROM `表一`;
SELECT INSTR(c1, '四') FROM `表一`;
SELECT INSTR(c1, '52') FROM `表一`;
SELECT INSTR(c1, '54') FROM `表一`;
SELECT INSTR(c1, '31') FROM `表一`;

SELECT c1, LEFT(c1, 0) FROM `表一`;
SELECT c1, LEFT(c1, 1) FROM `表一`;
SELECT c1, LEFT(c1, 2) FROM `表一`;
SELECT c1, LEFT(c1, 3) FROM `表一`;
SELECT c1, LEFT(c1, 4) FROM `表一`;
SELECT c1, LEFT(c1, 5) FROM `表一`;
SELECT c1, LEFT(c1, 6) FROM `表一`;
SELECT c1, LEFT(c1, 7) FROM `表一`;

SELECT c1, RIGHT(c1, 0) FROM `表一`;
SELECT c1, RIGHT(c1, 1) FROM `表一`;
SELECT c1, RIGHT(c1, 2) FROM `表一`;
SELECT c1, RIGHT(c1, 3) FROM `表一`;
SELECT c1, RIGHT(c1, 4) FROM `表一`;
SELECT c1, RIGHT(c1, 5) FROM `表一`;
SELECT c1, RIGHT(c1, 6) FROM `表一`;
SELECT c1, RIGHT(c1, 7) FROM `表一`;

SELECT REPLACE(c1, '一', '一一') FROM `表一`;
SELECT REPLACE(c1, '四', '四四') FROM `表一`;
SELECT REPLACE(c1, '54', '5454') FROM `表一`;
SELECT REPLACE(c1, '52', '5252') FROM `表一`;


TRUNCATE `表一`;

INSERT INTO `表一` VALUES ('一31二52三53');
INSERT INTO `表一` VALUES ('一31二52三5352');
INSERT INTO `表一` VALUES ('一31二52三535252');
INSERT INTO `表一` VALUES ('一31二52三53525252');
INSERT INTO `表一` VALUES ('52一31二52三53');
INSERT INTO `表一` VALUES ('5252一31二52三53');
INSERT INTO `表一` VALUES ('525252一31二52三53');
INSERT INTO `表一` VALUES ('   一31二52三53   ');

SELECT c1, TRIM(TRAILING '52' FROM c1) FROM `表一`;
SELECT c1, TRIM(LEADING '52' FROM c1) FROM `表一`;
SELECT c1, TRIM(BOTH '52' FROM c1) FROM `表一`;
SELECT c1, TRIM(c1) FROM `表一`;

SELECT REVERSE(c1) FROM `表一`;

TRUNCATE `表一`;

DROP TABLE `表一`;

--echo 'Test for 'GROUP BY''
CREATE TABLE t1 (c VARCHAR(10)) DEFAULT CHARSET = gb18030;
INSERT INTO t1 VALUES ('砻'), (''), ('EX'), ('厘P'), ('嚏'), ('54'), ('EX');
SELECT c, COUNT(c) FROM t1 GROUP BY c;
DROP TABLE t1;

--echo 'Test for PS'

CREATE TABLE t1 (c1 CHAR(3)) DEFAULT CHARSET = gb18030;
CREATE TABLE t2 (c1 CHAR(3)) DEFAULT CHARSET = gb18030;
CREATE TABLE t3 (`32` CHAR(1), `95` CHAR(1), `段` CHAR(1)) DEFAULT CHARSET = gb18030;
CREATE TABLE t4 (c1 CHAR(3)) DEFAULT CHARSET = gb18030;

INSERT INTO t1 VALUES ('xxx');
INSERT INTO t2 VALUES ('5098列');
INSERT INTO t3 VALUES ('x', 'x', 'x'), ('x', 'x', 'x'), ('y', 'y', 'y'), ('y', 'y', 'y'), ('z', 'z', 'z'), ('z', 'z', 'z');
INSERT INTO t4 VALUES ('50'), ('98'), ('列');

# Chinese parameter for column name
# the parameter for stmt is not interpreted as column name
PREPARE stmt1 FROM 'SELECT ? FROM t3';
PREPARE stmt2 FROM 'SELECT * FROM t3 ORDER BY ?';
PREPARE stmt3 FROM 'SELECT COUNT(*) FROM t3 GROUP BY ?';
# Chinese parameter for function argument
PREPARE stmt4 FROM 'SELECT CHAR_LENGTH(?)';
PREPARE stmt5 FROM 'SELECT CHARSET(?)';
PREPARE stmt6 FROM 'SELECT INSERT(c1,1,1,?) FROM t1';
PREPARE stmt7 FROM 'SELECT INSTR(c1,?) FROM t2';
PREPARE stmt8 FROM 'SELECT LOCATE(?,c1) FROM t2';
PREPARE stmt9 FROM 'SELECT LPAD(c1,9,?) FROM t1';
PREPARE stmt10 FROM 'SELECT REPLACE(c1,?,\'x\') FROM t2';
PREPARE stmt11 FROM 'SELECT REPLACE(c1,\'x\',?) FROM t1';
PREPARE stmt12 FROM 'SELECT RPAD(c1,9,?) FROM t1';
# Chinese parameter for UPDATE
PREPARE stmt13 FROM 'UPDATE t4 SET c1=\'x\' WHERE c1=?';
PREPARE stmt14 FROM 'UPDATE t4 SET c1=? WHERE c1=\'x\'';

SET @arg = '50';
EXECUTE stmt1 USING @arg;
EXECUTE stmt2 USING @arg;
EXECUTE stmt3 USING @arg;
EXECUTE stmt4 USING @arg;
EXECUTE stmt5 USING @arg;
EXECUTE stmt6 USING @arg;
EXECUTE stmt7 USING @arg;
EXECUTE stmt8 USING @arg;
EXECUTE stmt9 USING @arg;
EXECUTE stmt10 USING @arg;
EXECUTE stmt11 USING @arg;
EXECUTE stmt12 USING @arg;
EXECUTE stmt13 USING @arg;
SELECT * FROM t4;
EXECUTE stmt14 USING @arg;
SELECT * FROM t4;


SET @arg = '98';
EXECUTE stmt1 USING @arg;
EXECUTE stmt2 USING @arg;
EXECUTE stmt3 USING @arg;
EXECUTE stmt4 USING @arg;
EXECUTE stmt5 USING @arg;
EXECUTE stmt6 USING @arg;
EXECUTE stmt7 USING @arg;
EXECUTE stmt8 USING @arg;
EXECUTE stmt9 USING @arg;
EXECUTE stmt10 USING @arg;
EXECUTE stmt11 USING @arg;
EXECUTE stmt12 USING @arg;
EXECUTE stmt13 USING @arg;
SELECT * FROM t4;
EXECUTE stmt14 USING @arg;
SELECT * FROM t4;


SET @arg = '列';
EXECUTE stmt1 USING @arg;
EXECUTE stmt2 USING @arg;
EXECUTE stmt3 USING @arg;
EXECUTE stmt4 USING @arg;
EXECUTE stmt5 USING @arg;
EXECUTE stmt6 USING @arg;
EXECUTE stmt7 USING @arg;
EXECUTE stmt8 USING @arg;
EXECUTE stmt9 USING @arg;
EXECUTE stmt10 USING @arg;
EXECUTE stmt11 USING @arg;
EXECUTE stmt12 USING @arg;
EXECUTE stmt13 USING @arg;
SELECT * FROM t4;
EXECUTE stmt14 USING @arg;
SELECT * FROM t4;


DEALLOCATE PREPARE stmt1;
DEALLOCATE PREPARE stmt2;
DEALLOCATE PREPARE stmt3;
DEALLOCATE PREPARE stmt4;
DEALLOCATE PREPARE stmt5;
DEALLOCATE PREPARE stmt6;
DEALLOCATE PREPARE stmt7;
DEALLOCATE PREPARE stmt8;
DEALLOCATE PREPARE stmt9;
DEALLOCATE PREPARE stmt10;
DEALLOCATE PREPARE stmt11;
DEALLOCATE PREPARE stmt12;
DEALLOCATE PREPARE stmt13;
DEALLOCATE PREPARE stmt14;

DROP TABLE t1;
DROP TABLE t2;
DROP TABLE t3;
DROP TABLE t4;

--echo 'Test for INTO OUTFILE/INFILE'
CREATE TABLE `表格一` (id INT PRIMARY KEY, c CHAR(5), b BINARY(50), v VARBINARY(100)) DEFAULT CHARSET = gb18030;
INSERT INTO `表格一` VALUES(1, 'ab56\串', '12\3\345', '字符56\串'), (2, '\2628\', '\\\\5C', '9293969799'), (3, '055250', '2628055250', '51525354');
SELECT * FROM `表格一`;

--let $fields=*
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT $fields INTO OUTFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' FROM `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT LOAD_FILE('$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt');
--eval CREATE TABLE `表格二` LIKE `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval LOAD DATA INFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' INTO TABLE `表格二` CHARACTER SET gb18030;
--eval SELECT COUNT(*) AS `Expect 3` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id;
--eval SELECT COUNT(*) AS `Expect 0` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id AND (`表格一`.c <> `表格二`.c OR `表格一`.b <> `表格二`.b OR `表格一`.v <> `表格二`.v);
--remove_file $MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt
DROP TABLE `表格二`;

--let $clauses=FIELDS TERMINATED BY '5C' ENCLOSED BY '"'
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT $fields INTO OUTFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' $clauses FROM `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT LOAD_FILE('$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt');
--eval CREATE TABLE `表格二` LIKE `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval LOAD DATA INFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' INTO TABLE `表格二` CHARACTER SET gb18030 $clauses;
--eval SELECT COUNT(*) AS `Expect 3` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id;
--eval SELECT COUNT(*) AS `Expect 0` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id AND (`表格一`.c <> `表格二`.c OR `表格一`.b <> `表格二`.b OR `表格一`.v <> `表格二`.v);
--remove_file $MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt
DROP TABLE `表格二`;

--let $clauses=FIELDS TERMINATED BY '5C' ENCLOSED BY '0' LINES TERMINATED BY '1'
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT $fields INTO OUTFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' $clauses FROM `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT LOAD_FILE('$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt');
--eval CREATE TABLE `表格二` LIKE `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval LOAD DATA INFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' INTO TABLE `表格二` CHARACTER SET gb18030 $clauses;
--eval SELECT COUNT(*) AS `Expect 3` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id;
--eval SELECT COUNT(*) AS `Expect 0` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id AND (`表格一`.c <> `表格二`.c OR `表格一`.b <> `表格二`.b OR `表格一`.v <> `表格二`.v);
--remove_file $MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt
DROP TABLE `表格二`;

--let $clauses=FIELDS TERMINATED BY 'd'
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT $fields INTO OUTFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' $clauses FROM `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval SELECT LOAD_FILE('$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt');
--eval CREATE TABLE `表格二` LIKE `表格一`;
--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
--eval LOAD DATA INFILE '$MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt' INTO TABLE `表格二` CHARACTER SET gb18030 $clauses;
--eval SELECT COUNT(*) AS `Expect 3` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id;
--eval SELECT COUNT(*) AS `Expect 0` FROM `表格一`, `表格二` WHERE `表格一`.id = `表格二`.id AND (`表格一`.c <> `表格二`.c OR `表格一`.b <> `表格二`.b OR `表格一`.v <> `表格二`.v);
--remove_file $MYSQLTEST_VARDIR/tmp/gb18030_encoding.txt
DROP TABLE `表格二`, `表格一`;
