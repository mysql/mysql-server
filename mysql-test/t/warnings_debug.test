--source include/have_innodb.inc
--source include/have_debug.inc

--disable_warnings
drop table if exists t1;
--enable_warnings

create table t1 (a int primary key) engine=innodb;

# Test that warnings produced during autocommit (after calling
# set_ok_status()) are still reported to the client.
SET SESSION debug="+d,warn_during_ha_commit_trans";
INSERT INTO t1 VALUES (1);
# The warning will be shown automatically by mysqltest; there was a bug where
# this didn't happen because the warning was not counted when sending result
# packet. Show the warnings manually also.
SHOW WARNINGS;

drop table t1;
