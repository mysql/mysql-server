include/rpl_init.inc [topology=1]
######## Initialize ########
CREATE TABLE variables (var_id INT PRIMARY KEY, name TEXT(100));
INSERT INTO variables VALUES
(1, 'session_partial'), (2, 'global_partial'),
(3, 'session_ended'), (4, 'global_ended');
CREATE FUNCTION GROUPS_EQUAL(g1 TEXT(10000), g2 TEXT(10000))
RETURNS INT
BEGIN
RETURN GROUP_SUBSET(g1, g2) AND GROUP_SUBSET(g2, g1);
END|
CREATE FUNCTION GROUP_DISJOINT_UNION(t1 TEXT(10000), t2 TEXT(10000), sum TEXT(10000))
RETURNS INT
BEGIN
RETURN GROUPS_EQUAL(GROUP_SUBTRACT(sum, t1), t2) AND
GROUPS_EQUAL(GROUP_SUBTRACT(sum, t2), t1);
END|
CREATE FUNCTION CHECK_GROUP_SET(old TEXT(10000), diff TEXT(10000), new TEXT(10000))
RETURNS INT
BEGIN
DECLARE tilde_pos INT DEFAULT LOCATE('~', diff);
DECLARE to_add TEXT(10000);
DECLARE to_remove TEXT(10000);
IF tilde_pos != 0 THEN
SET to_add = SUBSTR(diff, 1, tilde_pos - 1);
SET to_remove = SUBSTR(diff, tilde_pos + 1);
RETURN GROUP_SUBSET(to_remove, old) AND
GROUP_DISJOINT_UNION(GROUP_SUBTRACT(old, to_remove), to_add, new);
ELSE
RETURN GROUP_DISJOINT_UNION(old, diff, new);
END IF;
END|
CREATE FUNCTION NUMBER_TO_UUID(str TEXT(10000))
RETURNS TEXT(10000)
BEGIN
DECLARE pos INT DEFAULT 0;# pos. before next number to replace by UUID in str
DECLARE colon INT;               # position of next ':' after pos in str
DECLARE n TEXT(3);               # number between comma and colon
DECLARE nn TEXT(5);              # n, zero-padded to 2 digits, repeated twice
DECLARE _uuid TEXT(37);          # UUID generated from nn
DECLARE comma INT;               # position of next ',' after pos
DECLARE tilde INT;               # position of next '~' after pos
IF str = '' or str IS NULL THEN
RETURN str;
END IF;
IF SUBSTR(str, 1, 1) = '~' THEN
SET pos = 1;
END IF;
REPEAT
# find end of number
SET colon = LOCATE(':', str, pos + 1);
# get number
SET n = SUBSTR(str, pos + 1, colon - pos - 1);
# convert number to uuid
SET nn = REPEAT(LPAD(n, 2, '0'), 2);
SET _uuid = CONCAT(nn, nn, '-', nn, '-', nn, '-', nn, '-', nn, nn, nn);
# replace number by uuid
SET str = CONCAT(SUBSTR(str, 1, pos), _uuid, SUBSTR(str, colon));
# find next substring to replace
SET comma = LOCATE(',', str, pos + 1), tilde = LOCATE('~', str, pos + 1);
SET pos = IF(comma != 0 AND (tilde = 0 OR comma < tilde), comma, tilde);
UNTIL pos = 0 END REPEAT;
RETURN str;
END|
CREATE FUNCTION UUID_TO_NUMBER(str TEXT(10000))
RETURNS TEXT(10000)
BEGIN
DECLARE pos INT DEFAULT 0;       # position before next UUID in str
DECLARE colon INT;               # position of first ':' after pos in str
DECLARE _uuid TEXT(37);          # UUID between ',' and ':'
  DECLARE n TEXT(5);               # the two digits that are repeated in UUID
DECLARE comma INT;               # position of next ',' after pos
DECLARE tilde INT;               # position of next '~' after pos
IF str = '' or str IS NULL THEN
RETURN str;
END IF;
IF SUBSTR(str, 1, 1) = '~' THEN
SET pos = 1;
END IF;
# trim newlines
SET str = REPLACE(str, '\n', '');
REPEAT
# find end of substring of the form ",uuid:"
    SET colon = LOCATE(':', str, pos + 1);
# get the uuid
SET _uuid = SUBSTR(str, pos + 1, colon - pos - 1);
IF _uuid = @@GLOBAL.SERVER_UUID THEN
# strip server_uuid from string. make sure we dont strip ~
# before or after server_uuid.
SET comma = LOCATE(',', str, pos + 1), tilde = LOCATE('~', str, pos + 1);
IF comma != 0 AND (tilde = 0 OR tilde > comma) THEN
SET str = CONCAT(SUBSTR(str, 1, pos), SUBSTR(str, comma + 1));
ELSEIF tilde != 0 THEN
SET str = CONCAT(SUBSTR(str, 1, pos - 1), SUBSTR(str, tilde));
ELSE
SET str = SUBSTR(str, 1, pos - 1);
END IF;
ELSE
# get the number that repeats in UUID and remove leading zero
SET n = SUBSTR(str, pos + 1, 2);
IF SUBSTR(n, 1, 1) = '0' THEN
SET n = SUBSTR(n, 2, 1);
END IF;
# replace UUID by number
SET str = CONCAT(SUBSTR(str, 1, pos), n, SUBSTR(str, colon));
END IF;
# find next substring
SET comma = LOCATE(',', str, pos + 1), tilde = LOCATE('~', str, pos + 1);
SET pos = IF(comma != 0 AND (tilde = 0 OR comma < tilde), comma, tilde);
UNTIL pos = 0 END REPEAT;
RETURN str;
END|
CREATE table t (a INT) ENGINE = InnoDB;
######## Specify test cases ########
CREATE TABLE stmts (
id INT PRIMARY KEY NOT NULL,
stmt_type TEXT(10) NOT NULL,
next TEXT(100),
next_list TEXT(10000),
flags TEXT(3) NOT NULL,
global_ended TEXT(10000) NOT NULL,
global_partial TEXT(10000) NOT NULL,
session_ended TEXT(10000) NOT NULL,
session_partial TEXT(10000) NOT NULL,
error INT NOT NULL);
INSERT INTO stmts VALUES
#  id  STMT  NEXT  NEXT_LIST  FLAGS G_END     G_PART     S_END     S_PART   ERR
# simple groups
(10,'CRE','1:1', NULL,     'CE', '1:1',    '',        '',       '',       0)
,(11,'INS','1:3', NULL,     'CE', '1:3',    '',        '',       '',       0)
,(12,'CRE','1:2', NULL,     'CE', '1:2',    '',        '',       '',       0)
# split master-super-group over several, interleaved, one-stmt transactions
,(20,'INS','2:9', NULL,     'C',  '',       '2:9',     '',       '',       0)
,(21,'INS','2:8', NULL,     'C',  '',       '2:8',     '',       '',       0)
,(22,'INS','2:8', NULL,     'CE', '2:8',    '~2:8',    '',       '',       0)
,(23,'INS','2:9', NULL,     'CE', '2:9',    '~2:9',    '',       '',       0)
# split master-super-group over several, multi-stmt-transactions
,(30,'BEG','3:1', NULL,     '',   '',       '',        '',       '',       0)
,(31,'INS', 0,    0,        '',   '',       '',        '',       '3:1',    0)
,(32,'INS', 0,    0,        '',   '',       '',        '',       '',       0)
,(33,'INS', 0,    0,        'EC', '3:1',    '',        '',       '~3:1',   0)
,(34,'COM', 0,    0,        'C',  '',       '',        '',       '',       0)
# master-super-group containing several groups
,(40,'AC0','4:1','4:1-7',   '',   '',       '',        '',       '',       0)
,(41,'INS','4:2', 0,        '',   '',       '',        '',       '4:2',    0)
,(42,'INS','4:1', 0,        '',   '',       '',        '',       '4:1',    0)
,(43,'INS','4:3', 0,        'E',  '',       '',        '4:3',    '',       0)
,(44,'INS','4:1', 0,        'E',  '',       '',        '4:1',    '~4:1',   0)
,(45,'CRE','4:4', 0,        '',   '4:1:3',  '4:2:4',   '~4:1:3', '~4:2',   0)
,(46,'INS','4:5', 0,        '',   '',       '',        '',       '4:5',    0)
,(47,'INS','4:4', 0,        'E',  '',       '',        '4:4',    '',       0)
,(48,'COM','4:6', 0,        'EC', '4:4:6',  '4:5:7~4:4','~4:4',  '~4:5',   0)
# master-super-group with implicit pre-commit in the middle
,(50,'AC0','5:1','5:1-2',   '',   '',       '',        '',       '',       0)
,(51,'INS','5:1', 0,        '',   '',       '',        '',       '5:1',    0)
,(52,'CRE','5:2', 0,        'E',  '5:2',    '5:1',     '',       '~5:1',   0)
,(53,'INS','5:1', 0,        '',   '',       '',        '',       '5:1',    0)
,(54,'INS','5:1', 0,        'EC', '5:1',    '~5:1',    '',       '~5:1',   0)
# generate dummy subgroups
# todo: COMMIT with empty transaction does not invoke handler, hence nothing written
# ,(61,'INS','6:1','6:1-6',   '',   '',       '',        '',       '6:1',    0)
# ,(62,'COM','6:1', 0,        '',   '',       '6:1',     '',       '~6:1',   0)
# ,(63,'INS','6:2', 0,        '',   '',       '',        '',       '6:2',    0)
# ,(64,'COM','6:2', 0,        'E',  '6:2',    '',        '',       '~6:2',   0)
# ,(65,'COM','6:3', 0,        '',   '',       '',        '',       '',       0)
# ,(66,'COM','6:4', 0,        'E',  '6:4',    '',        '',       '',       0)
# ,(67,'COM','6:1', 0,        'E',  '6:1',    '~6:1',    '',       '',       0)
# ,(68,'COM','6:1', 0,        'C',  '6:5-6',  '',        '',       '',       0)
;
######## Test ########
======== row-id = 10 ========
SET UGID_NEXT='01010101-0101-0101-0101-010101010101:1', UGID_NEXT_LIST=NULL, UGID_END=1, UGID_COMMIT=1;
CREATE TABLE t_10 (a INT) ENGINE = InnoDB;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '' + '1:1' = '1:1']
======== row-id = 11 ========
SET UGID_NEXT='01010101-0101-0101-0101-010101010101:3', UGID_NEXT_LIST=NULL, UGID_END=1, UGID_COMMIT=1;
INSERT INTO t VALUES (11);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1' + '1:3' = '1:1:3']
======== row-id = 12 ========
SET UGID_NEXT='01010101-0101-0101-0101-010101010101:2', UGID_NEXT_LIST=NULL, UGID_END=1, UGID_COMMIT=1;
CREATE TABLE t_12 (a INT) ENGINE = InnoDB;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1:3' + '1:2' = '1:1-3']
======== row-id = 20 ========
SET UGID_NEXT='02020202-0202-0202-0202-020202020202:9', UGID_NEXT_LIST=NULL, UGID_END=0, UGID_COMMIT=1;
INSERT INTO t VALUES (20);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '2:9' = '2:9']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3' + '' = '1:1-3']
======== row-id = 21 ========
SET UGID_NEXT='02020202-0202-0202-0202-020202020202:8', UGID_NEXT_LIST=NULL, UGID_END=0, UGID_COMMIT=1;
INSERT INTO t VALUES (21);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '2:9' + '2:8' = '2:8-9']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3' + '' = '1:1-3']
======== row-id = 22 ========
SET UGID_NEXT='02020202-0202-0202-0202-020202020202:8', UGID_NEXT_LIST=NULL, UGID_END=1, UGID_COMMIT=1;
INSERT INTO t VALUES (22);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '2:8-9' + '~2:8' = '2:9']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3' + '2:8' = '1:1-3,2:8']
======== row-id = 23 ========
SET UGID_NEXT='02020202-0202-0202-0202-020202020202:9', UGID_NEXT_LIST=NULL, UGID_END=1, UGID_COMMIT=1;
INSERT INTO t VALUES (23);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '2:9' + '~2:9' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8' + '2:9' = '1:1-3,2:8-9']
======== row-id = 30 ========
SET UGID_NEXT='03030303-0303-0303-0303-030303030303:1', UGID_NEXT_LIST=NULL, UGID_END=0, UGID_COMMIT=0;
BEGIN;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9' + '' = '1:1-3,2:8-9']
======== row-id = 31 ========
SET UGID_END=0, UGID_COMMIT=0;
INSERT INTO t VALUES (31);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '3:1' = '3:1']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9' + '' = '1:1-3,2:8-9']
======== row-id = 32 ========
SET UGID_END=0, UGID_COMMIT=0;
INSERT INTO t VALUES (32);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '3:1' + '' = '3:1']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9' + '' = '1:1-3,2:8-9']
======== row-id = 33 ========
SET UGID_END=1, UGID_COMMIT=1;
INSERT INTO t VALUES (33);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '3:1' + '~3:1' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9' + '3:1' = '1:1-3,2:8-9,3:1']
======== row-id = 34 ========
SET UGID_END=0, UGID_COMMIT=1;
COMMIT;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1' + '' = '1:1-3,2:8-9,3:1']
======== row-id = 40 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:1', UGID_NEXT_LIST='04040404-0404-0404-0404-040404040404:1-7', UGID_END=0, UGID_COMMIT=0;
SET AUTOCOMMIT = 0;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1' + '' = '1:1-3,2:8-9,3:1']
======== row-id = 41 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:2', UGID_END=0, UGID_COMMIT=0;
INSERT INTO t VALUES (41);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '4:2' = '4:2']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1' + '' = '1:1-3,2:8-9,3:1']
======== row-id = 42 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:1', UGID_END=0, UGID_COMMIT=0;
INSERT INTO t VALUES (42);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '4:2' + '4:1' = '4:1-2']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1' + '' = '1:1-3,2:8-9,3:1']
======== row-id = 43 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:3', UGID_END=1, UGID_COMMIT=0;
INSERT INTO t VALUES (43);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '4:1-2' + '' = '4:1-2']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '4:3' = '4:3']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1' + '' = '1:1-3,2:8-9,3:1']
======== row-id = 44 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:1', UGID_END=1, UGID_COMMIT=0;
INSERT INTO t VALUES (44);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '4:1-2' + '~4:1' = '4:2']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '4:3' + '4:1' = '4:1:3']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1' + '' = '1:1-3,2:8-9,3:1']
======== row-id = 45 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:4', UGID_END=0, UGID_COMMIT=0;
CREATE TABLE t_45 (a INT) ENGINE = InnoDB;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '4:2' + '~4:2' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '' + '4:2:4' = '4:2:4']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '4:1:3' + '~4:1:3' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1' + '4:1:3' = '1:1-3,2:8-9,3:1,4:1:3']
======== row-id = 46 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:5', UGID_END=0, UGID_COMMIT=0;
INSERT INTO t VALUES (46);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '4:5' = '4:5']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:4' + '' = '4:2:4']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3' + '' = '1:1-3,2:8-9,3:1,4:1:3']
======== row-id = 47 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:4', UGID_END=1, UGID_COMMIT=0;
INSERT INTO t VALUES (47);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '4:5' + '' = '4:5']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:4' + '' = '4:2:4']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '4:4' = '4:4']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3' + '' = '1:1-3,2:8-9,3:1,4:1:3']
======== row-id = 48 ========
SET UGID_NEXT='04040404-0404-0404-0404-040404040404:6', UGID_END=1, UGID_COMMIT=1;
COMMIT;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '4:5' + '~4:5' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:4' + '4:5:7~4:4' = '4:2:5:7']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '4:4' + '~4:4' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3' + '4:4:6' = '1:1-3,2:8-9,3:1,4:1:3-4:6']
======== row-id = 50 ========
SET UGID_NEXT='05050505-0505-0505-0505-050505050505:1', UGID_NEXT_LIST='05050505-0505-0505-0505-050505050505:1-2', UGID_END=0, UGID_COMMIT=0;
SET AUTOCOMMIT = 0;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:5:7' + '' = '4:2:5:7']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3-4:6' + '' = '1:1-3,2:8-9,3:1,4:1:3-4:6']
======== row-id = 51 ========
SET UGID_NEXT='05050505-0505-0505-0505-050505050505:1', UGID_END=0, UGID_COMMIT=0;
INSERT INTO t VALUES (51);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '5:1' = '5:1']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:5:7' + '' = '4:2:5:7']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3-4:6' + '' = '1:1-3,2:8-9,3:1,4:1:3-4:6']
======== row-id = 52 ========
SET UGID_NEXT='05050505-0505-0505-0505-050505050505:2', UGID_END=1, UGID_COMMIT=0;
CREATE TABLE t_52 (a INT) ENGINE = InnoDB;
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '5:1' + '~5:1' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:5:7' + '5:1' = '4:2:5:7,5:1']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3-4:6' + '5:2' = '1:1-3,2:8-9,3:1,4:1:3-4:6,5:2']
======== row-id = 53 ========
SET UGID_NEXT='05050505-0505-0505-0505-050505050505:1', UGID_END=0, UGID_COMMIT=0;
INSERT INTO t VALUES (53);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '' + '5:1' = '5:1']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:5:7,5:1' + '' = '4:2:5:7,5:1']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3-4:6,5:2' + '' = '1:1-3,2:8-9,3:1,4:1:3-4:6,5:2']
======== row-id = 54 ========
SET UGID_NEXT='05050505-0505-0505-0505-050505050505:1', UGID_END=1, UGID_COMMIT=1;
INSERT INTO t VALUES (54);
include/assert.inc [@@SESSION.UGID_PARTIAL_GROUPS = '5:1' + '~5:1' = '']
include/assert.inc [@@GLOBAL.UGID_PARTIAL_GROUPS = '4:2:5:7,5:1' + '~5:1' = '4:2:5:7']
include/assert.inc [@@SESSION.UGID_ENDED_GROUPS = '' + '' = '']
include/assert.inc [@@GLOBAL.UGID_ENDED_GROUPS = '1:1-3,2:8-9,3:1,4:1:3-4:6,5:2' + '5:1' = '1:1-3,2:8-9,3:1,4:1:3-4:6,5:1-2']
######## Clean up ########
 DROP TABLE t_10; DROP TABLE t_12; DROP TABLE t_45; DROP TABLE t_52;;
DROP TABLE variables;
DROP TABLE stmts;
DROP TABLE t;
DROP FUNCTION GROUPS_EQUAL;
DROP FUNCTION CHECK_GROUP_SET;
DROP FUNCTION GROUP_DISJOINT_UNION;
DROP FUNCTION NUMBER_TO_UUID;
DROP FUNCTION UUID_TO_NUMBER;
include/rpl_end.inc
