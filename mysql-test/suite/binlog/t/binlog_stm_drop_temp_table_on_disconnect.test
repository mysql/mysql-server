# ====== Purpose =======
#
# This test verifies that DROP for a temporary table created
# in Statement mode is logged in binlog at session disconnect.
#
# ====== Implementation ======
#
# Create temporary tables in statement mode using different engines,
# now when you connect to the session after a disconnect print the
# output of show binlog events.
# This will verify that the DROP for temporary table created in stmt
# mode is written to binary log at session disconnect.
#
# ====== References =======
#
# Bug#24670909:USING TEMPORARY TABLES ON SLAVES INCREASES GTID SEQUENCE NUMBER
#
--source include/have_log_bin.inc
# This test case is specific to binlog_format=statement
--source include/have_binlog_format_statement.inc

RESET BINARY LOGS AND GTIDS;

CREATE TABLE t1(a INT) ENGINE=InnoDB;

--source include/count_sessions.inc

--connect(con1,localhost,root)

# A DROP should be logged for the following tables because CREATE TABLE
# is logged
CREATE TEMPORARY TABLE tmp1 ENGINE=InnoDB SELECT * FROM t1;
CREATE TEMPORARY TABLE tmp5 (a INT) ENGINE=InnoDB;
CREATE TEMPORARY TABLE tmp7 LIKE t1;

--disconnect con1
--connection default
--source include/wait_until_count_sessions.inc

--source include/rpl/deprecated/show_binlog_events.inc

DROP TABLE t1;

