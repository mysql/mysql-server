#
# Bug #13083023 - 60229: BROKEN COMPATIBILITY: ERROR WHILE CREATE TABLE
# WITH FOREIGN KEY CONSTRAINT.

#Server variable option 'lower_case_table_names' sets '0' as default value
#in case sensitive filesystem. Using 'lower_case_table_names=0' in case of
#insensitive filsystem is not allowed.
-- source include/have_case_sensitive_file_system.inc

CREATE TABLE PERSON (
  PERSON_ID VARCHAR(50) NOT NULL,
  DOB VARCHAR(50) NOT NULL,
  NAME NVARCHAR(255) NOT NULL,
  CONSTRAINT PK_PERSON PRIMARY KEY (PERSON_ID, DOB)
)Engine=InnoDB;


CREATE TABLE PHOTO (
  PERSON_ID VARCHAR(50) NOT NULL,
  DOB VARCHAR(50) NOT NULL,
  PHOTO_DETAILS VARCHAR(50) NULL,
  CONSTRAINT PK_PHOTO PRIMARY KEY (PERSON_ID, DOB),
  CONSTRAINT FK_PHOTO_2_PERSON FOREIGN KEY (PERSON_ID, DOB) REFERENCES PERSON (PERSON_ID, DOB)
)Engine=InnoDB;


CREATE TABLE ADDRESS (
  PERSON_ID VARCHAR(50) NOT NULL,
  DOB VARCHAR(50) NOT NULL,
  ADDRESS_ID VARCHAR(50) NOT NULL,
  ADDRESS_DETAILS NVARCHAR(250) NULL,
  CONSTRAINT PK_ADDRESS PRIMARY KEY (PERSON_ID, DOB, ADDRESS_ID),
  CONSTRAINT FK_ADDRESS_2_PERSON FOREIGN KEY (PERSON_ID, DOB) REFERENCES PERSON (PERSON_ID, DOB) ON DELETE CASCADE
)Engine=InnoDB;

INSERT INTO PERSON VALUES("10", "11011999", "John");
INSERT INTO PHOTO VALUES("10", "11011999", "new photo");

DROP TABLE PHOTO;
DROP TABLE ADDRESS;
DROP TABLE PERSON;

