--source include/have_valgrind.inc

CREATE TABLE t1 (c1 INT);
ALTER TABLE t1 ADD COLUMN c2 INT, ALGORITHM=INSTANT;
INSERT INTO t1 VALUES (1,1);

SELECT * FROM t1;
DROP TABLE t1;

--echo # Redundant:
CREATE TABLE t1_redundant (c1 INT) ROW_FORMAT=REDUNDANT, ENGINE=INNODB;
ALTER TABLE t1_redundant ADD COLUMN c2 INT, ALGORITHM=INSTANT;
INSERT INTO t1_redundant VALUES (1,1);

SHOW CREATE TABLE t1_redundant;
SELECT * FROM t1_redundant;
CHECK TABLE t1_redundant;
DROP TABLE t1_redundant;

--echo # Compact:
CREATE TABLE t1_compact (c1 INT) ROW_FORMAT=COMPACT, ENGINE=INNODB;
ALTER TABLE t1_compact ADD COLUMN c2 INT, ALGORITHM=INSTANT;
INSERT INTO t1_compact VALUES (1,1);

SHOW CREATE TABLE t1_compact;
SELECT * FROM t1_compact;
CHECK TABLE t1_compact;
DROP TABLE t1_compact;

--echo # Dynamic:
CREATE TABLE t1_dynamic (c1 INT) ROW_FORMAT=DYNAMIC, ENGINe=INNODB;
ALTER TABLE t1_dynamic ADD COLUMN c2 INT, ALGORITHM=INSTANT;
INSERT INTO t1_dynamic VALUES (1,1);

SHOW CREATE TABLE t1_dynamic;
SELECT * FROM t1_dynamic;
CHECK TABLE t1_dynamic;
DROP TABLE t1_dynamic;
