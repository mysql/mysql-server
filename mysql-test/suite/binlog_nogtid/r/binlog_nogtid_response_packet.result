SET SESSION SESSION_TRACK_GTIDS=ALL_GTIDS;
RESET BINARY LOGS AND GTIDS;
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (1);
COMMIT;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (2);
CREATE TABLE t2 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

INSERT INTO t2 VALUES (1);
SELECT * FROM t1;
c1
1
2
BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (2);
SAVEPOINT s;
INSERT INTO t1 VALUES (3);
ROLLBACK TO SAVEPOINT s;
ROLLBACK;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

DROP TABLE t1, t2;
SET SESSION SESSION_TRACK_GTIDS=OWN_GTID;
RESET BINARY LOGS AND GTIDS;
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (1);
COMMIT;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (2);
CREATE TABLE t2 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

INSERT INTO t2 VALUES (1);
SELECT * FROM t1;
c1
1
2
BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (2);
SAVEPOINT s;
INSERT INTO t1 VALUES (3);
ROLLBACK TO SAVEPOINT s;
ROLLBACK;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

DROP TABLE t1, t2;
SET SESSION SESSION_TRACK_GTIDS=OFF;
RESET BINARY LOGS AND GTIDS;
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (1);
COMMIT;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (2);
CREATE TABLE t2 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

INSERT INTO t2 VALUES (1);
SELECT * FROM t1;
c1
1
2
BEGIN;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- T_______

INSERT INTO t1 VALUES (2);
SAVEPOINT s;
INSERT INTO t1 VALUES (3);
ROLLBACK TO SAVEPOINT s;
ROLLBACK;
-- Tracker : SESSION_TRACK_TRANSACTION_STATE
-- ________

DROP TABLE t1, t2;
