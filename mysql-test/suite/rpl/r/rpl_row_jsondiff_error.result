include/master-slave.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the connection metadata repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.
[connection master]
######## Configure ########
# Configure slave_rows_search_algorithms on master
[connection master]
include/begin_replace_combination.inc [BOTH.BINLOG_FORMAT=ROW,MIXED,STATEMENT -> GLOBAL.SLAVE_ROWS_SEARCH_ALGORITHMS=INDEX_SCAN,HASH_SCAN,TABLE_SCAN]
Warnings:
Warning	1287	'@@slave_rows_search_algorithms' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
# Configure partial JSON on master
[connection master]
SET @old_binlog_row_image= @@SESSION.BINLOG_ROW_IMAGE;
SET @old_binlog_row_value_options= @@SESSION.BINLOG_ROW_VALUE_OPTIONS;
SET @@SESSION.BINLOG_ROW_IMAGE = 'MINIMAL';
SET @@SESSION.BINLOG_ROW_VALUE_OPTIONS = 'PARTIAL_JSON';
# Add error suppressions on slave
[connection slave]
call mtr.add_suppression("Could not execute Update_rows_partial event on table test.t");
call mtr.add_suppression("Can't find record in 't'");
call mtr.add_suppression("The replica coordinator and worker threads are stopped, possibly leaving data in inconsistent state");
call mtr.add_suppression("Replica: Could not apply JSON diff");
call mtr.add_suppression("Replica: Corrupted JSON diff");
call mtr.add_suppression("Replica: Corrupted replication event was detected");
call mtr.add_suppression("Replica: Got error 1610 - ");
call mtr.add_suppression("Replica: Got error 3648 - ");
call mtr.add_suppression("Replica: Got error 3649 - ");
call mtr.add_suppression("Replica: Got error 5 - ");
######## Test ########
[connection slave]
include/stop_slave.inc
******** ERROR MODE: FAIL ********
---- Configure slave ----
# Configure slave_rows_search_algorithms and binlog_format
[connection slave]
include/begin_replace_combination.inc [BOTH.BINLOG_FORMAT=ROW,MIXED,STATEMENT -> GLOBAL.SLAVE_ROWS_SEARCH_ALGORITHMS=INDEX_SCAN,HASH_SCAN,TABLE_SCAN]
Warnings:
Warning	1287	'@@slave_rows_search_algorithms' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
# Configure partial JSON
SET @old_binlog_row_image= @@GLOBAL.BINLOG_ROW_IMAGE;
SET @old_binlog_row_value_options= @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS;
SET @@GLOBAL.BINLOG_ROW_IMAGE = 'MINIMAL';
SET @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS = 'PARTIAL_JSON';
include/start_slave.inc
==== 1. E1. Path exists on master but not on slave, JSON_REMOVE ====
include/rpl_row_jsondiff_error_scenario [3648/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_REMOVE(j, '$[1].m') WHERE i = 1;
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 2. E1. Path exists on master but not on slave, JSON_SET ====
include/rpl_row_jsondiff_error_scenario [3648/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$[1].m', 2) WHERE i = 1;
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 3. E2. Path exists on slave but not on master ====
include/rpl_row_jsondiff_error_scenario [3648/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$[1].s', 2) WHERE i = 1;
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 4. E4. Violation of slave-only uniqueness constraint in generated column ====
include/rpl_row_jsondiff_error_scenario [1062/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON, g INT GENERATED ALWAYS AS (j->"$.id") VIRTUAL);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}'), (2, '{"id": 2, "value": "y"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON, g INT GENERATED ALWAYS AS (j->"$.id") VIRTUAL UNIQUE KEY);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}'), (2, '{"id": 2, "value": "y"}');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$.id', 2) WHERE i = 1;
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
[connection slave]
SET GLOBAL BINLOG_ROW_VALUE_OPTIONS = '';
include/stop_slave_sql.inc
include/start_slave_sql.inc
==== 5. E5. Out of memory applying diff ====
include/rpl_row_jsondiff_error_scenario [5/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'simulate_oom_in_apply_json_diffs' to @@GLOBAL.debug
UPDATE t SET j = JSON_SET(j, '$.id', REPEAT('a', 1024)) WHERE i = 1;
## Removing debug point 'simulate_oom_in_apply_json_diffs' from @@GLOBAL.debug
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
[connection slave]
SET GLOBAL BINLOG_ROW_VALUE_OPTIONS = 'PARTIAL_JSON';
include/stop_slave_sql.inc
include/start_slave_sql.inc
==== 6. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_op' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_op' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading operation type (invalid operation code) while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 7. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_path_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_path_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading path length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 8. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_path_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_path_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error skipping path while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 9. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_path' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_path' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading path length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 10. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_path_char' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_path_char' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=JSON_REPLACE(@2, 'ÿ$.i', '[1]')
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 11. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_doc_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_doc_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading value length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 12. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_doc_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_doc_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error skipping value while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 13. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_doc' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_doc' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading value length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 14. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_doc_char' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_doc_char' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=JSON_REPLACE(@2, '$.id', Error parsing json value while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 15. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [1610/FAIL]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_omit_last_column_from_table_map_event' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_omit_last_column_from_table_map_event' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
### UPDATE `test`.`t`
### WHERE
###   @1=12
### SET
### UPDATE `test`.`t`
### WHERE
###   @1=90466606
### SET
### UPDATE `test`.`t`
### WHERE
###   @1=NULL
### SET
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
---- Clean up partial JSON on slave ----
[connection slave]
SET @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS= @old_binlog_row_value_options;
SET @@GLOBAL.BINLOG_ROW_IMAGE= @old_binlog_row_image;
[connection slave]
include/rpl_restart_server.inc [server_number=2 parameters: --replica_skip_errors=1062,1032,3648,3649,1610,5]
[connection slave]
******** ERROR MODE: SKIP ********
---- Configure slave ----
# Configure slave_rows_search_algorithms and binlog_format
[connection slave]
include/begin_replace_combination.inc [BOTH.BINLOG_FORMAT=ROW,MIXED,STATEMENT -> GLOBAL.SLAVE_ROWS_SEARCH_ALGORITHMS=INDEX_SCAN,HASH_SCAN,TABLE_SCAN]
Warnings:
Warning	1287	'@@slave_rows_search_algorithms' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
# Configure partial JSON
SET @old_binlog_row_image= @@GLOBAL.BINLOG_ROW_IMAGE;
SET @old_binlog_row_value_options= @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS;
SET @@GLOBAL.BINLOG_ROW_IMAGE = 'MINIMAL';
SET @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS = 'PARTIAL_JSON';
include/start_slave.inc
==== 16. E1. Path exists on master but not on slave, JSON_REMOVE ====
include/rpl_row_jsondiff_error_scenario [3648/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_REMOVE(j, '$[1].m') WHERE i = 1;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 17. E1. Path exists on master but not on slave, JSON_SET ====
include/rpl_row_jsondiff_error_scenario [3648/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$[1].m', 2) WHERE i = 1;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 18. E2. Path exists on slave but not on master ====
include/rpl_row_jsondiff_error_scenario [3648/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$[1].s', 2) WHERE i = 1;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 19. E4. Violation of slave-only uniqueness constraint in generated column ====
include/rpl_row_jsondiff_error_scenario [1062/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON, g INT GENERATED ALWAYS AS (j->"$.id") VIRTUAL);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}'), (2, '{"id": 2, "value": "y"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON, g INT GENERATED ALWAYS AS (j->"$.id") VIRTUAL UNIQUE KEY);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}'), (2, '{"id": 2, "value": "y"}');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$.id', 2) WHERE i = 1;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
[connection slave]
SET GLOBAL BINLOG_ROW_VALUE_OPTIONS = '';
include/stop_slave_sql.inc
include/start_slave_sql.inc
==== 20. E5. Out of memory applying diff ====
include/rpl_row_jsondiff_error_scenario [5/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'simulate_oom_in_apply_json_diffs' to @@GLOBAL.debug
UPDATE t SET j = JSON_SET(j, '$.id', REPEAT('a', 1024)) WHERE i = 1;
## Removing debug point 'simulate_oom_in_apply_json_diffs' from @@GLOBAL.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
[connection slave]
SET GLOBAL BINLOG_ROW_VALUE_OPTIONS = 'PARTIAL_JSON';
include/stop_slave_sql.inc
include/start_slave_sql.inc
==== 21. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_op' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_op' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 22. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_path_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_path_length' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 23. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_path_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_path_length' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 24. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_path' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_path' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 25. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_path_char' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_path_char' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 26. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_doc_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_doc_length' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 27. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_doc_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_doc_length' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 28. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_doc' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_doc' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 29. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_doc_char' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_doc_char' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 30. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [1610/SKIP]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_omit_last_column_from_table_map_event' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_omit_last_column_from_table_map_event' from @@SESSION.debug
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
---- Clean up partial JSON on slave ----
[connection slave]
SET @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS= @old_binlog_row_value_options;
SET @@GLOBAL.BINLOG_ROW_IMAGE= @old_binlog_row_image;
[connection slave]
include/rpl_restart_server.inc [server_number=2 parameters: --skip-replica-start]
[connection slave]
SET GLOBAL REPLICA_EXEC_MODE = IDEMPOTENT;
******** ERROR MODE: IDEMPOTENT ********
---- Configure slave ----
# Configure slave_rows_search_algorithms and binlog_format
[connection slave]
include/begin_replace_combination.inc [BOTH.BINLOG_FORMAT=ROW,MIXED,STATEMENT -> GLOBAL.SLAVE_ROWS_SEARCH_ALGORITHMS=INDEX_SCAN,HASH_SCAN,TABLE_SCAN]
Warnings:
Warning	1287	'@@slave_rows_search_algorithms' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
# Configure partial JSON
SET @old_binlog_row_image= @@GLOBAL.BINLOG_ROW_IMAGE;
SET @old_binlog_row_value_options= @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS;
SET @@GLOBAL.BINLOG_ROW_IMAGE = 'MINIMAL';
SET @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS = 'PARTIAL_JSON';
include/start_slave.inc
==== 31. E1. Path exists on master but not on slave, JSON_REMOVE ====
include/rpl_row_jsondiff_error_scenario [3648/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_REMOVE(j, '$[1].m') WHERE i = 1;
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 32. E1. Path exists on master but not on slave, JSON_SET ====
include/rpl_row_jsondiff_error_scenario [3648/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$[1].m', 2) WHERE i = 1;
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 33. E2. Path exists on slave but not on master ====
include/rpl_row_jsondiff_error_scenario [3648/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"m" : 1}]');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '[1, {"s" : 1}]');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$[1].s', 2) WHERE i = 1;
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 34. E4. Violation of slave-only uniqueness constraint in generated column ====
include/rpl_row_jsondiff_error_scenario [1062/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON, g INT GENERATED ALWAYS AS (j->"$.id") VIRTUAL);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}'), (2, '{"id": 2, "value": "y"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON, g INT GENERATED ALWAYS AS (j->"$.id") VIRTUAL UNIQUE KEY);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}'), (2, '{"id": 2, "value": "y"}');
SET SQL_LOG_BIN = 1;
UPDATE t SET j = JSON_SET(j, '$.id', 2) WHERE i = 1;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
[connection slave]
SET GLOBAL BINLOG_ROW_VALUE_OPTIONS = '';
include/stop_slave_sql.inc
include/start_slave_sql.inc
==== 35. E5. Out of memory applying diff ====
include/rpl_row_jsondiff_error_scenario [5/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'simulate_oom_in_apply_json_diffs' to @@GLOBAL.debug
UPDATE t SET j = JSON_SET(j, '$.id', REPEAT('a', 1024)) WHERE i = 1;
## Removing debug point 'simulate_oom_in_apply_json_diffs' from @@GLOBAL.debug
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
[connection slave]
SET GLOBAL BINLOG_ROW_VALUE_OPTIONS = 'PARTIAL_JSON';
include/stop_slave_sql.inc
include/start_slave_sql.inc
==== 36. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_op' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_op' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading operation type (invalid operation code) while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 37. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_path_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_path_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading path length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 38. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_path_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_path_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error skipping path while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 39. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_path' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_path' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading path length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 40. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_path_char' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_path_char' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=JSON_REPLACE(@2, 'ÿ$.i', '[1]')
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 41. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_doc_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_doc_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading value length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 42. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_doc_length' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_doc_length' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error skipping value while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 43. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_truncate_before_doc' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_truncate_before_doc' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=Error reading value length to skip while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 44. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [3649/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_corrupt_json_diff_bad_doc_char' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_corrupt_json_diff_bad_doc_char' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
###   @2=JSON_REPLACE(@2, '$.id', Error parsing json value while printing JSON diff
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
==== 45. E6. Corruption in event ====
include/rpl_row_jsondiff_error_scenario [1610/IDEMPOTENT]
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
SET SQL_LOG_BIN = 0;
CREATE TABLE test.t (i INT PRIMARY KEY, j JSON);
INSERT INTO test.t (i, j) VALUES (1, '{"id": 1, "value": "x"}');
SET SQL_LOG_BIN = 1;
## Adding debug point 'binlog_omit_last_column_from_table_map_event' to @@SESSION.debug
UPDATE t SET j = JSON_SET(j, '$.id', '[1]') WHERE i = 1;
## Removing debug point 'binlog_omit_last_column_from_table_map_event' from @@SESSION.debug
### UPDATE `test`.`t`
### WHERE
###   @1=1
### SET
### UPDATE `test`.`t`
### WHERE
###   @1=12
### SET
### UPDATE `test`.`t`
### WHERE
###   @1=90466606
### SET
### UPDATE `test`.`t`
### WHERE
###   @1=NULL
### SET
RESET SLAVE;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
DROP TABLE test.t;
RESET SLAVE ALL;
Warnings:
Warning	1287	'RESET SLAVE' is deprecated and will be removed in a future release. Please use RESET REPLICA instead
RESET MASTER;
RESET MASTER;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root',SOURCE_PORT=MASTER_PORT,SOURCE_HOST='127.0.0.1';
---- Clean up partial JSON on slave ----
[connection slave]
SET @@GLOBAL.BINLOG_ROW_VALUE_OPTIONS= @old_binlog_row_value_options;
SET @@GLOBAL.BINLOG_ROW_IMAGE= @old_binlog_row_image;
[connection master]
SET @@SESSION.BINLOG_ROW_VALUE_OPTIONS= @old_binlog_row_value_options;
SET @@SESSION.BINLOG_ROW_IMAGE= @old_binlog_row_image;
include/end_replace_combination.inc [BOTH.BINLOG_FORMAT=ROW,MIXED,STATEMENT -> GLOBAL.SLAVE_ROWS_SEARCH_ALGORITHMS=INDEX_SCAN,HASH_SCAN,TABLE_SCAN]
Warnings:
Warning	1287	'@@slave_rows_search_algorithms' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
[connection slave]
include/stop_slave_sql.inc
include/end_replace_combination.inc [BOTH.BINLOG_FORMAT=ROW,MIXED,STATEMENT -> GLOBAL.SLAVE_ROWS_SEARCH_ALGORITHMS=INDEX_SCAN,HASH_SCAN,TABLE_SCAN]
Warnings:
Warning	1287	'@@slave_rows_search_algorithms' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
Warning	1287	'@@binlog_format' is deprecated and will be removed in a future release.
SET GLOBAL REPLICA_EXEC_MODE = STRICT;
include/rpl_end.inc
