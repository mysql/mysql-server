"================== Step 1 =================="
execute dump_thread;
event_name	count_star
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	0
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	0
wait/synch/rwlock/sql/LOCK_grant	0
execute dump_history;
event_name	count(event_name)
"================== con1 connected =================="
"================== Step 2 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	1
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	0
wait/synch/rwlock/sql/LOCK_grant	0
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	1
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	0
wait/synch/rwlock/sql/LOCK_grant	0
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	1
select get_lock("marker", 10);
get_lock("marker", 10)
1
select release_lock("marker");
release_lock("marker")
1
insert into test.t1 values ("marker");
"================== con1 marker =================="
"================== Step 3 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
"================== con2 connected =================="
"================== Step 4 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	1
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	0
wait/synch/rwlock/sql/LOCK_grant	0
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	5
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	5
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
select get_lock("marker", 10);
get_lock("marker", 10)
1
select release_lock("marker");
release_lock("marker")
1
insert into test.t1 values ("marker");
"================== con2 marker =================="
"================== Step 5 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	8
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	4
wait/synch/rwlock/sql/LOCK_grant	4
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	8
wait/synch/mutex/sql/LOCK_user_locks	4
wait/synch/rwlock/sql/LOCK_grant	4
"================== con3 connected =================="
"================== Step 6 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	1
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	0
wait/synch/rwlock/sql/LOCK_grant	0
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	9
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	4
wait/synch/rwlock/sql/LOCK_grant	4
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	9
wait/synch/mutex/sql/LOCK_user_locks	4
wait/synch/rwlock/sql/LOCK_grant	4
select get_lock("marker", 10);
get_lock("marker", 10)
1
select release_lock("marker");
release_lock("marker")
1
insert into test.t1 values ("marker");
"================== con3 marker =================="
"================== Step 7 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	12
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	6
wait/synch/rwlock/sql/LOCK_grant	6
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	12
wait/synch/mutex/sql/LOCK_user_locks	6
wait/synch/rwlock/sql/LOCK_grant	6
"================== con4 connected =================="
"================== Step 8 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	1
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	0
wait/synch/rwlock/sql/LOCK_grant	0
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	13
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	6
wait/synch/rwlock/sql/LOCK_grant	6
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	13
wait/synch/mutex/sql/LOCK_user_locks	6
wait/synch/rwlock/sql/LOCK_grant	6
select get_lock("marker", 10);
get_lock("marker", 10)
1
select release_lock("marker");
release_lock("marker")
1
insert into test.t1 values ("marker");
"================== con4 marker =================="
"================== Step 9 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	16
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	16
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
"================== con1 disconnected =================="
"================== Step 10 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	17
wait/synch/mutex/sql/LOCK_connection_count	1
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	17
wait/synch/mutex/sql/LOCK_connection_count	1
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
"================== con2 disconnected =================="
"================== Step 11 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	18
wait/synch/mutex/sql/LOCK_connection_count	2
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	18
wait/synch/mutex/sql/LOCK_connection_count	2
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
"================== con3 disconnected =================="
"================== Step 12 =================="
execute dump_thread;
event_name	count_star
wait/io/file/sql/query_log	4
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	2
wait/synch/rwlock/sql/LOCK_grant	2
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	19
wait/synch/mutex/sql/LOCK_connection_count	3
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	19
wait/synch/mutex/sql/LOCK_connection_count	3
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
"================== con4 disconnected =================="
"================== Step 13 =================="
execute dump_thread;
event_name	count_star
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	20
wait/synch/mutex/sql/LOCK_connection_count	4
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	20
wait/synch/mutex/sql/LOCK_connection_count	4
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
truncate performance_schema.events_waits_summary_by_thread_by_event_name;
"================== BY_THREAD truncated =================="
"================== Step 14 =================="
execute dump_thread;
event_name	count_star
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	20
wait/synch/mutex/sql/LOCK_connection_count	4
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	20
wait/synch/mutex/sql/LOCK_connection_count	4
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
truncate performance_schema.events_waits_summary_global_by_event_name;
"================== GLOBAL truncated =================="
"================== Step 18 =================="
execute dump_thread;
event_name	count_star
execute dump_global;
event_name	count_star
wait/io/file/sql/query_log	0
wait/synch/mutex/sql/LOCK_connection_count	0
wait/synch/mutex/sql/LOCK_user_locks	0
wait/synch/rwlock/sql/LOCK_grant	0
execute dump_history;
event_name	count(event_name)
wait/io/file/sql/query_log	20
wait/synch/mutex/sql/LOCK_connection_count	4
wait/synch/mutex/sql/LOCK_user_locks	8
wait/synch/rwlock/sql/LOCK_grant	8
