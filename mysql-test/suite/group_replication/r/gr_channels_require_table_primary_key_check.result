include/group_replication.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the 'START SLAVE Syntax' in the MySQL Manual for more information.
[connection server1]

# 1. Set `REQUIRE_TABLE_PRIMARY_KEY_CHECK` option for the applier channel
#    Start a member and check the `REQUIRE_TABLE_PRIMARY_KEY_CHECK` option is set
CHANGE MASTER TO REQUIRE_TABLE_PRIMARY_KEY_CHECK = OFF FOR CHANNEL "group_replication_applier";
include/start_and_bootstrap_group_replication.inc
include/assert.inc [require_table_primary_key_check in performance_schema.replication_applier_configuration is set to OFF for "group_replication_applier"]

# 2. Stop the applier to block server 2 recovery
include/gr_stop_applier_sql_thread.inc
STOP REPLICA SQL_THREAD FOR CHANNEL "group_replication_applier";

# 3. Set `REQUIRE_TABLE_PRIMARY_KEY_CHECK` option for the recovery channel
#    Start the member and check the `REQUIRE_TABLE_PRIMARY_KEY_CHECK` option is set
[connection server2]
CHANGE MASTER TO REQUIRE_TABLE_PRIMARY_KEY_CHECK = ON FOR CHANNEL "group_replication_recovery";
include/start_group_replication.inc
include/assert.inc [require_table_primary_key_check in performance_schema.replication_applier_configuration is set to ON for "group_replication_recovery"]

# 4. Cleanup
[connection server1]
include/gr_start_applier_sql_thread.inc
START REPLICA SQL_THREAD FOR CHANNEL "group_replication_applier";
[connection server2]
include/gr_wait_for_member_state.inc
include/group_replication_end.inc
