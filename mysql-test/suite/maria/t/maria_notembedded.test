# Tests which cannot be run in embedded server.

-- source include/not_embedded.inc
-- source include/have_maria.inc

let $default_engine=`select @@session.storage_engine`;
set session storage_engine=maria;

# Verify that INSERT DELAYED is disabled only for transactional tables
# ("embedded" server translates them to plain INSERT)

create table t1 (a int) row_format=page;
--error ER_ILLEGAL_HA
insert delayed into t1 values(1);
drop table t1;
create table t1 (a int) row_format=page transactional=0;
insert delayed into t1 values(1);
flush table t1;
select * from t1;
select count(*) from t1;
drop table t1;
create table t1 (a int) row_format=dynamic;
insert delayed into t1 values(1);
flush table t1;
select * from t1;
select count(*) from t1;
drop table t1;

--disable_result_log
--disable_query_log
eval set session storage_engine=$default_engine;
--enable_result_log
--enable_query_log
