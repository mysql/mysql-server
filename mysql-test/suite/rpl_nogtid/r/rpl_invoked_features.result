include/master-slave.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the 'START SLAVE Syntax' in the MySQL Manual for more information.
[connection master]
USE test;
DROP VIEW IF EXISTS v11;
DROP TABLE IF EXISTS t11,t12,t13;
DROP PROCEDURE IF EXISTS p11;
DROP FUNCTION IF EXISTS f1;
DROP FUNCTION IF EXISTS f2;
DROP EVENT IF EXISTS e11;
CREATE TABLE t11 (a INT NOT NULL PRIMARY KEY, b INT, c VARCHAR(64)) ENGINE=innodb;
INSERT INTO t11 VALUES (1,1,'1');
INSERT INTO t11 VALUES (2,2,UUID());
CREATE TABLE t12 (a INT UNIQUE, b INT, c VARCHAR(64)) ENGINE=innodb;
INSERT INTO t12 VALUES (1,1,'1');
INSERT INTO t12 VALUES (2,2,UUID());

CREATE VIEW v11 AS SELECT * FROM t11;
CREATE TRIGGER t11_tr1 BEFORE INSERT ON t11 FOR EACH ROW 
BEGIN
INSERT INTO t12 VALUES (NEW.a, NEW.b, NEW.c);
INSERT INTO t13 VALUES (NEW.a, NEW.b, NEW.c);
END|
CREATE TRIGGER t11_tr2 BEFORE UPDATE ON t11 FOR EACH ROW 
BEGIN
UPDATE t12 SET c = '';
UPDATE t13 SET c = '';
END|
CREATE EVENT e11 ON SCHEDULE EVERY 1 SECOND DISABLE DO
BEGIN
ALTER EVENT e11 DISABLE;
CALL p11(10, '');  
END|
CREATE FUNCTION f1 (x INT) RETURNS VARCHAR(64)
BEGIN
IF x > 5 THEN
RETURN UUID();
END IF;
RETURN '';
END|
CREATE FUNCTION f2 (x INT) RETURNS VARCHAR(64)
BEGIN
RETURN f1(x);
END|
CREATE PROCEDURE p11 (IN x INT, IN y VARCHAR(64))
BEGIN
INSERT IGNORE INTO t11 VALUES (x,x,y);
END|

CREATE TABLE t13 SELECT * FROM v11;
INSERT INTO t11 VALUES (3,3,'');
UPDATE t11 SET c='2' WHERE a = 1;
INSERT INTO t11 VALUES(4,4,f1(4));
INSERT INTO t11 VALUES (100,100,'');
CALL p11(5, UUID());
INSERT INTO t11 VALUES (101,101,'');
INSERT INTO t11 VALUES(6,6,f1(6));
INSERT INTO t11 VALUES (102,102,'');
INSERT INTO t11 VALUES(7,7,f2(7));
INSERT INTO t11 VALUES (103,103,'');

SET @old_event_scheduler= @@global.event_scheduler;
SET GLOBAL EVENT_SCHEDULER = on;
ALTER EVENT e11 ENABLE;
SET @@global.event_scheduler= @old_event_scheduler;

SHOW TABLES LIKE 't%';
Tables_in_test (t%)
t11
t12
t13
SELECT table_name FROM information_schema.views WHERE table_schema='test';
TABLE_NAME
v11
SELECT trigger_name, event_manipulation, event_object_table FROM information_schema.triggers WHERE trigger_schema='test';
TRIGGER_NAME	EVENT_MANIPULATION	EVENT_OBJECT_TABLE
t11_tr1	INSERT	t11
t11_tr2	UPDATE	t11
SELECT routine_type, routine_name FROM information_schema.routines WHERE routine_schema='test';
ROUTINE_TYPE	ROUTINE_NAME
FUNCTION	f1
FUNCTION	f2
PROCEDURE	p11
SELECT event_name, status FROM information_schema.events WHERE event_schema='test';
EVENT_NAME	STATUS
e11	DISABLED
SELECT COUNT(*) FROM t11;
COUNT(*)
12
SELECT a,b FROM t11 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103
SELECT COUNT(*) FROM t12;
COUNT(*)
12
SELECT a,b FROM t12 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103
SELECT COUNT(*) FROM t13;
COUNT(*)
12
SELECT a,b FROM t13 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103
SELECT a,b FROM v11 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103
include/sync_slave_sql_with_master.inc

SHOW TABLES LIKE 't%';
Tables_in_test (t%)
t11
t12
t13
SELECT table_name FROM information_schema.views WHERE table_schema='test';
TABLE_NAME
v11
SELECT trigger_name, event_manipulation, event_object_table FROM information_schema.triggers WHERE trigger_schema='test';
TRIGGER_NAME	EVENT_MANIPULATION	EVENT_OBJECT_TABLE
t11_tr1	INSERT	t11
t11_tr2	UPDATE	t11
SELECT routine_type, routine_name FROM information_schema.routines WHERE routine_schema='test';
ROUTINE_TYPE	ROUTINE_NAME
FUNCTION	f1
FUNCTION	f2
PROCEDURE	p11
SELECT event_name, status FROM information_schema.events WHERE event_schema='test';
EVENT_NAME	STATUS
e11	SLAVESIDE_DISABLED

SELECT COUNT(*) FROM t11;
COUNT(*)
12
SELECT a,b FROM t11 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103
SELECT COUNT(*) FROM t12;
COUNT(*)
12
SELECT a,b FROM t12 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103
SELECT COUNT(*) FROM t13;
COUNT(*)
12
SELECT a,b FROM t13 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103
SELECT a,b FROM v11 ORDER BY a;
a	b
1	1
2	2
3	3
4	4
5	5
6	6
7	7
10	10
100	100
101	101
102	102
103	103

UPDATE t11 SET c='';
UPDATE t12 SET c='';
UPDATE t13 SET c='';
ALTER TABLE t13 ORDER BY a;
include/sync_slave_sql_with_master.inc



DROP VIEW IF EXISTS v11;
DROP TABLE IF EXISTS t11,t12,t13;
DROP PROCEDURE IF EXISTS p11;
DROP FUNCTION IF EXISTS f1;
DROP FUNCTION IF EXISTS f2;
DROP EVENT IF EXISTS e11;
include/sync_slave_sql_with_master.inc
include/rpl_end.inc
