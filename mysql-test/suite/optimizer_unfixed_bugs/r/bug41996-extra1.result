set @bug41996_tmp=@@optimizer_switch;
set optimizer_switch='mrr=off';
DROP DATABASE IF EXISTS d1;
DROP DATABASE IF EXISTS d2;
DROP DATABASE IF EXISTS d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE     d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE     d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE     d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE     d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE     d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE     d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE     d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE     d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE     d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE     d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE     d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE     d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK   d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK   d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK   d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK   d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK   d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK   d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK   d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK   d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK   d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK   d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK   d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK   d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE   IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE   IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE   IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE   IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE   IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE   IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE   IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE   IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE   IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE   IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE   IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE   IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 TINYINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 SMALLINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 MEDIUMINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 INTEGER NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
CREATE DATABASE d1;
CREATE DATABASE d2;
CREATE DATABASE d3;
CREATE TABLE d1.t1 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d2.t2 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
CREATE TABLE d3.t3 (c1 BIGINT NOT NULL PRIMARY KEY, c2 INTEGER, KEY(c2));
INSERT INTO d1.t1 VALUES(1,1),(2,2),(3,3),(4,4),(5,5);
INSERT INTO d2.t2 VALUES(11,1),(12,1),(13,1),(14,2),(15,6);
INSERT INTO d3.t3 VALUES(21,11),(22,11),(23,13),(24,14),(25,15);
DELETE QUICK IGNORE d1.t1, d2.t2 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DELETE QUICK IGNORE d1.t1.*, d2.t2.*, d3.t3 FROM d1.t1, d2.t2, d3.t3 WHERE d1.t1.c1=d2.t2.c2 AND d2.t2.c1=d3.t3.c2;
SELECT * FROM d1.t1 ORDER BY c1;
c1	c2
3	3
4	4
5	5
SELECT * FROM d2.t2 ORDER BY c1;
c1	c2
12	1
15	6
SELECT * FROM d3.t3 ORDER BY c1;
c1	c2
21	11
22	11
23	13
24	14
25	15
DROP DATABASE d1;
DROP DATABASE d2;
DROP DATABASE d3;
set optimizer_switch=@bug41996_tmp;
