###############################################################################
#                                                                             #
# This test is aimed to focus on Spatial Analysis Functions.                  #
#                                                                             #
# Area()/ST_Area() function returns the area of the geometry if it is         #
# a polygon or multi-polygon or geometry-collection containing                #
# polygon or multi-polygon or both.                                           #
#                                                                             #
# Creation Date: 2014-06-03                                                   #
# Author : Pavan Naik                                                         #
#                                                                             #
###############################################################################

--source include/have_geometry.inc

############################################################################################
# Creating the spatial objects                                                             #
############################################################################################

--echo #Creating the spatial Geometry object
USE test;

--disable_warnings
DROP TABLE IF EXISTS gis_geometrycollection;
--enable_warnings

CREATE TABLE gis_geometrycollection (fid INTEGER NOT NULL PRIMARY KEY, g GEOMETRYCOLLECTION);

############################################################################################
# Inserting the values specific to the spatial objects                                     #
############################################################################################

# Geometric elements constructing a star and some of its elememts as base
SET @star_elem_vertical= 'POLYGON((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal= 'POLYGON((25 0,0 15,30 15,22 10,25 0))';
SET @star_center= 'POINT(15 10)';
SET @star_top= 'POINT(15 25)';
SET @star_bottom_left= 'POINT(5 0)';
SET @star_bottom_right= 'POINT(25 0)';
SET @star_bottom_points= 'MULTIPOINT(5 0,25 0)';
SET @star_all_points= 'MULTIPOINT(5 0,25 0,15 10,15 25)';
SET @star_line_horizontal= 'LINESTRING(10 15,20 15)';
SET @star_line_vertical= 'LINESTRING(15 5,15 25)';
SET @star_top_to_center= 'LINESTRING(15 25,15 10)';
SET @star_lines_near_horizontal= 'MULTILINESTRING((25 0,0 15,15 30,0 5))';
SET @star_lines_near_vertical= 'MULTILINESTRING((0 5,15 25,0 25))';
SET @star= 'POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))';
SET @star_elem_vertical_val= '((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal_val= '((25 0,0 15,30 15,22 10,25 0))';
SET @star_of_elems='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
SET @star_collection_elems='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';
SET @star_collection_multilinestr='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),MULTILINESTRING((25 0,0 15,15 30,0 5)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';

--echo #INSERT base star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (100,GeomFromText(@star)),
 (101,GeomFromText(@star_elem_vertical)),
 (102,GeomFromText(@star_elem_horizontal)),
 (103,GeomFromText(@star_of_elems)),
 (104,GeomFromText(@star_top)),
 (105,GeomFromText(@star_center)),
 (106,GeomFromText(@star_bottom_left)),
 (107,GeomFromText(@star_bottom_right)),
 (108,GeomFromText(@star_bottom_points)),
 (109,GeomFromText(@star_all_points)),
 (110,GeomFromText(@star_line_horizontal)),
 (111,GeomFromText(@star_line_vertical)),
 (112,GeomFromText(@star_top_to_center)),
 (113,GeomFromText(@star_lines_near_horizontal)),
 (114,GeomFromText(@star_lines_near_vertical)),
 (115,GeomFromText(@star_collection_elems)),
 (116,GeomFromText(@star_collection_multilinestr));
--enable_warnings

--echo #Checking the integrity of the above create/insert statements 

--echo #17 rows. 
SELECT count(astext(g) != 'NULL') FROM gis_geometrycollection;

############################################################################################
# Checking the spartial analysis functions                                                 #
############################################################################################

--echo #====================================================================================
--echo # Area(geometry)
--echo #====================================================================================

--echo #------------------------------------------------------------------------------------
--echo # point
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromText(@star_center));

SELECT Area(GeomFromText(@star_top));

SELECT Area(GeomFromText('POINT(2.34 -2.34)'));

SELECT Area(GeomFromText('POINT(1e308 -1e308)'));

SELECT Area(GeomFromText('POINT(-0.0000 0.000001)'));

SELECT Area(g) FROM gis_geometrycollection WHERE fid=105;

--echo #------------------------------------------------------------------------------------
--echo # multipoint
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromText(@star_all_points));

SELECT Area(GeomFromText(@star_bottom_points));

SELECT Area(GeomFromText('MULTIPOINT(0 0,0 0,0 0,0 0)'));

SELECT Area(GeomFromText('MULTIPOINT(0 0,0 5,5 5,5 0,0 0)'));

SELECT Area(GeomFromText('MULTIPOINT(1 -1,1e308 -1e308,0.0001 0.000)'));

SELECT Area(g) FROM gis_geometrycollection WHERE fid=108;

--echo #------------------------------------------------------------------------------------
--echo # linestring
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromText(@star_top_to_center));

SELECT Area(GeomFromText(@star_line_horizontal));

SELECT Area(GeomFromText('LINESTRING(0 0,-0.00 0,0.0 0)'));

SELECT Area(GeomFromText('LINESTRING(0 0,0 5,5 5,5 0,0 0)'));

SELECT Area(GeomFromText('LINESTRING(1 -1,1e308 -1e308,0.0001 0.000)'));

SELECT Area(g) FROM gis_geometrycollection WHERE fid=110;

--echo #------------------------------------------------------------------------------------
--echo # multilinestring
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromText(@star_lines_near_vertical));

SELECT Area(GeomFromText(@star_lines_near_horizontal));

SELECT Area(GeomFromText('MULTILINESTRING((0 0,-0.00 0),(0.0 0))'));

SELECT Area(GeomFromText('MULTILINESTRING((0 0,0 5,5 5,5 0,0 0))'));

SELECT Area(GeomFromText('MULTILINESTRING((0 10,10 0),(10 0,0 0),(0 0,10 10))'));

SELECT Area(GeomFromText('MULTILINESTRING((1 -1,1e308 -1e308,0.0001 0.000),(2 2,4 -9.002))'));

SELECT Area(g) FROM gis_geometrycollection WHERE fid=114;

--echo #------------------------------------------------------------------------------------
--echo # polygon
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromText(@star));

SELECT Area(GeomFromText(@star_elem_vertical));

SELECT Area(GeomFromText('POLYGON((0 0,0 5,5 5))'));

SELECT Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0,-10 0,-10 -10,0 -10))'));

SELECT Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0))'));

SELECT Area(GeomFromText('POLYGON((4 4,4 6,6 6,6 4,4 4),(0 0,0 10,10 10,10 0,0 0))'));

SELECT Area(GeomFromText('POLYGON((4 4,4 6,6 6,6 4,4 4),(8 8,8 10,10 10,10 8,8 8))'));

SELECT Area(g) FROM gis_geometrycollection WHERE fid=100;

--echo #------------------------------------------------------------------------------------
--echo # multipolygon
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromText(@star_of_elems));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,0 5,5 5)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 10,10 0,0 0)),((0 0,10 10,10 0)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10)),((10 10,10 15,15 15,10 10)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((4 4,4 6,6 6,6 4)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((4 4,4 6,6 6,6 4,4 4),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((4 4,4 6,6 6,6 4,4 4),(8 8,8 10,10 10,10 8,8 8)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((10 10,10 0,5 10,10 10)),((0 10,0 20,5 10,0 10)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0)),((0 0,0 10,10 10,10 0,0 0)))'));

SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0)),((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6)))'));

SELECT Area(g) FROM gis_geometrycollection WHERE fid=103;

--echo #------------------------------------------------------------------------------------
--echo # geometrycollection
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromText(@star_collection_elems));

SELECT Area(GeomFromText(@star_collection_multilinestr));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION()'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION()))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10)))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10),LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10)))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0)))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0)))))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4)),MULTIPOLYGON(((0 0,0 10,10 10,10 0)),((10 10,10 15,15 15,15 10,10 10))))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)),GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10))))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)),GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10))),GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4)),MULTIPOLYGON(((0 0,0 10,10 10,10 0)),((10 10,10 15,15 15,15 10,10 10)))))'));

SELECT Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)),GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10))),GEOMETRYCOLLECTION(GEOMETRYCOLLECTION()))'));

SELECT Area(g) FROM gis_geometrycollection WHERE fid=115;

--echo #====================================================================================
--echo # ST_Area(geometry)
--echo #====================================================================================

--echo #------------------------------------------------------------------------------------
--echo # point
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromText(@star_center));

SELECT ST_Area(GeomFromText(@star_top));

SELECT ST_Area(GeomFromText('POINT(2.34 -2.34)'));

SELECT ST_Area(GeomFromText('POINT(1e308 -1e308)'));

SELECT ST_Area(GeomFromText('POINT(-0.0000 0.000001)'));

SELECT ST_Area(g) FROM gis_geometrycollection WHERE fid=105;

--echo #------------------------------------------------------------------------------------
--echo # multipoint
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromText(@star_all_points));

SELECT ST_Area(GeomFromText(@star_bottom_points));

SELECT ST_Area(GeomFromText('MULTIPOINT(0 0,0 0,0 0,0 0)'));

SELECT ST_Area(GeomFromText('MULTIPOINT(0 0,0 5,5 5,5 0,0 0)'));

SELECT ST_Area(GeomFromText('MULTIPOINT(1 -1,1e308 -1e308,0.0001 0.000)'));

SELECT ST_Area(g) FROM gis_geometrycollection WHERE fid=108;

--echo #------------------------------------------------------------------------------------
--echo # linestring
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromText(@star_top_to_center));

SELECT ST_Area(GeomFromText(@star_line_horizontal));

SELECT ST_Area(GeomFromText('LINESTRING(0 0,-0.00 0,0.0 0)'));

SELECT ST_Area(GeomFromText('LINESTRING(0 0,0 5,5 5,5 0,0 0)'));

SELECT ST_Area(GeomFromText('LINESTRING(1 -1,1e308 -1e308,0.0001 0.000)'));

SELECT ST_Area(g) FROM gis_geometrycollection WHERE fid=110;

--echo #------------------------------------------------------------------------------------
--echo # multilinestring
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromText(@star_lines_near_vertical));

SELECT ST_Area(GeomFromText(@star_lines_near_horizontal));

SELECT ST_Area(GeomFromText('MULTILINESTRING((0 0,-0.00 0),(0.0 0))'));

SELECT ST_Area(GeomFromText('MULTILINESTRING((0 0,0 5,5 5,5 0,0 0))'));

SELECT ST_Area(GeomFromText('MULTILINESTRING((0 10,10 0),(10 0,0 0),(0 0,10 10))'));

SELECT ST_Area(GeomFromText('MULTILINESTRING((1 -1,1e308 -1e308,0.0001 0.000),(2 2,4 -9.002))'));

SELECT ST_Area(g) FROM gis_geometrycollection WHERE fid=114;

--echo #------------------------------------------------------------------------------------
--echo # polygon
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromText(@star));

SELECT ST_Area(GeomFromText(@star_elem_vertical));

SELECT ST_Area(GeomFromText('POLYGON((0 0,0 5,5 5))'));

SELECT ST_Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0,-10 0,-10 -10,0 -10))'));

SELECT ST_Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_Area(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Area(GeomFromText('POLYGON((4 4,4 6,6 6,6 4,4 4),(0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Area(GeomFromText('POLYGON((4 4,4 6,6 6,6 4,4 4),(8 8,8 10,10 10,10 8,8 8))'));

SELECT ST_Area(g) FROM gis_geometrycollection WHERE fid=100;

--echo #------------------------------------------------------------------------------------
--echo # multipolygon
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromText(@star_of_elems));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,0 5,5 5)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 10,10 0,0 0)),((0 0,10 10,10 0)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10)),((10 10,10 15,15 15,10 10)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((4 4,4 6,6 6,6 4)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((4 4,4 6,6 6,6 4,4 4),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((4 4,4 6,6 6,6 4,4 4),(8 8,8 10,10 10,10 8,8 8)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((10 10,10 0,5 10,10 10)),((0 10,0 20,5 10,0 10)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0)),((0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(0 0,0 10,10 10,10 0,0 0)),((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6)))'));

SELECT ST_Area(g) FROM gis_geometrycollection WHERE fid=103;

--echo #------------------------------------------------------------------------------------
--echo # geometrycollection
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromText(@star_collection_elems));

SELECT ST_Area(GeomFromText(@star_collection_multilinestr));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION()'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION()))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10)))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10),LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10)))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0)))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0)))))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4)),MULTIPOLYGON(((0 0,0 10,10 10,10 0)),((10 10,10 15,15 15,15 10,10 10))))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)),GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10))))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)),GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10))),GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4)),MULTIPOLYGON(((0 0,0 10,10 10,10 0)),((10 10,10 15,15 15,15 10,10 10)))))'));

SELECT ST_Area(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10),MULTIPOINT(0 0,10 10)),GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3),MULTILINESTRING((0 0,0 10,10 10,10 0),(10 10,10 15,15 15,10 10))),GEOMETRYCOLLECTION(GEOMETRYCOLLECTION()))'));

SELECT ST_Area(g) FROM gis_geometrycollection WHERE fid=115;

--echo #====================================================================================
--echo # Area(geometry), WKB data
--echo #====================================================================================

--echo #------------------------------------------------------------------------------------
--echo # point
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromWKB(0x010100000000000000000000000000000000000000));

SELECT Area(GeomFromWKB(0x01010000005CA0B4B32784B1498F3ACA087E5E1B4A));

SELECT Area(GeomFromWKB(0x0000000001BFF3AE147AE147AE0000000000000000));

SELECT Area(GeomFromWKB(0x0000000001FFE1CCF385EBC8A00000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # multipoint
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromWKB(0x01040000000300000001010000000000000000000000000000000000000001010000001EA7E8482EFFF43F00000000000000000101000000000000000000F03F000000000000F03F));

SELECT Area(GeomFromWKB(0x010400000003000000010100000048E17A14AE47F5BF000000000000000001010000000000000000000000B0726891ED7CBFBF0101000000000000007E842E410000000000002240));

SELECT Area(GeomFromWKB(0x00000000040000000300000000010000000000000000000000000000000000000000014024000000000000402400000000000000000000013FF428F5C28F5C293FFFAE147AE147AE));

SELECT Area(GeomFromWKB(0x0000000004000000030000000001000000000000000000000000000000000000000001C02400000000000040240000000000000000000001601DD55745CBB7EDE8D56785FBBDD55A));

--echo #------------------------------------------------------------------------------------
--echo # linestring
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromWKB(0x010200000002000000EB73B515FBCBF1BF2B8716D9CEF7F13FF7C77BD5CA84BF3FDD2406819543CBBF));

SELECT Area(GeomFromWKB(0x010200000003000000EB73B515FBCBF1BF2B8716D9CEF7F13F1B695743B8179E47EA8CA039593E294621D7E6FAE031F445350332B7F4AD5445));

SELECT Area(GeomFromWKB(0x000000000200000003000000000000000000000000000000000000000000000000402400000000000040240000000000000000000000000000));

SELECT Area(GeomFromWKB(0x00000000020000000300000000000000003FE3D70A3D70A3D73FCB4395810624DDC024000000000000BFE224DD2F1A9FBE0000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # multilinestring
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromWKB(0x01050000000100000001020000000200000000000000000000000000000000002440000000000000F0BFD7A3703D0AD70140));

SELECT Area(GeomFromWKB(0x01050000000200000001020000000200000000000000000000000000000000002440000000000000F0BFD7A3703D0AD70140010200000003000000000000000000000000000000000000000000000000001440000000000000144000000000000024400000000000002440));

SELECT Area(GeomFromWKB(0x000000000500000002000000000200000003000000000000000000000000000000000000000000000000402400000000000040240000000000000000000000000000000000000200000003000000000000000000000000000000000000000000000000402400000000000040240000000000000000000000000000));

SELECT Area(GeomFromWKB(0x0000000005000000020000000002000000035FB317E5EF3AB327E3A4B378469B67320000000000000000C0240000000000003FF05FD8ADAB9F560000000000000000000000000200000003000000000000000000000000000000000000000000000000BFF08B439581062540240000000000004341C37937E08000));

--echo #------------------------------------------------------------------------------------
--echo # polygon
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromWKB(0x0103000000010000000400000000000000000000000000000000000000000000000000244000000000000000000000000000002440000000000000244000000000000000000000000000000000));

SELECT Area(GeomFromWKB(0x01030000000200000004000000000000000000000000000000000000000000000000002440000000000000000000000000000024400000000000002440000000000000000000000000000000000400000000000000000000400000000000000040000000000000004000000000000010400000000000001040000000000000104000000000000000400000000000000040));

SELECT Area(GeomFromWKB(0x0000000003000000010000000400000000000000000000000000000000402400000000000000000000000000004024000000000000402400000000000000000000000000000000000000000000));

SELECT Area(GeomFromWKB(0x00000000030000000200000004000000000000000000000000000000004024000000000000000000000000000040240000000000004024000000000000000000000000000000000000000000000000000440000000000000004000000000000000400000000000000040100000000000004010000000000000401000000000000040000000000000004000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # multipolygon
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromWKB(0x0106000000010000000103000000010000000400000000000000000000000000000000000000000000000000244000000000000000000000000000002440000000000000244000000000000000000000000000000000));

SELECT Area(GeomFromWKB(0x01060000000100000001030000000200000004000000000000000000000000000000000000000000000000002440000000000000000000000000000024400000000000002440000000000000000000000000000000000400000000000000000000400000000000000040000000000000004000000000000010400000000000001040000000000000104000000000000000400000000000000040));

SELECT Area(GeomFromWKB(0x0000000006000000010000000003000000010000000400000000000000000000000000000000402400000000000000000000000000004024000000000000402400000000000000000000000000000000000000000000));

SELECT Area(GeomFromWKB(0x00000000060000000100000000030000000200000004000000000000000000000000000000004024000000000000000000000000000040240000000000004024000000000000000000000000000000000000000000000000000440000000000000004000000000000000400000000000000040100000000000004010000000000000401000000000000040000000000000004000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # geometrycollection
--echo #------------------------------------------------------------------------------------
SELECT Area(GeomFromWKB(0x010700000002000000010100000000000000000024400000000000002440010200000002000000000000000000F03F000000000000F03F00000000000000400000000000000040));

SELECT Area(GeomFromWKB(0x0107000000010000000103000000010000000400000000000000000000000000000000000000000000000000000000000000000024400000000000002440000000000000244000000000000000000000000000000000));

SELECT Area(GeomFromWKB(0x0000000007000000020000000001402400000000000040240000000000000000000002000000023FF00000000000003FF000000000000040000000000000004000000000000000));

SELECT Area(GeomFromWKB(0x0000000007000000010000000003000000010000000400000000000000000000000000000000000000000000000040240000000000004024000000000000402400000000000000000000000000000000000000000000));

--echo #====================================================================================
--echo # ST_Area(geometry), WKB data
--echo #====================================================================================

--echo #------------------------------------------------------------------------------------
--echo # point
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromWKB(0x010100000000000000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x01010000005CA0B4B32784B1498F3ACA087E5E1B4A));

SELECT ST_Area(GeomFromWKB(0x0000000001BFF3AE147AE147AE0000000000000000));

SELECT ST_Area(GeomFromWKB(0x0000000001FFE1CCF385EBC8A00000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # multipoint
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromWKB(0x01040000000300000001010000000000000000000000000000000000000001010000001EA7E8482EFFF43F00000000000000000101000000000000000000F03F000000000000F03F));

SELECT ST_Area(GeomFromWKB(0x010400000003000000010100000048E17A14AE47F5BF000000000000000001010000000000000000000000B0726891ED7CBFBF0101000000000000007E842E410000000000002240));

SELECT ST_Area(GeomFromWKB(0x00000000040000000300000000010000000000000000000000000000000000000000014024000000000000402400000000000000000000013FF428F5C28F5C293FFFAE147AE147AE));

SELECT ST_Area(GeomFromWKB(0x0000000004000000030000000001000000000000000000000000000000000000000001C02400000000000040240000000000000000000001601DD55745CBB7EDE8D56785FBBDD55A));

--echo #------------------------------------------------------------------------------------
--echo # linestring
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromWKB(0x010200000002000000EB73B515FBCBF1BF2B8716D9CEF7F13FF7C77BD5CA84BF3FDD2406819543CBBF));

SELECT ST_Area(GeomFromWKB(0x010200000003000000EB73B515FBCBF1BF2B8716D9CEF7F13F1B695743B8179E47EA8CA039593E294621D7E6FAE031F445350332B7F4AD5445));

SELECT ST_Area(GeomFromWKB(0x000000000200000003000000000000000000000000000000000000000000000000402400000000000040240000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x00000000020000000300000000000000003FE3D70A3D70A3D73FCB4395810624DDC024000000000000BFE224DD2F1A9FBE0000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # multilinestring
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromWKB(0x01050000000100000001020000000200000000000000000000000000000000002440000000000000F0BFD7A3703D0AD70140));

SELECT ST_Area(GeomFromWKB(0x01050000000200000001020000000200000000000000000000000000000000002440000000000000F0BFD7A3703D0AD70140010200000003000000000000000000000000000000000000000000000000001440000000000000144000000000000024400000000000002440));

SELECT ST_Area(GeomFromWKB(0x000000000500000002000000000200000003000000000000000000000000000000000000000000000000402400000000000040240000000000000000000000000000000000000200000003000000000000000000000000000000000000000000000000402400000000000040240000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x0000000005000000020000000002000000035FB317E5EF3AB327E3A4B378469B67320000000000000000C0240000000000003FF05FD8ADAB9F560000000000000000000000000200000003000000000000000000000000000000000000000000000000BFF08B439581062540240000000000004341C37937E08000));

--echo #------------------------------------------------------------------------------------
--echo # polygon
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromWKB(0x0103000000010000000400000000000000000000000000000000000000000000000000244000000000000000000000000000002440000000000000244000000000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x01030000000200000004000000000000000000000000000000000000000000000000002440000000000000000000000000000024400000000000002440000000000000000000000000000000000400000000000000000000400000000000000040000000000000004000000000000010400000000000001040000000000000104000000000000000400000000000000040));

SELECT ST_Area(GeomFromWKB(0x0000000003000000010000000400000000000000000000000000000000402400000000000000000000000000004024000000000000402400000000000000000000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x00000000030000000200000004000000000000000000000000000000004024000000000000000000000000000040240000000000004024000000000000000000000000000000000000000000000000000440000000000000004000000000000000400000000000000040100000000000004010000000000000401000000000000040000000000000004000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # multipolygon
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromWKB(0x0106000000010000000103000000010000000400000000000000000000000000000000000000000000000000244000000000000000000000000000002440000000000000244000000000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x01060000000100000001030000000200000004000000000000000000000000000000000000000000000000002440000000000000000000000000000024400000000000002440000000000000000000000000000000000400000000000000000000400000000000000040000000000000004000000000000010400000000000001040000000000000104000000000000000400000000000000040));

SELECT ST_Area(GeomFromWKB(0x0000000006000000010000000003000000010000000400000000000000000000000000000000402400000000000000000000000000004024000000000000402400000000000000000000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x00000000060000000100000000030000000200000004000000000000000000000000000000004024000000000000000000000000000040240000000000004024000000000000000000000000000000000000000000000000000440000000000000004000000000000000400000000000000040100000000000004010000000000000401000000000000040000000000000004000000000000000));

--echo #------------------------------------------------------------------------------------
--echo # geometrycollection
--echo #------------------------------------------------------------------------------------
SELECT ST_Area(GeomFromWKB(0x010700000002000000010100000000000000000024400000000000002440010200000002000000000000000000F03F000000000000F03F00000000000000400000000000000040));

SELECT ST_Area(GeomFromWKB(0x0107000000010000000103000000010000000400000000000000000000000000000000000000000000000000000000000000000024400000000000002440000000000000244000000000000000000000000000000000));

SELECT ST_Area(GeomFromWKB(0x0000000007000000020000000001402400000000000040240000000000000000000002000000023FF00000000000003FF000000000000040000000000000004000000000000000));

SELECT ST_Area(GeomFromWKB(0x0000000007000000010000000003000000010000000400000000000000000000000000000000000000000000000040240000000000004024000000000000402400000000000000000000000000000000000000000000));

--echo #====================================================================================
--echo # Area(geometry) with different SRID values
--echo #====================================================================================

SELECT Area(GeomFromText(@star_center,-1024));

SELECT Area(GeomFromText(@star_all_points,-1));

SELECT Area(GeomFromText(@star_top_to_center,0));

SELECT Area(GeomFromText(@star_lines_near_vertical,1000));

SELECT Area(GeomFromText(@star,123456789));

SELECT Area(GeomFromText(@star_elem_vertical,4294967295));

SELECT Area(GeomFromText(@star_of_elems,4294967296));

SELECT Area(GeomFromText(@star_collection_elems,4294967295000));

--echo #====================================================================================
--echo # ST_Area(geometry) with different SRID values
--echo #====================================================================================

SELECT ST_Area(GeomFromText(@star_center,-1024));

SELECT ST_Area(GeomFromText(@star_all_points,-1));

SELECT ST_Area(GeomFromText(@star_top_to_center,0));

SELECT ST_Area(GeomFromText(@star_lines_near_vertical,1000));

SELECT ST_Area(GeomFromText(@star,123456789));

SELECT ST_Area(GeomFromText(@star_elem_vertical,4294967295));

SELECT ST_Area(GeomFromText(@star_of_elems,4294967296));

SELECT ST_Area(GeomFromText(@star_collection_elems,4294967295000));

--echo #====================================================================================
--echo # Area(geometry) with different SRID values, WKB data
--echo #====================================================================================

SELECT Area(GeomFromWKB(0x010100000000000000000000000000000000000000,-1024));

SELECT Area(GeomFromWKB(0x01010000005CA0B4B32784B1498F3ACA087E5E1B4A,-1));

SELECT Area(GeomFromWKB(0x0000000001BFF3AE147AE147AE0000000000000000,0));

SELECT Area(GeomFromWKB(0x0000000001FFE1CCF385EBC8A00000000000000000,100000));

SELECT Area(GeomFromWKB(0x010200000002000000EB73B515FBCBF1BF2B8716D9CEF7F13FF7C77BD5CA84BF3FDD2406819543CBBF,4294967295));

SELECT Area(GeomFromWKB(0x0107000000010000000103000000010000000400000000000000000000000000000000000000000000000000000000000000000024400000000000002440000000000000244000000000000000000000000000000000,4294967296));

SELECT Area(GeomFromWKB(0x0000000007000000010000000003000000010000000400000000000000000000000000000000000000000000000040240000000000004024000000000000402400000000000000000000000000000000000000000000,4294967295000));

--echo #====================================================================================
--echo # ST_Area(geometry) with different SRID values, WKB data
--echo #====================================================================================

SELECT ST_Area(GeomFromWKB(0x010100000000000000000000000000000000000000,-1024));

SELECT ST_Area(GeomFromWKB(0x01010000005CA0B4B32784B1498F3ACA087E5E1B4A,-1));

SELECT ST_Area(GeomFromWKB(0x0000000001BFF3AE147AE147AE0000000000000000,0));

SELECT ST_Area(GeomFromWKB(0x0000000001FFE1CCF385EBC8A00000000000000000,100000));

SELECT ST_Area(GeomFromWKB(0x010200000002000000EB73B515FBCBF1BF2B8716D9CEF7F13FF7C77BD5CA84BF3FDD2406819543CBBF,4294967295));

SELECT ST_Area(GeomFromWKB(0x0107000000010000000103000000010000000400000000000000000000000000000000000000000000000000000000000000000024400000000000002440000000000000244000000000000000000000000000000000,4294967296));

SELECT ST_Area(GeomFromWKB(0x0000000007000000010000000003000000010000000400000000000000000000000000000000000000000000000040240000000000004024000000000000402400000000000000000000000000000000000000000000,4294967295000));

--echo #====================================================================================
--echo # Invalid function calls
--echo #====================================================================================

--echo #---------------------------------------------------------------------------------------
--echo # Area()
--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT Area();

SELECT Area(NULL);

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POINT()'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('LINESTRING()'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON(())'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('MULTIPOINT()'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('MULTILINESTRING(())'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('MULTIPOLYGON((()))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POINT(a 0)'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POINT(! 0)'));

--error ER_PARSE_ERROR
SELECT Area(GeomFromText('POINT('!' 0)'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POINT(12,34 0)'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('LINESTRING(a 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('LINESTRING(0 0,! 10)'));

--error ER_PARSE_ERROR
SELECT Area(GeomFromText('LINESTRING('!' 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('LINESTRING(12,34 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON((a 0,10 10,10 0,0 0))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON((0 0,! 10,10 0,0 0))'));

--error ER_PARSE_ERROR
SELECT Area(GeomFromText('POLYGON(('!' 0,10 10,10 0,0 0))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON((12,34 0,10 10,10 0,0 0))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON((0 0))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON((0 0,5 5))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON((0 0,5 5,10 10))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('POLYGON((0 0,0 5,10 10),(0 0))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,5 5,10 10)),((10 10)))'));

--error ER_GIS_INVALID_DATA
SELECT Area(GeomFromText('MULTIPOLYGON(((0 0,5 5,10 10)),((10 10))'));

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT Area(0x000000000200000000000000000000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT Area(0x010100000001000000010100000000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT Area(0x010100000002000000000000000000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT Area(0x000000000600000001000000000200000002000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT Area(0x000000000200000001000000050000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT Area(0x010300000002000000010300000002000000050000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT Area(0x010400000002000000010100000000000000000000);

--echo #---------------------------------------------------------------------------------------
--echo # ST_Area()
--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_Area();

SELECT ST_Area(NULL);

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POINT()'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('LINESTRING()'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON(())'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('MULTIPOINT()'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('MULTILINESTRING(())'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('MULTIPOLYGON((()))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POINT(a 0)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POINT(! 0)'));

--error ER_PARSE_ERROR
SELECT ST_Area(GeomFromText('POINT('!' 0)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POINT(12,34 0)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('LINESTRING(a 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('LINESTRING(0 0,! 10)'));

--error ER_PARSE_ERROR
SELECT ST_Area(GeomFromText('LINESTRING('!' 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('LINESTRING(12,34 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON((a 0,10 10,10 0,0 0))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON((0 0,! 10,10 0,0 0))'));

--error ER_PARSE_ERROR
SELECT ST_Area(GeomFromText('POLYGON(('!' 0,10 10,10 0,0 0))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON((12,34 0,10 10,10 0,0 0))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON((0 0))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON((0 0,5 5))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON((0 0,5 5,10 10))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('POLYGON((0 0,0 5,10 10),(0 0))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,5 5,10 10)),((10 10)))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Area(GeomFromText('MULTIPOLYGON(((0 0,5 5,10 10)),((10 10))'));

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_Area(0x000000000200000000000000000000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_Area(0x010100000001000000010100000000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_Area(0x010100000002000000000000000000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_Area(0x000000000600000001000000000200000002000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_Area(0x000000000200000001000000050000000000000000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_Area(0x010300000002000000010300000002000000050000);

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_Area(0x010400000002000000010100000000000000000000);

--echo #clean up
--disable_warnings
DROP TABLE IF EXISTS gis_geometrycollection;
--enable_warnings
