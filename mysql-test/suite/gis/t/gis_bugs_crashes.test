#########################################################################################
#                                                                                       #
# This test contains test cases for all GIS bugs and crashes/assertion failures.        #
#                                                                                       #
# Creation Date: 2014-06-03                                                             #
# Author : Pavan Naik                                                                   #
#                                                                                       #
#########################################################################################

--source include/have_geometry.inc

--echo ######################################################################################################
--echo # BUG#18900932 : ERROR MESSAGE ISN'T SENT TO CLIENT WHEN SERVER REPORTS ONE
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_AREA(ST_GEOMFROMTEXT('POLYGON((0 0,5 5))'));

--error ER_GIS_INVALID_DATA
SELECT ST_AREA(ST_GEOMFROMTEXT('POLYGON((4 4,6 4,8 4,4 4))'));

--echo ######################################################################################################
--echo # BUG#18911154 : CENTROID() RETURNING ERROR MESSAGE FOR VALID GEOMETRY-COLLECTION GEOMETRY
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('MULTIPOINT(0 0,10 10)')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(0 0,10 10))')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))')));

--echo ######################################################################################################
--echo # BUG#18919820 : CONVEXHULL() FUNCTION PRODUCES INVALID POLYGON AS THE RESULT
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('MULTIPOINT(5 0,25 0,15 10,15 25)')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('POLYGON((5 0,15 25,25 0,15 5,5 0))')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((4 4,4 6,6 6,6 4,4 4)))')));

--echo ######################################################################################################
--echo # BUG#18935403 : SPATIAL ANALYSIS FUNCTIONS NOT RETURNING CONSISTENT RESULTS
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()')));

SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()')));

SELECT ST_DISTANCE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()'));

SELECT ST_DISTANCE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()'),ST_GEOMFROMTEXT('POINT(10 10)'));

SELECT ST_DISTANCE(ST_GEOMFROMTEXT('POINT(10 10)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()'));

--echo ######################################################################################################
--echo # BUG#18957010 : CONVEXHULL() FUNCTION RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('MULTIPOINT(5 -3,0 2,5 7,10 2,10 0,10 -2)')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('MULTIPOINT(5 0,0 5,5 10,10 5,10 -5)')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('MULTIPOINT(2 -5,2 5,8 5,8 2,8 0)')));

--echo ######################################################################################################
--echo # BUG#18972363 : CENTROID() FUNCTION RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,0 10,10 10,10 0),LINESTRING(0 0,10 0,10 -10,0 -10))')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,10 0,10 10,0 10),LINESTRING(0 0,10 0,10 -10,0 -10))')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)),POLYGON((0 0,10 0,10 -10,0 -10,0 0)))')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,0 10,10 10,10 0,0 0),LINESTRING(0 0,10 0,10 -10,0 -10,0 0))')));

--echo ######################################################################################################
--echo # BUG#18991528 : LONGFROMGEOHASH() DECODING FUNCTION ACCEPTS NON-STRING VALUE AS THE ARGUMENT
--echo ######################################################################################################

--error ER_INCORRECT_TYPE
SELECT ST_LONGFROMGEOHASH(0123456789);

--error ER_INCORRECT_TYPE
SELECT ST_LONGFROMGEOHASH(9876543210);

--error ER_INCORRECT_TYPE
SELECT ST_LONGFROMGEOHASH(1);

--echo ######################################################################################################
--echo # BUG#19019796 : LONGFROMGEOHASH() AND LATFROMGEOHASH() FUNCTIONS RETURN -0 AS THE RESULT
--echo ######################################################################################################

SELECT ST_LONGFROMGEOHASH("GZZZZZZZZZZZZZZZZZZZ");

SELECT ST_LONGFROMGEOHASH("7ZZZZZZZZZZZZZZZZZZZ");

SELECT ST_LATFROMGEOHASH("7ZZZZZZZZZZZZZZZZZZZ");

SELECT ST_LATFROMGEOHASH("RZZZZZZZZZZZZZZZZZZZ");

--echo ######################################################################################################
--echo # BUG#19076184 : ST_GEOHASH() FUNCTION ACCEPTS NON-INTEGER VALUES FOR MAXLENGTH PARAMETER
--echo ######################################################################################################

--error ER_INCORRECT_TYPE
SELECT ST_GEOHASH(180,90,10.1);

--error ER_INCORRECT_TYPE
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 90)'),20.0001);

--error ER_INCORRECT_TYPE
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 90)'),(CAST(10 AS BINARY)));

--echo ######################################################################################################
--echo # BUG#19133043 : REPRESENTATION OF THE SAME POINT GEOMETRY ISSUE WITH SPATIAL ANALYSIS FUNCTIONS
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('POINT(-0 0)')));

SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('POINT(0 -0)')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('POINT(0 -0)')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('POINT(-0 0)')));

--echo ######################################################################################################
--echo # BUG#19142227 : ENVELOPE() SPATIAL ANALYSIS FUNCTION ACCEPTS INVALID POLYGONS AS THE ARGUMENT
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('POLYGON((0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('POLYGON((0 0,5 5))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('POLYGON((0 0,5 5,10 10))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,5 5)),((1 1,1 1,1 1,1 1)))')));

--echo ######################################################################################################
--echo # BUG#19154955 : ST_GEOHASH() FUNCTION RETURNS BINARY DATA INSTEAD OF TEXT WITH A CHARSET
--echo ######################################################################################################

SELECT ST_LONGFROMGEOHASH(ST_GEOHASH(ST_GEOMFROMTEXT('POINT(10 10)'),10));

SELECT ST_LATFROMGEOHASH(ST_GEOHASH(ST_GEOMFROMTEXT('POINT(10 10)'),10));

SELECT ST_ASTEXT(ST_POINTFROMGEOHASH(ST_GEOHASH(ST_GEOMFROMTEXT('POINT(10 10)'),10),10));

--echo ######################################################################################################
--echo # BUG#19204199 : DISTANCE() AND ENVELOPE() FUNCTIONS RETURN WRONG RESULT
--echo ######################################################################################################

SELECT ST_DISTANCE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20))'),ST_GEOMFROMTEXT('LINESTRING(5 0,10 0)'));

SELECT ST_DISTANCE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20),GEOMETRYCOLLECTION())'),ST_GEOMFROMTEXT('LINESTRING(5 0,10 0)'));

SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,0 10,10 10))')));

SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,0 10,10 10),GEOMETRYCOLLECTION())')));

--echo ######################################################################################################
--echo # BUG#19223763 : ST_ASGEOJSON() GIVES SAME MAX DECIMAL DIGIT VALUE IN THE ERROR MESSAGE
--echo ######################################################################################################

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_ASGEOJSON(ST_GEOMFROMTEXT('POINT(10.12345678901234567890 10)'),-1);

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_ASGEOJSON(ST_GEOMFROMTEXT('POINT(10.12345678901234567890 10)'),-1000);

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_ASGEOJSON(ST_GEOMFROMTEXT('POINT(10.12345678901234567890 10)'),2147483648);

--error ER_INCORRECT_TYPE
SELECT ST_ASGEOJSON(ST_GEOMFROMTEXT('POINT(10.12345678901234567890 10)'),1000000000000000000000000);

--echo ######################################################################################################
--echo # BUG#19304320 : CENTROID() AND CONVEXHULL() FUNCTIONS RETURN NULL WITH VALID GEOMETRY INPUT
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))')));

SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),POLYGON((0 0,0 10,10 10,10 0,0 0)))')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))')));

SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),POLYGON((0 0,0 10,10 10,10 0,0 0)))')));

--echo ######################################################################################################
--echo # BUG#19331370 : ST_GEOMFROMGEOJSON() FUNCTION RETURNS BINARY DATA INSTEAD GEOMETRY DATA
--echo ######################################################################################################

SELECT ST_ASGEOJSON(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"Point\", \"coordinates\": [10, 15] }"));

SELECT ST_ASGEOJSON(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"LineString\", \"coordinates\": [ [102.0, 0.0], [103.0, 1.0], [104.0, 0.0], [105.0, 1.0] ]}"));

SELECT ST_ASGEOJSON(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"MultiPoint\", \"coordinates\": [ [-105.01, 39.57],[-80.66, 35.0] ] }"));

SELECT CHARSET(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"MultiPoint\", \"coordinates\": [ [-105.01, 39.57],[-80.66, 35.0] ] }"));

SELECT CHARSET(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"LineString\", \"coordinates\": [ [102.0, 0.0], [103.0, 1.0], [104.0, 0.0], [105.0, 1.0] ]}"));

--echo ######################################################################################################
--echo # BUG#19341961 : ASSERTION `COORDINATES->ISARRAY()' FAILED
--echo ######################################################################################################

--error ER_INVALID_GEOJSON_UNSPECIFIED
SELECT ST_ASTEXT(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"Polygon\", \"coordinates\": [[1, 1], [1, 10], [10, 10], [1, 1]] }"));

--echo ######################################################################################################
--echo # BUG#19342661 : ASSERTION `OBJECT->ISOBJECT()' FAILED
--echo ######################################################################################################

--error ER_INVALID_GEOJSON_WRONG_TYPE
SELECT ST_ASTEXT(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"GeometryCollection\", \"geometries\": [[]] }"));

--echo ######################################################################################################
--echo # BUG#19351967 : CENTROID() AND COVEXHULL() ACCEPTS GEOMETRYCOLLECTION CONTAINING INVALID POLYGON
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0)))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,5 5,10 10)))')));

--echo ######################################################################################################
--echo # BUG#19498377 : ST_GEOMFROMGEOJSON() FUNCTION ACCEPTS INVALID GEOJSON VALUE
--echo ######################################################################################################

--error ER_INVALID_GEOJSON_MISSING_MEMBER
SELECT ST_ASTEXT(ST_GEOMFROMGEOJSON(
     "{ \"type1234567890\": \"Point\", \"coordinates\": [102, 11]}"));

--error ER_INVALID_GEOJSON_MISSING_MEMBER
SELECT ST_ASTEXT(ST_GEOMFROMGEOJSON(
     "{ \"typeabcdefghijkl\": \"Point\", \"coordinates\": [102, 11]}"));

--echo ######################################################################################################
--echo # BUG#19499584 : RAPIDJSON DOES NOT PARSE ALL NUMBERS WITH TRAILING ZEROS PROPERLY
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"Point\", \"coordinates\": [102.0000, 11]}"));

SELECT ST_ASTEXT(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"Point\", \"coordinates\": [102.00000, 11]}"));

SELECT ST_ASTEXT(ST_GEOMFROMGEOJSON(
     "{ \"type\": \"Point\", \"coordinates\": [102.000000, 11]}"));

--echo ######################################################################################################
--echo # BUG#19549099 : VIRTUAL CONST CHAR* ITEM_FUNC_SPATIAL_MBR_REL::FUNC_NAME() CONST: ASSERTION `0'
--echo ######################################################################################################

--error ER_GIS_DIFFERENT_SRIDS
SELECT MBRCOVERS(ST_GEOMFROMTEXT('POINT(0 0)'), ST_GEOMFROMTEXT('POINT(1 1)',100));

--echo ######################################################################################################
--echo # BUG#19552241 : MBRTOUCHES() FUNCTION RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT MBRTOUCHES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(5 0,5 10),GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('LINESTRING(5 0,5 10)'));

SELECT MBRTOUCHES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(5 0,5 10),GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('MULTIPOINT(5 0,5 10)'));

--echo ######################################################################################################
--echo # BUG#19784515 : ASSERTION `DIM1 >= 0 && DIM1 <= 2 && DIM2 >= 0 && DIM2 <= 2' FAILED
--echo ######################################################################################################

--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT MBRWITHIN(
    ST_CENTROID(
        ST_UNION(
            ST_UNION(
                ST_GEOMFROMTEXT(
                    'MULTILINESTRING((-556 966,-721 -210),'
                                    '(-202 390,-954 804,682 504,-394 -254,832 371,907 -369,827 126,-567 -337,-304 -555,-957 -483,-660 792),'
                                    '(-965 -940,814 -804,-477 -909,-128 57,-819 880,761 497,-559 40,-431 427,179 -291,-707 315,137 -781,-416 -371,-5 -156),'
                                    '(-600 -570,-481 -191,991 -361,768 888,-647 566,795 -861,-82 -575,-593 539))'),
                ST_GEOMFROMTEXT(
                    'MULTIPOLYGON(((805 69,249 708,147 455,546 -672,-218 843,458 24,-630 -420,-83 -69)),'
                                 '((196 -219,-201 663,-867 521,-910 -315,-749 801,-402 820,-167 -817,-526 -163,744 -988,-588 -370,573 695,-597 513,-246 439)),'
                                 '((32 -903,189 -871,-778 -741,784 340,403 -555,607 -540,-513 -982,700 -124,344 732,714 151,-812 -252,-440 -895,-426 231,-819 -357)),'
                                 '((-395 830,454 -143,788 -279,618 -843,-490 -507,-224 17)))')),
            ST_INTERSECTION(
                ST_UNION(
                    ST_GEOMFROMTEXT(
                        'GEOMETRYCOLLECTION('
                            'POINT(-169 -570),'
                            'MULTIPOINT(384 290,-601 123,408 86,-616 -300,160 -474,-979 -4,-63 -824,-689 -765,-219 802,-54 -93,191 -982,-723 -449),'
                            'MULTILINESTRING((683 4,864 -634,548 -891,727 -691,-570 32,-334 -438,127 -317,241 -12,-807 947,-987 693,-345 -867,854 -106)),'
                            'MULTIPOINT(384 290,-601 123,408 86,-616 -300,160 -474,-979 -4,-63 -824,-689 -765,-219 802,-54 -93,191 -982,-723 -449),'
                            'MULTIPOLYGON(((266 51,851 523,-781 366,-607 -581)),'
                                         '((416 -450,-973 880,103 226,-896 -857,-369 761)),'
                                         '((168 171,26 -99,-606 -490,-174 -138,-325 -218,-833 -652,-255 -445,-882 -762,-202 -560)),'
                                         '((-423 -216,-531 -190,-147 821,362 441,645 -128,-997 708,134 -426,714 -9,147 842,-887 -870,688 -330,689 17,-314 -262,401 -112,-606 761)),'
                                         '((-582 -373,-360 -84,-727 -171,412 -660,750 -846,-464 718,163 -11,489 -659,586 -324,-741 -198,144 -165,644 -80,930 -487,-504 -205))),'
                            'MULTIPOLYGON(((266 51,851 523,-781 366,-607 -581)),'
                                         '((416 -450,-973 880,103 226,-896 -857,-369 761)),'
                                         '((168 171,26 -99,-606 -490,-174 -138,-325 -218,-833 -652,-255 -445,-882 -762,-202 -560)),'
                                         '((-423 -216,-531 -190,-147 821,362 441,645 -128,-997 708,134 -426,714 -9,147 842,-887 -870,688 -330,689 17,-314 -262,401 -112,-606 761)),'
                                         '((-582 -373,-360 -84,-727 -171,412 -660,750 -846,-464 718,163 -11,489 -659,586 -324,-741 -198,144 -165,644 -80,930 -487,-504 -205))),'
                            'GEOMETRYCOLLECTION(),'
                            'MULTIPOINT(384 290,-601 123,408 86,-616 -300,160 -474,-979 -4,-63 -824,-689 -765,-219 802,-54 -93,191 -982,-723 -449),'
                            'MULTILINESTRING((683 4,864 -634,548 -891,727 -691,-570 32,-334 -438,127 -317,241 -12,-807 947,-987 693,-345 -867,854 -106)))'),
                    ST_GEOMFROMTEXT(
                        'MULTIPOINT(157 69,-725 -189,-176 -41,676 375,33 -672,-76 47)')),
                ST_UNION(
                    ST_ENVELOPE(
                        ST_GEOMFROMTEXT(
                            'GEOMETRYCOLLECTION('
                                'LINESTRING(-896 100,-793 810,243 -525,650 -373,599 170,-554 -890),'
                                'POINT(945 -828),'
                                'POINT(945 -828),'
                                'LINESTRING(-896 100,-793 810,243 -525,650 -373,599 170,-554 -890),'
                                'POINT(945 -828),'
                                'MULTIPOINT(-47 307,-768 -425,-3 167,-170 30,-784 721,951 146,407 790,37 850,-466 738),'
                                'GEOMETRYCOLLECTION(),'
                                'MULTIPOINT(-47 307,-768 -425,-3 167,-170 30,-784 721,951 146,407 790,37 850,-466 738),'
                                'MULTIPOLYGON(((104 113,688 423,-859 602,272 978)),'
                                             '((981 -394,189 -400,649 -325,-977 371,30 859,590 318,329 -894,-51 262,197 952,-846 -139,-920 399)),'
                                             '((-236 -759,834 757,857 747,437 -146,194 913,316 862,976 -491,-745 933,610 687,-149 -164,-803 -565,451 -275)),'
                                             '((572 96,-160 -607,529 930,-544 -132,458 294))))')),
                    ST_CENTROID(GEOMFROMTEXT('POINT(-939 -921)')))))),
    ST_INTERSECTION(
        ST_GEOMFROMTEXT(
            'MULTILINESTRING((541 -927,-414 316,-429 -444,212 260,-125 104,445 563,-713 -975,-976 514),'
                            '(-830 882,-377 914,-915 919,-535 -23,-508 979),'
                            '(806 347,-87 220,226 -22,-12 468,707 598,83 951,-592 701,833 964,270 -932,743 -514,231 469,-575 -122,-99 -245,416 465,801 -587))'),
        ST_GEOMFROMTEXT(
            'LINESTRING(-96 -182,-373 75,697 687,-881 -463,-557 -959,-493 810)')));

--echo ######################################################################################################
--echo # BUG#20085563 : ASSERTION `!NULL_VALUE && OPDONE && STR_VALUE_ARG->LENGTH() > 0' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), 
                                 ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())))')));

--echo ######################################################################################################
--echo # BUG#20111542 : SET OPERATIONS RETURN GEOMETRYCOLLECTION CONTAINING SINGLE GEOMETRY COMPONENT
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('MULTIPOINT(0 0,100 100)'),
                          ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),GEOMETRYCOLLECTION())')));

SELECT ST_ASTEXT(ST_DIFFERENCE(ST_GEOMFROMTEXT('MULTIPOLYGON(((4 4,4 6,6 6,6 4)),((0 0,0 10,10 10,10 0)))'),
                               ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION()))')));

--echo ######################################################################################################
--echo # BUG#20202913 : ASSERTION `DEPTH == GC_DEPTH' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_CONVEXHULL(
                     ST_UNION(
                         ST_GEOMFROMTEXT(
                             'GEOMETRYCOLLECTION('
                                 'MULTIPOLYGON(((3 -7,9 8,7 7,-10 -8,0 7,10 1,1 -2,3 -8)),'
                                              '((-3 -4,-1 -4,-10 -3,-2 -8,0 3,9 -5,-7 6,-3 -9,-3 -7,6 -1,-3 4,0 -1,-5 0)),'
                                              '((-5 -7,8 -7,-6 -4,-10 10,3 -1))),'
                                  'MULTIPOINT(10 -3,-9 -6,-8 -4,3 -9,-6 10,-6 -10,-1 -5,9 -7,5 0,5 0),'
                                  'GEOMETRYCOLLECTION(),'
                                  'LINESTRING(-4 5,7 10,2 3,7 5,6 -8,1 9,4 -3,-3 0,-10 4,7 -3,-5 3,8 -9,-5 8,-2 2),'
                                  'POINT(4 9),MULTIPOINT(1 8,-8 5,-5 -3,1 -5,6 2,-1 -10))'),
                         ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()'))));

SELECT ST_ASTEXT(ST_UNION(
                     ST_GEOMFROMTEXT(
                         'GEOMETRYCOLLECTION()'),
                     ST_GEOMFROMTEXT(
                         'GEOMETRYCOLLECTION('
                             'LINESTRING(-10 -1,-2 -9,0 6,2 2,-1 -10,9 -4,6 3),'
                             'MULTIPOINT(10 8,-7 -1,-9 6),'
                             'GEOMETRYCOLLECTION('
                                 'MULTILINESTRING((3 0,8 -5,-6 5,-8 -2,5 1,-1 3),'
                                                 '(4 -1,7 -9,2 -10,10 0,-4 -6,-2 0,9 -5),'
                                                 '(-10 7,5 -5,2 8)),'
                                 'POINT(6 6),'
                                 'MULTIPOLYGON(((-7 -8,6 1,-10 -2,9 10,-6 4,-5 -7,8 2,-8 -9,-6 5,9 -2,9 -7,0 10,-8 -5,3 6,-2 7)),'
                                              '((-2 -5,3 -2,8 -9)),'
                                              '((10 -8,6 -4,0 -10,-10 -7,-5 0,-1 -1,5 -3,-5 9,5 -1,-3 -5)),'
                                              '((-1 10,2 7,-4 -1))),'
                                 'GEOMETRYCOLLECTION(),'
                                 'MULTILINESTRING((3 0,8 -5,-6 5,-8 -2,5 1,-1 3),'
                                                 '(4 -1,7 -9,2 -10,10 0,-4 -6,-2 0,9 -5),'
                                                 '(-10 7,5 -5,2 8)),'
                                 'MULTILINESTRING((3 0,8 -5,-6 5,-8 -2,5 1,-1 3),'
                                                 '(4 -1,7 -9,2 -10,10 0,-4 -6,-2 0,9 -5),'
                                                 '(-10 7,5 -5,2 8))),'
                             'GEOMETRYCOLLECTION('
                                 'MULTIPOINT(4 -10,-3 -8,9 10,-2 5,0 -7,-8 -4,-2 8,-8 1,5 -2,6 3,4 -9,5 -8,5 3,-7 -7),'
                                 'POINT(-7 1),'
                                 'LINESTRING(4 1,4 -2,2 0)),POINT(-5 -4))')));

--echo ######################################################################################################
--echo # BUG#20211491 : ASSERTION `RTREE_RESULT.SIZE() != 0' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_UNION(
                       ST_ENVELOPE(
                             ST_GEOMFROMTEXT(
                                   'LINESTRING(5 9,-1 10,-2 -6,2 9,2 0,3 6,-3 3,9 -2,-3 -10,-7 -4,1 4)')),
                       ST_UNION(
                             ST_GEOMFROMTEXT(
                                   'MULTILINESTRING((6 -8,10 -8,3 0,-6 1,0 8,-1 8,-3 -3,6 -6,0 6,1 -6,-1 7,8 3),'
                                                   '(-9 -10,-4 0,0 1,-9 1,6 9,-8 7,-2 -6,2 10,-1 -5,3 -5,-1 -10))'),
                             ST_GEOMFROMTEXT(
                                    'MULTILINESTRING((8 7,2 6,-6 -8,-2 10,4 1,9 7,5 9,4 1,8 2,-2 10,8 -5))'))));

SELECT ST_ASTEXT(ST_UNION(
                       ST_INTERSECTION(
                             ST_GEOMFROMTEXT(
                                   'MULTIPOINT(7 2,-4 -5,6 -9,-7 3,-10 5,8 -6,0 -10,10 -4,8 -10,2 6,8 -4,-8 2,-4 2)'),
                             ST_GEOMFROMTEXT(
                                   'MULTIPOLYGON(((6 2,1 1,-4 5,1 4,-3 -4,-7 9,-10 2,-6 1,10 -7,0 1,9 4)))')),
                       ST_UNION(
                             ST_GEOMFROMTEXT(
                                   'LINESTRING(-1 -5,0 -6,4 6,3 3,2 8,-2 6,-4 5,6 -7,-1 -1,-8 6,4 -2)'),
                             ST_GEOMFROMTEXT(
                                   'MULTIPOLYGON(((5 -4,-5 -9,-1 -6,-3 0,5 -2)),'
                                                '((-5 -10,-8 -2,-3 7,1 5,5 -10,1 -5,0 10,3 2,1 1)),'
                                                '((4 -2,6 3,7 5,1 2,8 -9,-10 -5,7 -10,-2 -9,-2 0,2 -8,-8 3,5 0)),'
                                                '((6 -4,0 4,-8 -2,10 -10,-6 5)))'))));

SELECT ST_CONTAINS(ST_UNION(
                         ST_INTERSECTION(
                               ST_GEOMFROMTEXT(
                                     'POINT(-3 3)'),
                               ST_GEOMFROMTEXT(
                                      'POLYGON((8 3,-2 9,-10 2,-10 -9,7 -1,4 1,7 6,5 -10,5 3,2 1,-10 0))')),
                         ST_CONVEXHULL(
                               ST_GEOMFROMTEXT(
                                      'MULTIPOINT(8 -8,-7 5)'))),
                   ST_UNION(
                         ST_GEOMFROMTEXT('POINT(4 1)'),
                         ST_GEOMFROMTEXT('MULTIPOINT(-10 -10,5 -2,-6 -7,1 5,-3 0)')));

--echo ######################################################################################################
--echo # BUG#20211639 : ASSERTION `LHS.DENOMINATOR() != 0' FAILED
--echo ######################################################################################################

SELECT ST_ISEMPTY(ST_INTERSECTION(
                      ST_UNION(
                          ST_GEOMFROMTEXT('MULTIPOINT(-9 4,10 -4,3 -10,-6 5,2 -4,-4 -8,1 10,4 10,6 6,9 2,9 4,-10 5,-6 7)'),
                          ST_GEOMFROMTEXT('MULTIPOLYGON(((3 5,-7 -2,-5 -1,1 -4,2 9,-9 -6,-6 10,-7 2,9 -2,-2 1,-1 4,-3 10)),'
                                                       '((-8 4,-8 -1,0 8)),'
                                                       '((0 7,-6 -1,6 -10,5 -2,7 2,9 4,-9 -4,2 10,-3 -7,2 -9,-7 -1,-8 9)),'
                                                       '((-5 -5,-1 -9,1 3,5 -5,9 8,2 9,9 -1,6 -2,-2 6,1 -5,9 -8,-4 2,-6 0)))')),
                      ST_INTERSECTION(
                          ST_INTERSECTION(
                              ST_GEOMFROMTEXT('MULTIPOINT(0 -8,-5 1,8 5,9 -4,0 5,8 4,-6 7,6 9,10 0)'),
                              ST_GEOMFROMTEXT('MULTIPOLYGON(((2 0,-3 5,1 -4,0 10,3 9,-2 -9,9 -9,3 6,-9 -5,8 7,-3 1)))')),
                      ST_UNION(
                          ST_GEOMFROMTEXT('MULTIPOLYGON(((-1 -9,7 -7,-6 6,9 6,5 -8,9 -9,5 -8,5 3,-8 9,10 8,10 -8)),'
                                                       '((8 -3,-5 0,2 -4,-8 -5,4 10,10 -8,5 3,-8 -9,-7 -2,8 9,-3 -3,-10 7,-10 -8,-7 -10,-5 -9)),'
                                                       '((4 9,8 -7,1 -10,9 6,-4 8,-7 1,3 -3,8 2,-10 3,-8 8,-3 1,2 0)))'),
                          ST_GEOMFROMTEXT('LINESTRING(0 -3,8 9,10 -3,-8 7,4 4,8 -8,10 6,5 7)')))));

--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT ST_ISEMPTY(ST_INTERSECTION(
                      ST_CONVEXHULL(
                          ST_GEOMFROMTEXT('POLYGON((0 10,-4 7,10 5,-8 -6,9 1,4 7,5 0,-3 -1,9 10,-7 -5))')),
                  ST_UNION(
                          ST_GEOMFROMTEXT('MULTILINESTRING((1 3,10 -8,-5 -8,-10 8,-9 -10,-5 8,8 6,6 -6,5 -3,-3 -8,-6 1,7 8,-2 -2),'
                                                          '(5 -6,-6 -5,7 -5,8 6,0 7,-1 7,0 2,10 -7),'
                                                          '(-5 1,-10 -6,5 -3,1 -3,-3 -1,7 -1,-8 8,-4 -9,2 -3,4 -8,-3 5,-9 7,-10 9,-9 -9,5 -4))'),
                          ST_GEOMFROMTEXT('MULTIPOLYGON(((-10 0,-9 -8,4 -6,-8 6,0 -1,1 0,5 2,8 -5)),'
                                                       '((-9 10,4 -8,-9 5,7 -9,-5 9,3 7,-5 -7,-4 -7,1 -7,10 2)),'
                                                       '((-2 6,-2 -6,-7 -5,1 4,7 -4,5 10,7 4,-6 -4,0 4,-3 0,0 2)))'))));

SELECT ST_ISEMPTY(ST_UNION(
                      ST_INTERSECTION(
                          ST_UNION(
                              ST_GEOMFROMTEXT('LINESTRING(7 -3,-1 6,1 3,4 2,-1 7,3 -4,1 10,-2 3,4 9,6 -2)'),
                              ST_GEOMFROMTEXT('MULTIPOLYGON(((-4 3,1 -6,5 -4,-3 1,-7 -6,4 4,4 -2,0 4,-7 -1,1 -2)))')),
                          ST_UNION(
                              ST_GEOMFROMTEXT('MULTIPOINT(8 9,9 -1,0 3,10 6,-3 0,9 7,-10 -10,-8 -8,1 -3,-2 3,0 3,7 9,-4 7,-6 -6,6 6)'),
                              ST_GEOMFROMTEXT('MULTILINESTRING((-8 6,-4 0,-3 -8,-9 -4,-4 -10,-2 6,-4 6,4 10,0 1,2 3,-8 6,7 5,-1 7),'
                                                              '(2 7,4 7,6 -1,7 4,-9 3,3 7,-9 -7))'))),
                      ST_UNION(
                          ST_GEOMFROMTEXT('LINESTRING(-6 -6,-7 1,5 5,-1 0,5 5,-8 -6,10 -9,7 9,-2 -7,10 -1,-3 10)'),
                          ST_GEOMFROMTEXT('MULTILINESTRING((10 10,2 -9,-8 2,9 -2,-10 -4,10 7,-10 8,-4 7,-9 3,8 8))'))));

--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT ST_SRID(
    ST_INTERSECTION(
        ST_UNION(
            ST_UNION(
                ST_GEOMFROMTEXT(
                    'MULTILINESTRING((3 7,-8 8,5 10,-7 0,-6 -2,7 4,-9 9,-10 -6,9 -8),'
                                    '(9 7,-6 1,-8 8,-8 -1,10 -7,-7 -6,-1 -8,0 8,-8 10,5 -2,-3 7,-5 -5))'),
                ST_GEOMFROMTEXT(
                    'MULTIPOLYGON(((-5 2,-1 -4,7 -1,-4 1,-7 4,-8 2,-4 -5,5 -3,-10 -6,-3 6,-2 8,5 -7,-10 -9,8 -1,2 -5)),'
                                 '((-3 -8,-3 -3,-8 -1,-5 -8,-5 -9,8 -3,-1 -2,8 -4)),'
                                 '((3 -4,7 -1,-6 -8,4 -5,4 8,9 -6)))')),
            ST_CONVEXHULL(
                ST_GEOMFROMTEXT(
                    'GEOMETRYCOLLECTION('
                        'POLYGON((0 -1,10 5,-1 2,6 -1)),'
                        'POINT(-2 10),'
                        'POINT(-6 -1),'
                        'GEOMETRYCOLLECTION('
                            'MULTIPOLYGON(((3 -3,5 2,5 -1,-8 4,3 1,-9 0,9 -3,6 4,-3 1,-10 2,-10 -2,-2 5,0 -2)),'
                                         '((-6 8,2 4,-10 4,9 -10,4 5,-5 7,0 -5,8 -2,-8 -3,-7 1)),'
                                         '((5 10,3 2,-2 7,-3 6,7 0,-1 9,-5 6,8 -2))),'
                            'MULTILINESTRING((4 5,9 -10,10 10,2 -3,2 4,7 -8,6 6,-8 1,-6 -7,-7 -6,8 -4,-5 -5,0 9,10 -8)),'
                            'LINESTRING(7 9,8 3,-4 -2,-7 6,-9 -7,8 9,3 9,-4 -10,-10 9)))'))),
        ST_UNION(
            ST_CONVEXHULL(
                ST_GEOMFROMTEXT(
                    'MULTIPOLYGON(((6 -4,4 9,10 -4,3 -3,7 6,0 -10,-7 1,-2 -2,9 9,9 -8,6 -3,-3 3,-1 10,-3 4)),'
                    '((-6 2,2 1,-2 1,3 -7,0 -1,7 1,-4 -1,8 2,-9 8,-10 -10,-4 -8,9 6,1 -10,9 -8)),'
                    '((-4 3,7 1,10 6,7 -5,-3 2,-2 6,-3 9,-7 -7,1 7,-3 10,9 5,-2 4,8 -3,-7 -9)))')),
            ST_ENVELOPE(
                ST_UNION(
                    ST_CONVEXHULL(
                        ST_ENVELOPE(
                            ST_UNION(
                                ST_ENVELOPE(
                                    ST_GEOMFROMTEXT(
                                        'MULTIPOINT(-9 -10,2 -1,1 -2,-8 -1,-1 -2,-9 4,-6 -10,-6 9,4 0,-7 -8,8 -9,-2 -10)')),
                                ST_INTERSECTION(
                                    ST_UNION(
                                        ST_GEOMFROMTEXT(
                                            'POINT(-10 3)'),
                                        ST_GEOMFROMTEXT(
                                            'POLYGON((-1 -2,7 -1,3 0,-7 9,0 10,4 -1,-5 1,4 9,-9 -2,-3 -5,4 -6,7 5,9 4,3 0))')),
                                    ST_ENVELOPE(
                                        ST_CONVEXHULL(
                                            ST_GEOMFROMTEXT(
                                                'MULTILINESTRING((-3 2,1 10,1 9,-10 -2,2 7,-6 -8,-5 -1,10 0,6 -3),'
                                                '(-2 8,-4 6,-2 9,-4 8,-6 -7,8 9,6 6,5 -3,5 0,-8 2,-7 8,-10 -9),'
                                                '(-7 -9,0 3,10 1,7 3,-6 -5,-5 -3,6 -5,5 -4,-2 3,7 9,0 -1,-3 -1,-4 0))'))))))),
                    ST_UNION(
                        ST_INTERSECTION(
                            ST_GEOMFROMTEXT(
                                'POLYGON((0 3,9 9,-2 1,-9 -8,7 8,3 -2,-2 4,2 1,3 -9,6 -6))'),
                            ST_GEOMFROMTEXT(
                                'GEOMETRYCOLLECTION('
                                    'MULTIPOLYGON(((-7 -8,-5 -10,-10 4,2 8,-7 -6,-4 -4,1 -10,-9 3,5 -9)),'
                                                 '((2 10,2 4,-7 -4,-5 1,-10 10,9 6,-4 -5)),'
                                                 '((2 6,-5 4,-5 -2,-2 -8,-1 -3,10 4,-2 5,3 -5,-9 -7)),'
                                                 '((-10 9,3 10,-5 -9)),'
                                                 '((7 -2,3 -10,-3 2,5 3))),'
                                    'POLYGON((9 3,5 2,-8 1,1 -10,-1 -6,-8 3,-4 5,-4 10,6 3,4 -4,9 -5,-5 -4,1 -6)),'
                                    'LINESTRING(-9 -8,2 10,-3 6,-10 5,6 -10,2 -10),'
                                    'MULTIPOLYGON(((-9 5,8 0,3 -6,3 0,8 -4,1 -2,-4 7,-2 -1,5 -1,-2 -8))),'
                                    'GEOMETRYCOLLECTION('
                                        'MULTIPOLYGON(((10 -8,-8 -5,8 -7,9 9)),'
                                                     '((-10 -6,-3 0,8 -9,5 -8,-9 -3,3 3,-4 -1)),'
                                                     '((4 7,8 0,7 0,-2 -3,8 -8,-3 -6,9 -10,-8 -8,-10 -10,-4 0,2 2,3 4,1 -4)))),'
                                    'POINT(-6 3),'
                                    'GEOMETRYCOLLECTION('
                                        'POINT(5 -8),'
                                        'GEOMETRYCOLLECTION(),'
                                        'MULTILINESTRING((4 10,1 5,-6 -6,3 -9,1 0,4 -9),'
                                                        '(10 1,-4 -1,-3 -7,-1 -10,-6 -8,5 -9,2 4,0 -3,2 -1,9 -6,-3 5),'
                                                        '(-8 0,5 -3,0 4,-2 -1,-4 2,-7 1,-5 -10,0 5,-3 -9,3 0)),'
                                        'POINT(5 -8)),'
                                    'MULTIPOINT(-2 -9,10 -2,-5 2,8 -10,3 -1,-8 9,-6 8,5 -7,-4 1,10 -4,6 -1,-9 4,-6 -5),'
                                    'GEOMETRYCOLLECTION())')),
                    ST_INTERSECTION(
                        ST_GEOMFROMTEXT(
                            'LINESTRING(4 -3,2 -10,5 -5,8 5,8 -3,-4 -9,2 -2,-3 4,-7 5,-9 -10)'),
                        ST_GEOMFROMTEXT('MULTIPOINT(-7 10,-9 8,3 3,5 5,10 -8,10 -9)'))))))));

--echo ######################################################################################################
--echo # BUG#20218936 : ASSERTION `(M_PREVIOUS_OPERATION != OVERLAY::OPERATION_CONTINUE)' FAILED
--echo ######################################################################################################
SELECT ST_CONTAINS(
    ST_GEOMFROMTEXT(
        'GEOMETRYCOLLECTION('
            'GEOMETRYCOLLECTION('
                'GEOMETRYCOLLECTION('
                    'MULTILINESTRING((8 1,5 6)),'
                    'GEOMETRYCOLLECTION('
                        'LINESTRING(6 0,5 5,0 7,2 9,2 1,8 7,5 0,4 0,4 0),'
                        'POLYGON((1 4,2 9,7 1,1 4)),'
                        'GEOMETRYCOLLECTION('
                            'GEOMETRYCOLLECTION('
                                'MULTILINESTRING((6 2,2 6),(7 1,4 6)),'
                                'MULTIPOLYGON(((0 0,5 8,6 1,6 3,8 1,5 4,9 6,2 5,7 4,1 7,0 0))),'
                                'LINESTRING(6 2,3 1,0 4,4 6,5 2,0 5,9 0,1 7,4 2)))),'
                    'POLYGON((2 5,6 6,5 1,2 2,4 0,3 3,1 4,9 1,4 5,0 7,2 5))),'
                'MULTIPOLYGON(((9 0,5 2,5 6,9 3,1 8,7 6,8 2,4 8,3 3,9 7,9 0))),'
                'POLYGON((8 7,5 3,9 4,0 9,8 1,5 3,7 5,1 0,1 4,3 2,8 7)),'
                'POLYGON((6 4,3 9,8 0,6 4)),'
                'MULTIPOINT(6 0,9 1,4 1,2 2,6 9,4 8,9 6,9 1,5 0),'
                'LINESTRING(2 9,3 7,2 2,0 1,0 7,9 8,6 8,9 5,7 6),'
                'MULTIPOINT(9 9,1 6,6 8,5 0,6 7,3 7,8 4,6 7,9 9),'
                'MULTIPOINT(5 0,2 7,1 1,5 0,4 5,9 9,8 9,8 9,1 4),'
                'POINT(2 1)))'),
    ST_GEOMFROMTEXT(
        'GEOMETRYCOLLECTION('
            'GEOMETRYCOLLECTION('
                'GEOMETRYCOLLECTION('
                    'GEOMETRYCOLLECTION('
                        'GEOMETRYCOLLECTION('
                            'LINESTRING(6 3,9 0),'
                            'MULTILINESTRING((5 8,2 1),(2 6,9 7)),'
                            'LINESTRING(1 2,1 7,1 3,0 5,9 0,6 3,4 2,0 5,7 2)))),'
                'GEOMETRYCOLLECTION('
                    'GEOMETRYCOLLECTION('
                        'POINT(3 0),'
                        'MULTIPOINT(3 6,9 3),'
                        'MULTIPOINT(7 0,3 7,6 6,9 8,1 6,9 6,2 5,0 0,3 4))),'
                'LINESTRING(7 0,3 6,5 0,3 3,1 6,5 6,8 0,9 3,2 9),'
                'POINT(8 2),'
                'LINESTRING(8 1,1 1),'
                'LINESTRING(5 7,3 9),'
                'POINT(1 6),'
                'MULTIPOINT(0 1,0 1),'
                'MULTILINESTRING((3 8,5 3,1 0,8 4,2 7,8 2,2 6,9 1,9 1))))'));

--echo ######################################################################################################
--echo # BUG#16174580 : ST_OVERLAPS AND ST_INTERSECTS GIVE ERRONEOUS RESULTS
--echo ######################################################################################################

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('POLYGON((0 0,0 -10,10 -10,10 0,0 0))'));

SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('POLYGON((0 0,0 -10,10 -10,10 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#18293562 : GIS SPATIAL RELATION CHECK FUNCTIONS GIVES INCORRECT RESULTS
--echo ######################################################################################################

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(0 0,3 3)'), ST_GEOMFROMTEXT('LINESTRING(1 1,10 10)'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(1 0,15 0,10 10)'), ST_GEOMFROMTEXT('MULTILINESTRING((15 0,20 0,20 20),(10 10,20 20,15 0))'));

SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('LINESTRING(15 10,10 0)'), ST_GEOMFROMTEXT('POINT(15 10)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('LINESTRING(15 5,15 25)'), ST_GEOMFROMTEXT('LINESTRING(15 5,15 25)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('POLYGON((0 0,5 0,5 5,0 5,0 0),(1 1,3 1,3 3,1 3,1 1))'), ST_GEOMFROMTEXT('LINESTRING(3 3,10 10)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('POLYGON((0 0,5 0,5 5,0 5,0 0))'), ST_GEOMFROMTEXT('LINESTRING(1 2,5 5)'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(1 0,15 0,10 10)'), ST_GEOMFROMTEXT('LINESTRING(15 0,20 0,10 10,20 20)'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(1 0,15 0,10 10)'), ST_GEOMFROMTEXT('MULTILINESTRING((15 0,20 0,20 20),(10 10,20 20,15 0))'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(1 0,15 0,10 10)'), ST_GEOMFROMTEXT('MULTILINESTRING((15 0,20 0,20 20,15 0))'));

--echo ######################################################################################################
--echo # BUG#20170591 : ST_CROSSES(MULTIPOINT, POLYGON) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(5 0,10 10)'), ST_GEOMFROMTEXT('POLYGON((0 0,5 0,5 5,0 5))'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(5 0,10 10,20 20)'), ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#20179082 : ST_TOUCHES() RETURNS INCORRECT RESULT WITH GEOMRTRYCOLLECTION GEOMETRY
--echo ######################################################################################################

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('POINT(0 0)'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('GEOMETRYCOLlECTION(POINT(0 0))'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('GEOMETRYCOLlECTION(POINT(0 0))'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'));

--echo ######################################################################################################
--echo # BUG#20187460 : OVERLAPPING GEOMETRY COMPONENTS OF SAME TYPE ARE NOT GETTING MERGED PROPERLY
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'),
                                 ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((4 4,4 6,6 6,6 4,4 4)),POLYGON((5 5,5 7,7 7,7 5,5 5)))')));

--echo ######################################################################################################
--echo # BUG#20188574 : ST_WITHIN(MULTIPOINT, POLYGON) RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_WITHIN(ST_GEOMFROMTEXT('MULTIPOINT(0 0,5 5,10 10)'), ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_WITHIN(ST_GEOMFROMTEXT('MULTIPOINT(0 0,5 0,3 3)'), ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#20234376 : ST_CONTAINS(POLYGON, MULTIPOINT) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('MULTIPOINT(3 3,13 13)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 0,0 5,10 5,5 0)),((5 0,0 -5,10 -5,5 0)))'), ST_GEOMFROMTEXT('MULTIPOINT(5 0)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('POLYGON((0 0,0 5,5 5,5 0,0 0))'), ST_GEOMFROMTEXT('MULTIPOINT(5 2,15 14)'));

--echo ######################################################################################################
--echo # BUG#20235165 : ST_EQUALS() FUNCTION RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_EQUALS(ST_GEOMFROMTEXT('MULTIPOINT(2 2,3 3)'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(2 2),POINT(3 3))'));

--echo ######################################################################################################
--echo # BUG#20240519 : ST_TOUCHES(POLYGON, MULTIPOINT) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('MULTIPOINT(0 0)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('MULTIPOINT(0 0,0 10)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('MULTIPOINT(0 0,0 10,10 10)'));

--echo ######################################################################################################
--echo # BUG#20240934 : ST_OVERLAPS() RETURNS INCORRECT RESULT WITH GEOMETRYCOLLECTION GEOMETRY
--echo ######################################################################################################

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('POLYGON((0 0,0 -10,10 10,0 0))'));

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'), ST_GEOMFROMTEXT('POLYGON((0 0,0 -10,10 10,0 0))'));

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 -10,10 10,0 0)))'));

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'),
                   ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 -10,10 10,0 0)))'));

--echo ######################################################################################################
--echo # BUG#20253600 : ST_CROSSES() RETURNS INCORRECT RESULT WITH GEOMETRYCOLLECTION GEOMETRY
--echo ######################################################################################################

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(2 2,14 14)'), ST_GEOMFROMTEXT('LINESTRING(0 0,4 4)'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTIPOINT(2 2,14 14)'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,4 4))'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(2 2,14 14))'), ST_GEOMFROMTEXT('LINESTRING(0 0,4 4)'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(2 2,14 14))'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,4 4))'));

--echo ######################################################################################################
--echo # BUG#20303050 : ST_TOUCHES() RETURNS WRONG RESULT WITH GEOMRTRYCOLLECTION GEOMETRY
--echo ######################################################################################################

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('LINESTRING(0 0,2 2)'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,2 2))'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('LINESTRING(0 0,2 2)'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,2 2))'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'));

--echo ######################################################################################################
--echo # BUG#20308837 : SPATIAL RELATION CHECK FUNCTIONS RETURN NULL VALUE
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_DISJOINT(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_EQUALS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_WITHIN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),GEOMETRYCOLLECTION())'), ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION()))'), ST_GEOMFROMTEXT('POINT(0 0)'));

--echo ######################################################################################################
--echo # BUG#20309003 : ST_CONTAINS(GEOMETRYCOLLECTION(POLY,POLY), MULTIPOINT) RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 0,0 10,10 10)),((5 0,0 -10,10 -10))))'), ST_GEOMFROMTEXT('MULTIPOINT(5 2,5 -2)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)),((0 0,0 -5,-5 -5,-5 0,0 0))))'), ST_GEOMFROMTEXT('MULTIPOINT(4 2,-4 -2)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 5,5 5,5 0,0 0)),POLYGON((0 0,0 -5,-5 -5,-5 0,0 0)))'),
                   ST_GEOMFROMTEXT('MULTIPOINT(4 2,-4 -2)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((5 0,0 10,10 10)),POLYGON((5 0,0 -10,10 -10)))'),
                   ST_GEOMFROMTEXT('MULTIPOINT(5 2,5 -2)'));

--echo ######################################################################################################
--echo # BUG#20315283 : ST_TOUCHES(LINESTRING, MULTIPOINT) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('LINESTRING(0 0,5 0,10 0)'), ST_GEOMFROMTEXT('MULTIPOINT(10 0)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('LINESTRING(0 0,5 0,10 0)'), ST_GEOMFROMTEXT('MULTIPOINT(0 0,10 0)'));

--echo ######################################################################################################
--echo # BUG#20316115 : ST_OVERLAPS(POLYGON, POLYGON) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(2 2,2 4,4 4,4 2,2 2))'),
                   ST_GEOMFROMTEXT('POLYGON((0 0,0 5,5 5,5 0,0 0))'));

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(2 2,2 4,4 4,4 2,2 2),(6 6,6 8,8 8,8 6,6 6))'),
                   ST_GEOMFROMTEXT('POLYGON((0 0,0 5,5 5,5 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#20328959 : ST_EQUALS(POLYGON, GEOMETRYCOLLECTION(POLYGON, POLYGON)) RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_EQUALS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'),
                 ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((4 4,4 6,6 6)))'));

SELECT ST_EQUALS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'),
                 ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((4 4,6 4,6 6)))'));

--echo ######################################################################################################
--echo # BUG#20329124 : ST_WITHIN(MULTIPOINT, GEOMETRYCOLLECTION(POLYGON,POLYGON)) RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_WITHIN(ST_GEOMFROMTEXT('MULTIPOINT(4 4,5 5)'),
                 ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_WITHIN(ST_GEOMFROMTEXT('MULTIPOINT(4 4,3 3)'),
                 ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((4 4,4 6,6 6,6 4,4 4)))'));

--echo ######################################################################################################
--echo # BUG#20303208 : ST_WITHIN(POLYGON, POLYGON) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_WITHIN(ST_GEOMFROMTEXT('POLYGON((0 0,0 5,5 5,5 0,0 0))'),
                 ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(2 2,2 4,4 4,4 2,2 2),(6 6,6 8,8 8,8 6,6 6))'));

SELECT ST_WITHIN(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'),
                 ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(2 2,2 4,4 4,4 2,2 2))'));

--echo ######################################################################################################
--echo # BUG#20234206 : ST_CONTAINS(MULTIPOLYGON, LINESTRING) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 0,0 5,10 5,5 0)),((5 0,0 -5,10 -5,5 0)))'), ST_GEOMFROMTEXT('LINESTRING(5 -2,5 2)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 0,0 5,10 5,5 0)),((5 0,0 -5,10 -5,5 0)))'), ST_GEOMFROMTEXT('LINESTRING(5 -2,5 0)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 0,0 5,10 5,5 0)),((5 0,0 -5,10 -5,5 0)))'), ST_GEOMFROMTEXT('LINESTRING(5 -2,5 5)'));

--echo ######################################################################################################
--echo # BUG#20356527 : ST_CONTAINS(MULTIPOLYGON, POLYGON) GIVES INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                   ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                   ST_GEOMFROMTEXT('POLYGON((0 0,0 5,5 5,5 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#20356548 : ST_OVERLAPS(MULTIPOLYGON, POLYGON) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                   ST_GEOMFROMTEXT('POLYGON((0 0,0 5,5 5,5 0,0 0))'));

SELECT ST_OVERLAPS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                   ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#20384407 : ST_INTERSECTS(POLYGON, MULTILINESTRING) RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(2 2,2 4,4 4,4 2,2 2))'), ST_GEOMFROMTEXT('MULTILINESTRING((11 11,20 20),(5 7, 4 1))'));

SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((5 0,0 5,-5 0,0 -5,5 0))'), ST_GEOMFROMTEXT('MULTILINESTRING((10 0, 18 12),(2 2, 2 1))'));

--echo ######################################################################################################
--echo # BUG#20390414 : ST_CROSSES(MULTILINESTRING, POLYGON) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTILINESTRING((6 6,15 15),(0 0,7 7))'), ST_GEOMFROMTEXT('POLYGON((5 5,5 15,15 15,15 5,5 5))'));

SELECT ST_CROSSES(ST_GEOMFROMTEXT('MULTILINESTRING((15 15,6 6),(0 0,7 7))'), ST_GEOMFROMTEXT('POLYGON((5 5,5 15,15 15,15 5,5 5))'));

--echo ######################################################################################################
--echo # BUG#20393099 : ST_CONTAINS(POLYGON, LINESTRING) RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,5 5,0 0))'), ST_GEOMFROMTEXT('LINESTRING(3 7, 9 1)'));

--echo ######################################################################################################
--echo # BUG#20393159 : ST_CONTAINS(MULTIPOLYGON, MULTIPOINT) GIVES WRONG RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,5 5,0 0)))'), ST_GEOMFROMTEXT('MULTIPOINT(2 9, 1 0)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,5 5,0 0)))'), ST_GEOMFROMTEXT('MULTIPOINT(7 4, 8 0)'));

--echo ######################################################################################################
--echo # BUG#20398307 : ST_DISJOINT(LINESTRING, LINESTRING) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_DISJOINT(ST_GEOMFROMTEXT('LINESTRING(5 5,10 10)'), ST_GEOMFROMTEXT('LINESTRING(6 6,3 3)'));

SELECT ST_DISJOINT(ST_GEOMFROMTEXT('LINESTRING(5 5,2 8)'), ST_GEOMFROMTEXT('LINESTRING(4 6,7 3)'));

--echo ######################################################################################################
--echo # BUG#20400252 : ST_TOUCHES(MULTIPOLYGON, LINESTRING) GIVES INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                  ST_GEOMFROMTEXT('LINESTRING(5 5,0 0,10 0)'));

SELECT ST_TOUCHES(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                  ST_GEOMFROMTEXT('LINESTRING(5 5,0 0,0 10)'));

--echo ######################################################################################################
--echo # BUG#20400420 : ST_CONTAINS(MULTIPOLYGON, LINESTRING) GIVES INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                   ST_GEOMFROMTEXT('LINESTRING(5 5,0 0,10 0)'));

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((0 0,0 -10,-10 -10,-10 0,0 0)))'),
                   ST_GEOMFROMTEXT('LINESTRING(5 5,0 0,0 10)'));

--echo ######################################################################################################
--echo # BUG#20409558 : ST_WITHIN(MULTILINESTRING, POLYGON) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_WITHIN(ST_GEOMFROMTEXT('MULTILINESTRING((4 10, 3 10, 10 6),(5 0, 7 5, 9 10))'), ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,5 5,0 0))'));

--echo ######################################################################################################
--echo # BUG#20410030 : ST_CROSSES(LINESTRING, POLYGON) RETURNS WRONG RESULT
--echo ######################################################################################################

SELECT ST_CROSSES(ST_GEOMFROMTEXT('LINESTRING(3 10, 1 5, 1 10, 3 4, 7 8, 6 10, 10 2)'), ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#20414100 : ST_WITHIN(LINESTRING, POLYGON) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_WITHIN(ST_GEOMFROMTEXT('LINESTRING(2 9, 1 1, 10 1, 10 10, 1 10, 0 6, 5 6)'), ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'));
SELECT ST_WITHIN(ST_GEOMFROMTEXT('LINESTRING(2 3, 4 5, 0 6, 5 6)'), ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'));

--echo ######################################################################################################
--echo # BUG#20414126 : ST_WITHIN(MULTILINESTRING, LINESTRING) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTILINESTRING((2 5, 7 5, 8 3, 6 3, 4 0),(0 0,10 10))'), ST_GEOMFROMTEXT('LINESTRING(1 1, 5 5, 4 4)'));
SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTILINESTRING((2 5, 7 5, 8 3, 6 3, 4 0),(4 0, 4 8, 0 4))'), ST_GEOMFROMTEXT('LINESTRING(4 1, 4 5, 4 4)'));
SELECT ST_CONTAINS(ST_GEOMFROMTEXT('MULTILINESTRING((5 0,5 5,5 10),(0 0,10 10))'), ST_GEOMFROMTEXT('LINESTRING(1 1,5 5,4 4)'));

--echo ######################################################################################################
--echo # BUG#20357097 : ASSERTION `INDEX >= 0 && UNSIGNED(INDEX) < INFO.COUNT' FAILED
--echo ######################################################################################################

--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT ST_ASTEXT(
    ST_ENVELOPE(
        ST_UNION(
            ST_UNION(
                ST_ENVELOPE(
                    ST_CONVEXHULL(
                        ST_ENVELOPE(
                            ST_GEOMFROMTEXT('MULTILINESTRING((-3 -4,0 9,3 -2,4 9,-6 -8,-6 4,-10 7,-9 6,-10 6,-8 2,8 2,7 -5),'
                                                            '(-6 6,8 0,9 -7,-7 -7,1 -2),'
                                                            '(-2 -8,7 3,-1 8,1 5,-1 -5,-10 -6,2 2,-2 -9,0 5,2 7,6 8,6 -3,9 7,7 -8))')))),
                ST_UNION(
                    ST_ENVELOPE(
                        ST_UNION(
                            ST_ENVELOPE(
                                ST_GEOMFROMTEXT('MULTIPOINT(4 0,-2 3,-1 -4,3 0,0 1,5 3,-4 -3,-7 -3,3 3)')),
                            ST_ENVELOPE(
                                ST_ENVELOPE(
                                    ST_GEOMFROMTEXT('MULTILINESTRING((-3 3,8 10,7 5,-7 0,-10 -4,1 2,-3 -2,-5 8,-3 6,3 8,8 10,3 -4,9 -6,4 -2,6 0),'
                                                                    '(10 -4,3 5,4 -3,6 -10,5 3,-10 8))'))))),
                    ST_CONVEXHULL(
                        ST_ENVELOPE(
                            ST_UNION(
                                ST_INTERSECTION(
                                    ST_ENVELOPE(
                                        ST_UNION(
                                            ST_CONVEXHULL(
                                                ST_ENVELOPE(
                                                    ST_CONVEXHULL(
                                                        ST_INTERSECTION(
                                                            ST_GEOMFROMTEXT('MULTILINESTRING((8 7,6 1,-3 -7,7 3,-4 2,-6 -8,-4 -8,6 -7,10 -7,-5 10,-3 4),'
                                                                                            '(-1 3,-7 7,-10 -2,-4 -5,-3 -7,-2 -8,-6 -7),'
                                                                                            '(-6 -6,-3 -1,1 10,2 3,7 4,-7 7,-2 5,-10 -3,-6 0,-6 6,-8 -5,-5 7,0 -3,-6 5))'),
                                                            ST_GEOMFROMTEXT('POINT(2 4)'))))),
                                            ST_CONVEXHULL(
                                                ST_UNION(
                                                    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                                                        'POLYGON((7 4,1 0,-4 -9,-9 8)))'),
                                                    ST_GEOMFROMTEXT('MULTILINESTRING((-2 -3,-4 -9,-7 -8,-4 6,4 2,4 -6,7 -6,9 9,-5 10,-6 -9,0 -5,2 2,-3 5,4 -4),'
                                                                                    '(1 3,5 -10,6 -6,-2 -4,-5 6,7 -9,-8 -7,5 3,7 -6,-9 -4,10 7,5 9,-7 -2,4 -2),'
                                                                                    '(8 5,4 5,0 -7))'))))),
                                    ST_CONVEXHULL(
                                        ST_GEOMFROMTEXT('LINESTRING(9 4,-9 -9,9 9)'))),
                                ST_CONVEXHULL(
                                    ST_INTERSECTION(
                                        ST_ENVELOPE(
                                            ST_ENVELOPE(
                                                ST_CONVEXHULL(
                                                    ST_ENVELOPE(
                                                        ST_CONVEXHULL(
                                                            ST_GEOMFROMTEXT('MULTIPOINT(-7 -5,-10 -8,3 7,3 8,3 -1,7 -4,-9 -9,-7 2,-6 0)')))))),
                                        ST_INTERSECTION(
                                            ST_UNION(
                                                ST_GEOMFROMTEXT('LINESTRING(-10 -4,9 -4,-5 5,8 8)'),
                                                ST_GEOMFROMTEXT('MULTIPOLYGON(((-10 -1,6 9,8 9)),'
                                                                             '((3 2,5 1,9 10,-7 -9,-9 4)),'
                                                                             '((2 8,10 -9,3 -10,-9 -7,7 -9,9 9,-9 0,-9 -5,2 7,-7 -2,-2 -9,-1 -9,2 -2,2 4,1 -6)))')),
                                            ST_UNION(
                                                ST_GEOMFROMTEXT('LINESTRING(-8 -10,-4 3,10 -7,9 -2,-8 -8,1 -10,1 -1)'),
                                                ST_GEOMFROMTEXT('MULTIPOLYGON(((-3 3,-9 -6,2 4,1 -9,-3 -7,-8 7,9 -9,3 10,-8 2,-5 -3,-3 -1,1 7,-8 4)),'
                                                                             '((-1 8,4 -4,8 1,2 9,-5 -10,5 -5,-7 9,7 3)),'
                                                                             '((2 -4,6 -1,5 -4,3 2,3 10,8 0,-6 4,2 7,8 -6,-2 6,-9 3)),'
                                                                             '((-8 4,-6 2,-1 1,-1 4,7 8,-1 -10,-3 4,-3 4,7 -4,-7 6,4 1,-10 -7,-10 -7,-2 -1)))')))))))))),
            ST_UNION(
                ST_GEOMFROMTEXT('POLYGON((-7 -6,3 -7,-2 -4,8 -10,3 -3,-7 4,-8 2,-10 7,-7 -7,10 -10,-9 2))'),
                ST_GEOMFROMTEXT('LINESTRING(8 0,9 -7,4 -9,10 -1,6 0)')))));

--echo ######################################################################################################
--echo # More GIS crashes/assertion failure test cases
--echo ######################################################################################################

SELECT MBRCONTAINS(ST_UNION(
                       ST_GEOMFROMTEXT(
                           'GEOMETRYCOLLECTION('
                               'POLYGON((1 7,4 5,7 -.1,7 2,5 4,2 2,4 +.7,-1.9 2,4 1,1 7)),'
                               'MULTIPOINT(+.6 +.0,6 -1,6 -1032.34324,0 -2.9,6 0),'
                               'MULTILINESTRING((7 3,-5.8 3,4 7,4 2.232432)))',10),
                       ST_GEOMFROMTEXT(
                           'MULTIPOINT(7.0 5,2 -9.2,9 8,6 -0,3 5,1 7,3 7)',10)),
                   ST_UNION(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(0 2.232432)')),10),
                            ST_GEOMFROMTEXT('POINT(4 +.5)',10)));


--error ER_GIS_INVALID_DATA
SELECT ST_INTERSECTS(ST_SYMDIFFERENCE(
                         ST_GEOMFROMTEXT(
                             'MULTIPOINT(1 0,8.5 0,5 1,8.3 4,7 -5.0)'),
                         ST_GEOMFROMTEXT(
                             'MULTIPOLYGON(((3 8,6 1,9.5 4,5 2,9 2,-1032.34324 -1032.34324,4 -4.6,4 2,3 8),'
                                           '(5 9,2 4,6 -.8,4 +.0,-0 1,8 9.6,5 9),'
                                           '(8 5,3 4,3 1,0 1,6 -.5,8 -7.0,8 5),'
                                           '(8 6,0 1,9 5,7 5,5 3,2.232432 0,8 6)),'
                                          '((5 1,7 7,-1032.34324 7,8 -1,5 0,5 1),'
                                           '(2 9,2.232432 +.6,2 8,4 -4.4,-1032.34324 9,9 +.6,8 1,-.0 1,1 2,7 2,6 -5,2 1,-2 9,2 9),'
                                           '(7 8,0 4,7 8)),'
                                          '((5 0,7 1,5 0)),'
                                          '((3 9,8 5,0 -1032.34324,7 +.9,3 9),'
                                           '(9 9,7 2,0.4 7,9 9),'
                                           '(1 4,4 0,0 2,6.9 6,2.232432 -.8,7 3,1 4)))')),
                     ST_UNION(ST_GEOMFROMTEXT('MULTILINESTRING((-.5 9,1 1,1 6,6 6),(6 -.5,6 -.2,6 9,2 4),(4 7),(8 7,5 5,9 3,8 -.3))'),
                              ST_GEOMFROMTEXT('POINT()')));


SELECT ST_TOUCHES(ST_INTERSECTION(
                      ST_GEOMFROMTEXT(
                          'POLYGON((6 9,0 0,10.0002 -6,6 9),'
                                  '(5 7,2 7,9 6,9 9,2 0,3 7,+.7 1,2.232432 9,8 +.3,5 7),'
                                  '(0 6,5 9,-.0 0,7 4,2 -3,2 7,9 2,0 6))'),
                      ST_GEOMFROMTEXT('POINT(7 8)',0)),
                  ST_DIFFERENCE(
                      ST_GEOMFROMWKB(
                          MULTIPOINT(POINT(-3.4,2),POINT(9,5),POINT(8,9),POINT(-.0,-.7),POINT(8,1.8),POINT(-5.0,9),POINT(4,3),
                                     POINT(8,-9.9),POINT(1,9),POINT(+.7,3),POINT(1,1),POINT(1,0),POINT(+.3,.7),POINT(4,7),POINT(2,-.0))),
                      ST_GEOMFROMWKB(POINT(0,2))));


SELECT MBRCONTAINS(ST_UNION(
                       ST_GEOMFROMTEXT(
                           'GEOMETRYCOLLECTION('
                               'POLYGON((1 7,4 5,7 -.1,7 2,5 4,2 2,4 +.7,-1.9 2,4 1,1 7)),'
                               'MULTIPOINT(+.6 +.0,6 -1,6 -1032.34324,0 -2.9,6 0),'
                               'MULTILINESTRING((7 3,-5.8 3,4 7,4 2.232432)))',10),
                       ST_GEOMFROMTEXT('MULTIPOINT(7.0 5,2 -9.2,9 8,6 -0,3 5,1 7,3 7)',10)),
                   ST_UNION(
                       ST_GEOMFROMWKB(
                           ST_ASWKB(ST_GEOMFROMTEXT('POINT(0 2.232432)')),10),ST_GEOMFROMTEXT('POINT(4 +.5)',10)));


--error ER_GIS_INVALID_DATA
SELECT ST_CONTAINS(ST_UNION(
                       ST_GEOMFROMWKB(
                           GEOMETRYCOLLECTION(
                               POINT(1,6),
                               MULTIPOLYGON(
                                   POLYGON(LINESTRING(POINT(6,3),POINT(3,0),POINT(2.7,2),POINT(2,8),POINT(1,5.8),POINT(6,3))),
                                   POLYGON(LINESTRING(POINT(2,4),POINT(0,9),POINT(2,4)),
                                           LINESTRING(POINT(5,4),POINT(5,1),POINT(5,4)))),
                               MULTIPOLYGON(
                                   POLYGON(LINESTRING(POINT(1,9),POINT(-.9,.3),POINT(1,9)),
                                           LINESTRING(POINT(1,9),POINT(1,1.6),POINT(8,5),POINT(7,2),POINT(6,9.9),POINT(1,2),
                                                      POINT(0,0),POINT(7,3),POINT(2,6),POINT(8,3),POINT(4,-.8),POINT(1,9)),
                                           LINESTRING(POINT(1,8),POINT(3,3),POINT(+.5,9),POINT(-9.3,0),POINT(8,5),POINT(+.4,+.2),
                                                      POINT(7,+.6),POINT(7,7),POINT(2,4),POINT(2,2),POINT(6,0),POINT(1,8)),
                                           LINESTRING(POINT(6,0),POINT(8,2),POINT(0,1),POINT(-.9,.9),POINT(6,0)),
                                           LINESTRING(POINT(0,8),POINT(1,9),POINT(2,3),POINT(3,2),POINT(4,-3.2),POINT(7,6),POINT(4,9),
                                                      POINT(3,5),POINT(7,-.0),POINT(1,2),POINT(4,-.8),POINT(-2.3,7),POINT(9,4),POINT(0,8)),
                                           LINESTRING(POINT(3,6),POINT(5,7),POINT(2,2),POINT(3,2),POINT(7,1),POINT(2,2),
                                                      POINT(3,9),POINT(5,7),POINT(8,2),POINT(5,6),POINT(3,6))),
                                   POLYGON(LINESTRING(POINT(0,3),POINT(3,-.4),POINT(-.2,3),POINT(5,4.6),POINT(-2.7,8),POINT(0,3)))))),
                       ST_GEOMFROMTEXT('POINT(-1032.34324 -.9)')),
                   ST_UNION(
                       ST_GEOMFROMWKB(
                           ST_ASWKB(
                               ST_GEOMFROMTEXT(
                                   'GEOMETRYCOLLECTION('
                                       'MULTILINESTRING((5 5,6 3,+.8 -8,8 3),(2 2,1 3,8 4)),'
                                       'MULTIPOINT(2 3,9 3,9 7,+.2 0,1 2),'
                                       'MULTIPOLYGON(((2 1,2.232432 7.2,-0.7654 2,3 9,9 9,1 0,-0.7654 5,2 1),'
                                                     '(8 2,2 1,8 2),'
                                                     '(3 2,8.5 3,+.7 2,7 5,2 1,1 6,1 7,-9.4 6,3 2),'
                                                     '(5 9,7 +.5,5 9),'
                                                     '(6 8,-0.7654 1,6 8),'
                                                     '(0 9,9 0,5 4,6 -0.7654,-5 1,0 9))))'))),
                       ST_GEOMFROMTEXT('MULTIPOLYGON(((5 2,1 -0.7654,-6.3 9,6 3,2 6,7 6,4 -0.7654,2 +.2,-0.7654 9,5 2)))')));


--error ER_GIS_INVALID_DATA
SELECT MBROVERLAPS(ST_INTERSECTION(
                       ST_GEOMFROMWKB(
                           GEOMETRYCOLLECTION(
                               MULTILINESTRING(
                                   LINESTRING(POINT(3,3)),
                                   LINESTRING(POINT(3,5)),
                                   LINESTRING(POINT(8,0),POINT(6,0),POINT(9,7),POINT(5,6),POINT(7,5),POINT(-5.6,4)),
                                   LINESTRING(POINT(7,1),POINT(5,9),POINT(5,0),POINT(2,1),POINT(1,5),POINT(5,+.8),POINT(-.8,9),POINT(0,3),POINT(2.0,3)),
                                   LINESTRING(POINT(2,8),POINT(0,2),POINT(.5,-.2),POINT(2,1)),
                                   LINESTRING(POINT(9,8.8),POINT(-.3,.1),POINT(2,2),POINT(2,8))),
                               POLYGON(
                                   LINESTRING(POINT(6,8),POINT(4,1),POINT(6,8),POINT(-.2,2),POINT(6,6.3),POINT(3,7),POINT(4,7.1),POINT(6,8))),
                               MULTILINESTRING(
                                   LINESTRING(POINT(9,9))))),
                       ST_GEOMFROMWKB(
                           ST_ASWKB(
                               ST_GEOMFROMTEXT(
                                   'MULTIPOLYGON(((6 4,3 3,-8.4 6,-.0 4,6 4)))')))),
                   ST_DIFFERENCE(
                       ST_GEOMFROMTEXT('LINESTRING(3.2 2)'),
                       ST_GEOMFROMTEXT('LINESTRING(7 3,-2 10.0002,1 6,3 7)',10)));


--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT ST_ASTEXT(ST_INTERSECTION(
                     ST_GEOMFROMTEXT('POLYGON((6 8, 4 1, 6 8, -0.2 2,6 6.3, 3 7, 4 7.1, 6 8))'),
                     ST_GEOMFROMTEXT('MULTIPOLYGON(((6 4,3 3,-8.4 6,-.0 4,6 4)))')));


SELECT MBRWITHIN(ST_SYMDIFFERENCE(
                     ST_GEOMFROMWKB(POINT(3,8),10),
                     ST_GEOMFROMWKB(
                         ST_ASWKB(
                             ST_GEOMFROMTEXT(
                                 'MULTILINESTRING((10.0002 6,6 9,1 2,2 -6),(-2 -1032.34324,6 189.7654,6 -.6,-.0 -.6,5 0),(0.6 1,5 0,1 -6,6 1))')),10)),
                 ST_INTERSECTION(
                     ST_GEOMFROMTEXT('MULTIPOINT(+.8 4,5 -2,6 10.0002,4 9,1 3)'),
                     ST_GEOMFROMWKB(MULTIPOINT(POINT(8,5),POINT(9,4),POINT(-0.5,-.9)))));


--error ER_GIS_INVALID_DATA
SELECT ST_DISJOINT(ST_GEOMFROMTEXT(
                       'MULTIPOINT(189.7654 2)'),
                   ST_GEOMFROMWKB(
                       GEOMETRYCOLLECTION(
                           MULTIPOINT(POINT(7,5),POINT(5,-.5),POINT(0,2),POINT(6.9,0)),
                           POLYGON(
                               LINESTRING(POINT(4,0),POINT(5,8),POINT(6.3,7),POINT(5,-.4),POINT(4,0))),
                           POLYGON(
                               LINESTRING(POINT(7,6),POINT(2,8),POINT(7,3),POINT(1,3),POINT(0,4),POINT(7,+.0),POINT(4,5),POINT(3,6),POINT(7,6)),
                               LINESTRING(POINT(2,5),POINT(4,7),POINT(6,5),POINT(4,-1.0),POINT(9,0),POINT(-1.9,-.6),POINT(9,0),POINT(2,5))),
                           MULTIPOINT(POINT(9,5),POINT(2,-0.7),POINT(6,1),POINT(1,1)),
                           LINESTRING(POINT(-.3,4),POINT(4,9),POINT(0,+.9),POINT(6.8,3),POINT(4,3),POINT(1,0.3)),
                           MULTIPOLYGON(
                               POLYGON(
                                   LINESTRING(POINT(7,2),POINT(0,5),POINT(7,2))),
                               POLYGON(
                                   LINESTRING(POINT(9,5),POINT(2,0),POINT(9,5)),
                                   LINESTRING(POINT(8,9),POINT(0,-6.9),POINT(5,3),POINT(0,1),POINT(7,0.9),POINT(3,0),POINT(+.4,0),POINT(3,6),POINT(8,9))),
                               POLYGON(
                                   LINESTRING(POINT(0,2),POINT(7,3),POINT(5,0),POINT(0,1),POINT(1,0),POINT(7,3),POINT(6,3),POINT(2,5),POINT(0,2))),
                               POLYGON(
                                   LINESTRING(POINT(8,9),POINT(8,1),POINT(-.9,-.8),POINT(4,6),POINT(8,9)),
                                   LINESTRING(POINT(2,8),POINT(6,7),POINT(8,+.2),POINT(5,-6.1),POINT(4,5),POINT(4,-.2),
                                              POINT(1,5),POINT(-3.6,5),POINT(6,3),POINT(2,8),POINT(7,1.2),POINT(2,8)))))));


--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT ST_ASTEXT(ST_INTERSECTION(
                     ST_GEOMFROMWKB(
                         GEOMETRYCOLLECTION(
                             POINT(7,7),
                             POLYGON(
                                 LINESTRING(POINT(4,9),POINT(5,6),POINT(9,-.9),POINT(8,8),POINT(1,1),POINT(5,5),
                                            POINT(8,-0.8),POINT(7,4),POINT(0,+.8),POINT(0,8),POINT(5,8),POINT(4,9))),
                             POLYGON(
                                 LINESTRING(POINT(2,2),POINT(3,9.5),POINT(2.2,1),POINT(-6.1,0),POINT(1,9),POINT(2,2)),
                                 LINESTRING(POINT(0,8),POINT(0,0),POINT(3,-8.6),POINT(0,7),POINT(2,-.9),POINT(0,9),POINT(8,0),POINT(7,0),POINT(0,8))),
                             POLYGON(
                                 LINESTRING(POINT(3,2),POINT(8,8),POINT(0,9),POINT(4,7.9),POINT(3,4),POINT(2,0),POINT(0,0),POINT(4,6.0),POINT(3,2))),
                             LINESTRING(POINT(5,2),POINT(9,2),POINT(7,5),POINT(5,1)),
                             MULTIPOINT(POINT(1,8),POINT(.6,8),POINT(.8,3)))),
                     ST_GEOMFROMTEXT(
                         'POLYGON((3 6,2 3,2 8,3 -1.6,4 -0.7654,3 6))')));


--error ER_GIS_INVALID_DATA
SELECT MBREQUALS(ST_SYMDIFFERENCE(
                     ST_GEOMFROMTEXT(
                         'POINT(5 0)'),
                     ST_GEOMFROMTEXT(
                          'MULTIPOLYGON(((8 1,5 8,5 -5.7,9 8,5 9,8 1),'
                                        '(7 5,5 7.6,0 2,3 7,0 5,2 9,7 5)),'
                                       '((2 4,6 0,+.8 7,3 2,-4 8,2 -0,+.2 1,2 4)))')),
                 ST_UNION(ST_GEOMFROMWKB(
                              ST_ASWKB(
                                  ST_GEOMFROMTEXT(
                                      'POLYGON((7 3,2 7,7 3),'
                                              '(2 4,6 2,1 7,-2.7 5,0 4,-3.4 3,3 8,2 4),'
                                              '(8 0,189.7654 10.0002,9 1.1,1 0,6 -2.6,4 10.0002,1 8,8 0))'))),
                          ST_GEOMFROMTEXT('LINESTRING(6 1)')));


--error ER_GIS_INVALID_DATA
SELECT ST_INTERSECTS(ST_SYMDIFFERENCE(
                         ST_GEOMFROMTEXT(
                             'MULTIPOINT(1 0,8.5 0,5 1,8.3 4,7 -5.0)'),
                         ST_GEOMFROMTEXT('MULTIPOLYGON(((3 8,6 1,9.5 4,5 2,9 2,-1032.34324 -1032.34324,4 -4.6,4 2,3 8),'
                                                       '(5 9,2 4,6 -.8,4 +.0,-0 1,8 9.6,5 9),'
                                                       '(8 5,3 4,3 1,0 1,6 -.5,8 -7.0,8 5),'
                                                       '(8 6,0 1,9 5,7 5,5 3,2.232432 0,8 6)),'
                                                      '((5 1,7 7,-1032.34324 7,8 -1,5 0,5 1),'
                                                       '(2 9,2.232432 +.6,2 8,4 -4.4,-1032.34324 9,9 +.6,8 1,-.0 1,1 2,7 2,6 -5,2 1,-2 9,2 9),'
                                                       '(7 8,0 4,7 8)),'
                                                      '((5 0,7 1,5 0)),'
                                                      '((3 9,8 5,0 -1032.34324,7 +.9,3 9),(9 9,7 2,0.4 7,9 9),(1 4,4 0,0 2,6.9 6,2.232432 -.8,7 3,1 4)))')),
                     ST_UNION(
                         ST_GEOMFROMTEXT(
                             'MULTILINESTRING((-.5 9,1 1,1 6,6 6),(6 -.5,6 -.2,6 9,2 4),(4 7),(8 7,5 5,9 3,8 -.3))'),
                         ST_GEOMFROMTEXT('POINT()')));


--error ER_GIS_INVALID_DATA
SELECT ST_INTERSECTS(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('MULTIPOLYGON(((4 4,9 10.0002,4 4),(5 0,2 6,5 0)))'))),
                     ST_GEOMFROMWKB(MULTIPOINT(POINT(8,9))));


SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT('POINT(10 10)')));


SET @star_top= 'POINT(15 25)';
SET @star_of_elems='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';

SELECT ST_ASTEXT(ST_GEOMFROMTEXT(@star_of_elems));
SELECT ST_AREA(ST_GEOMFROMTEXT(@star_of_elems));
SELECT ST_ASTEXT(ST_ENVELOPE(ST_GEOMFROMTEXT(@star_of_elems)));
SELECT ST_ASTEXT(ST_CENTROID(ST_GEOMFROMTEXT(@star_of_elems)));
SELECT ST_ASTEXT(ST_CONVEXHULL(ST_GEOMFROMTEXT(@star_of_elems)));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT(@star_of_elems), 1));

SET @buf = ST_BUFFER(ST_GEOMFROMTEXT(@star_of_elems), 1);

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT st_area(@buf);

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(@buf, 1));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_CENTROID(@buf));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_CONVEXHULL(@buf));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_ENVELOPE(@buf));

SELECT ST_DISTANCE(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_top)) as result;

SELECT ST_DISTANCE(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_of_elems)) as result;

--echo ######################################################################################################
--echo # BUG#19584838 : ST_SYMDIFFERENCE: ASSERTION FAILED: T1->RESULT_RANGE
--echo ######################################################################################################

DO ST_SYMDIFFERENCE(
      MULTIPOLYGON(
            POLYGON(
                  LINESTRING(POINT(61, 58), POINT(53, -3), POINT(-91, -19), POINT(61, 58)),
                  LINESTRING(POINT(-70, -6), POINT(-70, -6)))),
      LINESTRING(POINT(27, 6), POINT(19, 15), POINT(78, -36)));

--error ER_GIS_INVALID_DATA
SELECT ST_SYMDIFFERENCE(
      MULTIPOLYGON(
            POLYGON(
                  LINESTRING(POINT(61, 58), POINT(53, -3), POINT(-91, -19), POINT(61, 58)),
                  LINESTRING(POINT(-70, -6), POINT(-70, -6)))),
      LINESTRING(POINT(27, 6), POINT(19, 15), POINT(78, -36)));


--echo ######################################################################################################
--echo # BUG#18307923 : CRASH IN GCALC_OPERATION_REDUCER::GET_RESULT_THREAD
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
      LINESTRING(POINT(0,0), POINT(POW(2,32),POW(2,32)), POINT(POW(2,32),70)),
      ST_ENVELOPE(
            LINESTRING(POINT(POW(2,64),POWER(2,64)), POINT(4294967211,0)))));

--echo ######################################################################################################
--echo # BUG#17535294 : ISSIMPLE() PRODUCING WRONG RESULTS W.R.T. SINGLE POINT POLYGON
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ISSIMPLE(ST_POLYGONFROMTEXT('POLYGON((1 1, 1 1, 1 1, 1 1, 1 1, 1 1, 1 1, 1 1))'));

--error ER_GIS_INVALID_DATA
SELECT ST_ISSIMPLE(ST_POLYGONFROMTEXT('POLYGON((1 1, 1 1, 1 1, 1 1, 1 1, 1 1, 1 1, 1 1, 1 1))'));

--echo ######################################################################################################
--echo # BUG#17507827 : ISSIMPLE() FUNCTION PRODUCING WRONG RESULTS
--echo ######################################################################################################

SELECT ST_ISSIMPLE(ST_LINESTRINGFROMTEXT('LINESTRING(0 0,1 0,2 0,2 0, 2 1, 1.5 0)'));

SELECT ST_ISSIMPLE(ST_LINESTRINGFROMTEXT('LINESTRING(0 0,1 0,2 0,2 0,2 0, 2 1, 1.5 0)'));

--echo ######################################################################################################
--echo # BUG#17376038 : MULTIPOINT'S PROPERTY OF BEING SIMPLE GEOMETRY, BREACHED
--echo ######################################################################################################

SELECT ST_ISSIMPLE(MPOINTFROMWKB(ST_ASWKB(MULTIPOINTFROMTEXT('MULTIPOINT(0 0, 0 0, 1 1, 2 2, 1 1)'))));

SELECT ST_ISSIMPLE(MPOINTFROMWKB(ST_ASWKB(MULTIPOINTFROMTEXT('MULTIPOINT(0 0, 0 0, 1 1, 2 2, 1 1)'))));

--echo ######################################################################################################
--echo # BUG#20402476 : ASSERTION FAILURE IN ITEM_FUNC_SPATIAL_OPERATION::VAL_STR FUNCTION
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
      ST_GEOMFROMTEXT('LINESTRING(-10 -9,-4 -4)'),
      ST_GEOMFROMTEXT('MULTIPOINT(2 6,2 6,8 0,6 4,5 9,0 -9,0 -10,9 1,10 8,5 -9)')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
      ST_GEOMFROMTEXT('MULTIPOINT(2 6,2 6,8 0,6 4,5 9,0 -9,0 -10,9 1,10 8,5 -9)'),
      ST_GEOMFROMTEXT('LINESTRING(-10 -9,-4 -4)')));

--echo ######################################################################################################
--echo # BUG#20133571 : ASSERTION `GRES->HAS_GEOM_HEADER_SPACE()' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_INTERSECTION(
      ST_GEOMFROMTEXT('MULTILINESTRING((-10 3,-9 -4,-9 3,-1 3),'
                                      '(3 10,7 9,-7 2,2 -9,7 10,7 8,3 -4,-9 -1,-5 -8,-7 5,4 9,-3 -6,9 1),'
                                      '(4 4,-7 -3,1 -4,-10 -8),(10 6,1 -7),(0 1,1 -10,3 10,2 -10,-6 -2))'),
      ST_GEOMFROMTEXT('MULTILINESTRING((-7 1,-5 -2,0 -10,-3 4,8 -10,-6 4,-5 3,9 10,2 10))')));

--echo ######################################################################################################
--echo # BUG#20120173 : ASSERTION FAILURE WITH GEOMETRY SET OPERATIONS IN ITEM_GEOFUNC.CC FILE
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POLYGON((0 0,0 4,0 8,0 0))'), ST_GEOMFROMTEXT('POINT(0 0)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POINT(0 0)'), ST_GEOMFROMTEXT('POLYGON((0 0,0 4,0 8,0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POLYGON((0 0,0 4,0 8,0 0))'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'), ST_GEOMFROMTEXT('POLYGON((0 0,0 4,0 8,0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POLYGON((0 0))'), ST_GEOMFROMTEXT('POINT(0 0)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POINT(0 0)'), ST_GEOMFROMTEXT('POLYGON((0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POLYGON((0 0))'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'), ST_GEOMFROMTEXT('POLYGON((0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 4,0 8,0 0)))'), ST_GEOMFROMTEXT('POINT(0 0)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POINT(0 0)'), ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 4,0 8,0 0)))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 4,0 8,0 0)))'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'), ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 4,0 8,0 0)))')));

--echo ######################################################################################################
--echo # BUG#20142402 : ASSERTION FAILURE IN GIS_GEOMETRY_COLLECTION::APPEND_GEOMETRY FUNCTION
--echo ######################################################################################################

--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
      ST_GEOMFROMTEXT('LINESTRING(6 -6,4 -2,5 -1,1 1,-10 10,-1 -10,-8 8,-4 -9,-4 -3,1 -9,5 -2,-4 0,3 5,0 -5)'),
      ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                            'MULTIPOLYGON(((0 2,-5 -9,7 1,-10 2,-7 1,6 0,0 -4)),'
                                         '((-6 1,-5 8,-1 -3,-7 -6,-2 -8))),'
                            'GEOMETRYCOLLECTION('
                                  'MULTIPOLYGON(((3 8,-6 -2,-9 8,2 4,-10 -9,1 -1,8 7,-8 3,1 -1,-8 10,-2 -7,-1 -10,-8 -8,-7 3)),'
                                               '((-3 -2,3 -1,-8 -7,-3 5,-10 5,-6 3,8 3,4 -5,-5 10,0 9,-3 2,9 -1,-1 -6,7 -2)),'
                                               '((3 -9,4 1,-5 5,-9 6,-8 4)),((-10 10,-10 1,-3 -2)),'
                                               '((3 -7,-1 2,-8 -2,9 -6,0 5,-1 -2,-4 -8,2 -6,-5 -10,-1 4))),'
                                  'MULTILINESTRING((4 -7,10 -4,3 4,-9 -9,3 -2,-6 -4,4 10,-3 -3,-1 6,-5 -2,1 0,-1 -9,-8 9,-4 9,-3 -2),'
                                                  '(-5 -7,-3 9,-6 -8,-3 0,-4 0,8 7,-4 9,-4 -6,-7 -9,9 6,10 -1)),'
                                  'GEOMETRYCOLLECTION(),'
                                  'POLYGON((2 -7,-2 -7,-2 2,-5 -6)),'
                                  'LINESTRING(-3 -7,-8 -3),'
                                  'GEOMETRYCOLLECTION(),'
                                  'LINESTRING(-3 -7,-8 -3)),'
                            'GEOMETRYCOLLECTION('
                                  'MULTIPOLYGON(((-10 8,10 -3,-3 5,-5 -10,10 -9,-8 4,5 -10,1 -8,3 -1,-10 10,-4 -6,-9 -8,-9 -5,2 2)),'
                                               '((8 10,4 8,1 5,0 -7,6 8,-3 -1,-2 7)),'
                                               '((-1 -8,10 -10,4 4,7 0,2 7,-2 0,6 -6,-8 5,-1 -5,2 6,10 -8,5 -2,8 5,-4 4,0 -2)),'
                                               '((6 -4,7 10,-8 0,-6 -2,7 -3,7 -5,8 -9,-9 9)),'
                                               '((-4 -2,1 -8,-5 -2,1 7,-10 -5,-8 4,-2 8,-8 1))),'
                                  'MULTILINESTRING((0 -8,-5 4,-3 -6),'
                                                  '(-1 6,7 -10,8 4,10 9),'
                                                  '(-4 9,0 8,-5 6,7 7,-2 0),'
                                                  '(-10 4,-7 -8,-4 9,-6 5,-9 7,10 -2,7 10,0 3,2 -10,-3 9,-6 4)),'
                                  'POINT(10 -10),'
                                  'POINT(10 -10),'
                                  'MULTIPOINT(3 9,1 -3,-7 -1,8 -3),'
                                  'MULTILINESTRING((0 -8,-5 4,-3 -6),'
                                                  '(-1 6,7 -10,8 4,10 9),'
                                                  '(-4 9,0 8,-5 6,7 7,-2 0),'
                                                  '(-10 4,-7 -8,-4 9,-6 5,-9 7,10 -2,7 10,0 3,2 -10,-3 9,-6 4))),'
                            'MULTILINESTRING((-3 -1,-8 -5,4 10),'
                                            '(-5 10,-5 -9,4 0,8 3,5 9)),'
                            'MULTIPOINT(0 -2,9 2,-6 0,8 -5,1 -2,8 0,9 6,-9 1,-5 -6,1 9,-6 -5,4 3,-2 -6))')));

--echo ######################################################################################################
--echo # BUG#20415950 : WL#7225 : ASSERTION FAILURE IN ITEM_GEOFUNC_SETOPS.CC FILE
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOLYGON(((2 -6,10 -4,1 8)),'
                                                              '((-3 1,-7 2,3 -6,-1 2,3 8,-5 9,-10 9,9 9,4 4,-2 2,-5 8)))'),
                                 ST_GEOMFROMTEXT('LINESTRING(-9 -6,7 -3,0 -5,-4 -9,-5 7,-7 7,8 -4,0 0,-5 2,2 8,1 -8,-5 3,-3 -9,-8 -2)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING(-9 -6,7 -3,0 -5,-4 -9,-5 7,-7 7,8 -4,0 0,-5 2,2 8,1 -8,-5 3,-3 -9,-8 -2)'),
                                 ST_GEOMFROMTEXT('MULTIPOLYGON(((2 -6,10 -4,1 8)),'
                                                 '((-3 1,-7 2,3 -6,-1 2,3 8,-5 9,-10 9,9 9,4 4,-2 2,-5 8)))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOLYGON(((2 -6,10 -4,1 8)),'
                                                              '((-3 1,-7 2,3 -6,-1 2,3 8,-5 9,-10 9,9 9,4 4,-2 2,-5 8)))'),
                                 ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                                       'LINESTRING(-9 -6,7 -3,0 -5,-4 -9,-5 7,-7 7,8 -4,0 0,-5 2,2 8,1 -8,-5 3,-3 -9,-8 -2)')));
 
--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                                       'LINESTRING(-9 -6,7 -3,0 -5,-4 -9,-5 7,-7 7,8 -4,0 0,-5 2,2 8,1 -8,-5 3,-3 -9,-8 -2)'),
                                 ST_GEOMFROMTEXT('MULTIPOLYGON(((2 -6,10 -4,1 8)),'
                                                              '((-3 1,-7 2,3 -6,-1 2,3 8,-5 9,-10 9,9 9,4 4,-2 2,-5 8)))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('MULTIPOLYGON(((7 0,-0.7654 0,-.3 -0.7654,-3 -2,0 7,8 3,7 0)))'))),
                                 ST_GEOMFROMWKB(POLYGON(LINESTRING(POINT(4,9), POINT(0,2), POINT(-9.9,5), POINT(2.3,6), POINT(5,4), POINT(4,9)),
                                                        LINESTRING(POINT(3,2), POINT(5,-.3), POINT(3,2)),
                                                        LINESTRING(POINT(9,2), POINT(2.0,6), POINT(9,2)))))); 

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(POLYGON(LINESTRING(POINT(4,9), POINT(0,2), POINT(-9.9,5), POINT(2.3,6), POINT(5,4), POINT(4,9)),
                                                        LINESTRING(POINT(3,2), POINT(5,-.3), POINT(3,2)),
                                                        LINESTRING(POINT(9,2), POINT(2.0,6), POINT(9,2)))),
                                 ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('MULTIPOLYGON(((7 0,-0.7654 0,-.3 -0.7654,-3 -2,0 7,8 3,7 0)))')))));
 
--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('MULTIPOLYGON(((7 0,-0.7654 0,-.3 -0.7654,-3 -2,0 7,8 3,7 0)))'))),
                                 ST_GEOMFROMWKB(GEOMETRYCOLLECTION(
                                                      POLYGON(LINESTRING(POINT(4,9), POINT(0,2), POINT(-9.9,5), POINT(2.3,6), POINT(5,4), POINT(4,9)),
                                                              LINESTRING(POINT(3,2), POINT(5,-.3), POINT(3,2)),
                                                              LINESTRING(POINT(9,2), POINT(2.0,6), POINT(9,2)))))));
 
--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(GEOMETRYCOLLECTION(
                                                      POLYGON(LINESTRING(POINT(4,9), POINT(0,2), POINT(-9.9,5), POINT(2.3,6), POINT(5,4), POINT(4,9)),
                                                              LINESTRING(POINT(3,2), POINT(5,-.3), POINT(3,2)),
                                                              LINESTRING(POINT(9,2), POINT(2.0,6), POINT(9,2))))),
                                 ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('MULTIPOLYGON(((7 0,-0.7654 0,-.3 -0.7654,-3 -2,0 7,8 3,7 0))))')))));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(MULTIPOLYGON(
                                                      POLYGON(LINESTRING(POINT(5,3), POINT(+.5,7), POINT(5,3))),
                                                      POLYGON(LINESTRING(POINT(2,4), POINT(-.0,0), POINT(1,2), POINT(2,+.2),POINT(1,4),POINT(2,4)))),10),
                                 ST_GEOMFROMWKB(POINT(5,8),10)));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(POINT(5,8),10),
                                 ST_GEOMFROMWKB(MULTIPOLYGON(
                                                      POLYGON(LINESTRING(POINT(5,3), POINT(+.5,7), POINT(5,3))),
                                                      POLYGON(LINESTRING(POINT(2,4),POINT(-.0,0), POINT(1,2), POINT(2,+.2), POINT(1,4), POINT(2,4)))),10)));

--error ER_ILLEGAL_VALUE_FOR_TYPE
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(MULTIPOLYGON(
                                                      POLYGON(LINESTRING(POINT(5,3), POINT(+.5,7), POINT(5,3))),
                                                      POLYGON(LINESTRING(POINT(2,4), POINT(-.0,0), POINT(1,2), POINT(2,+.2),POINT(1,4),POINT(2,4)))),10),
                                 ST_GEOMFROMWKB(GEOMETRYCOLLECTION(POINT(5,8),10))));

--error ER_ILLEGAL_VALUE_FOR_TYPE
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(GEOMETRYCOLLECTION(POINT(5,8),10)),
                                 ST_GEOMFROMWKB(MULTIPOLYGON(
                                                      POLYGON(LINESTRING(POINT(5,3), POINT(+.5,7), POINT(5,3))),
                                                      POLYGON(LINESTRING(POINT(2,4), POINT(-.0,0), POINT(1,2), POINT(2,+.2), POINT(1,4), POINT(2,4)))),10)));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(ST_GEOMFROMTEXT('MULTILINESTRING((9 2,8 -7,1 -7))'), ST_GEOMFROMTEXT('POINT(-6 8)')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(ST_GEOMFROMTEXT('POINT(-6 8)'), ST_GEOMFROMTEXT('MULTILINESTRING((9 2,8 -7,1 -7))')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(ST_GEOMFROMTEXT('POINT(7 10)'), ST_GEOMFROMTEXT('MULTILINESTRING((7 6,3 -4))')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(ST_GEOMFROMTEXT('MULTILINESTRING((7 6,3 -4))'), ST_GEOMFROMTEXT('POINT(7 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(
      ST_GEOMFROMTEXT(
            'MULTIPOLYGON(((-8 -1,-6 -4,-5 10,-7 2,-4 -9,10 4,-2 -7,-4 -10)),'
                        '((-9 -8,3 -4,3 -3,-4 10,7 1,2 -10,-1 -1,-2 -9,-1 8,2 -7,-10 10,-10 4,-10 8,-6 -3,-3 4)))'),
      ST_GEOMFROMTEXT(
            'MULTIPOINT(1 -3,7 0,-2 0,-3 -6,-6 0,3 -7,-9 0)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(
      ST_GEOMFROMTEXT(
            'MULTIPOINT(1 -3,7 0,-2 0,-3 -6,-6 0,3 -7,-9 0)'),
      ST_GEOMFROMTEXT(
            'MULTIPOLYGON(((-8 -1,-6 -4,-5 10,-7 2,-4 -9,10 4,-2 -7,-4 -10)),'
                         '((-9 -8,3 -4,3 -3,-4 10,7 1,2 -10,-1 -1,-2 -9,-1 8,2 -7,-10 10,-10 4,-10 8,-6 -3,-3 4)))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(
      ST_GEOMFROMTEXT(
            'MULTIPOLYGON(((-8 -1,-6 -4,-5 10,-7 2,-4 -9,10 4,-2 -7,-4 -10)),'
                         '((-9 -8,3 -4,3 -3,-4 10,7 1,2 -10,-1 -1,-2 -9,-1 8,2 -7,-10 10,-10 4,-10 8,-6 -3,-3 4)))'),
      ST_GEOMFROMTEXT(
            'GEOMETRYCOLLECTION(MULTIPOINT(1 -3,7 0,-2 0,-3 -6,-6 0,3 -7,-9 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(
      ST_GEOMFROMTEXT(
            'GEOMETRYCOLLECTION(MULTIPOINT(1 -3,7 0,-2 0,-3 -6,-6 0,3 -7,-9 0))'),
      ST_GEOMFROMTEXT(
            'MULTIPOLYGON(((-8 -1,-6 -4,-5 10,-7 2,-4 -9,10 4,-2 -7,-4 -10)),'
                         '((-9 -8,3 -4,3 -3,-4 10,7 1,2 -10,-1 -1,-2 -9,-1 8,2 -7,-10 10,-10 4,-10 8,-6 -3,-3 4)))')));

SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('MULTIPOLYGON(((1 5,-2 2,0 4,-9 10,5 2,-3 3)))'), ST_GEOMFROMTEXT('POLYGON((-6 -4,4 4,5 -5,-7 5,-8 2,6 -5))')));

SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('POLYGON((-6 -4,4 4,5 -5,-7 5,-8 2,6 -5))'), ST_GEOMFROMTEXT('MULTIPOLYGON(((1 5,-2 2,0 4,-9 10,5 2,-3 3)))')));

SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('MULTIPOLYGON(((1 5,-2 2,0 4,-9 10,5 2,-3 3)))'),
                          ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((-6 -4,4 4,5 -5,-7 5,-8 2,6 -5)))')));

SELECT ST_ASTEXT(ST_UNION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((-6 -4,4 4,5 -5,-7 5,-8 2,6 -5)))'),
                          ST_GEOMFROMTEXT('MULTIPOLYGON(((1 5,-2 2,0 4,-9 10,5 2,-3 3)))')));

--echo ######################################################################################################
--echo # BUG#20420721 : WL#7225 : ASSERTION FAILURE WITH SET OPERATIONS IN ITEM_GEOFUNC_SETOPS.CC FILE
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMWKB(
                  POLYGON(LINESTRING(POINT(3,4),POINT(1,9),POINT(3,4)),
                          LINESTRING(POINT(5,1),POINT(1,6),POINT(2,3),POINT(2,3),POINT(2,9),POINT(0,1),POINT(4,4),POINT(5,1)),
                          LINESTRING(POINT(7,3),POINT(8,3),POINT(4,4),POINT(3,8),POINT(4.2,9),POINT(6,4),POINT(8,8),POINT(-.7,1),POINT(7,3)))),
            ST_GEOMFROMWKB(POINT(5,+.1))));

SELECT ST_ASTEXT(
      ST_SYMDIFFERENCE(
            ST_GEOMFROMTEXT(
                  'GEOMETRYCOLLECTION('
                        'LINESTRING(8 -2,-2 -10,8 5),'
                        'MULTIPOINT(7 -6,9 1,-4 2,1 -8,-7 -4,1 0,5 0,-3 -8,-6 0,-6 2,5 -6,1 2,4 8,-5 -7),'
                        'POINT(5 2))'),
            ST_GEOMFROMTEXT('MULTIPOLYGON(((5 -1,-2 7,-9 6,-4 2,4 -7,-2 1,9 2,-7 9,6 0,8 0,-5 -9,-8 2,-6 4,10 2)))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMWKB(
                  MULTIPOLYGON(
                        POLYGON(LINESTRING(POINT(2,2),POINT(6,0),POINT(2,2)),
                                LINESTRING(POINT(4,8),POINT(9,4),POINT(7,-.7),POINT(4,7),POINT(4,8))))),
            ST_GEOMFROMWKB(
                  ST_ASWKB(
                        ST_GEOMFROMTEXT('MULTIPOINT(1 189.7654,41,-1032.34324 9,6.4 1,4 9)')))));

SELECT ST_ASTEXT(
      ST_SYMDIFFERENCE(
            ST_GEOMFROMTEXT(
                  'GEOMETRYCOLLECTION('
                        'GEOMETRYCOLLECTION(),'
                        'MULTIPOINT(-5 -2,7 -4,5 -10,4 1,6 -3,-2 4,6 9),'
                        'LINESTRING(8 4,0 -10,-10 10,-2 -9),'
                        'MULTILINESTRING((-3 1,-8 -7,-6 1,-7 0,-9 10,-3 -9,4 6,8 5),'
                                        '(7 -10,-10 10,-9 7,-8 9,-5 -8,-3 3,10 -1,8 1,-3 -7),'
                                        '(10 10,10 -2,-1 -10,-2 -2,-1 -1,-4 8,-9 9,-6 -9,10 -7,-4 5,8 9)))'),
            ST_GEOMFROMTEXT(
                  'MULTIPOLYGON(((8 2,8 10,1 10)),'
                               '((-10 9,1 -5,7 10,8 -6,7 -9,5 5,-8 -3,10 -6,6 -2)))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMTEXT('MULTIPOLYGON(((2 9,-2 9,-3 -5)),((-10 6,1 6,3 -4,-1 6)))'),
            ST_GEOMFROMTEXT('MULTIPOINT(8 -2,-2 -5,9 -9,-4 -10,-9 -4,10 -3,9 10,-1 -5,-3 3)')));

SELECT ST_ASTEXT(
      ST_SYMDIFFERENCE(
            ST_GEOMFROMTEXT('MULTIPOLYGON(((-2 3,3 2,-7 4,-8 -4,-8 8,4 3,-10 -4,0 6,-4 7,-9 3,-6 0,-1 -8,-5 -3,2 -6,-7 -7)),'
                                         '((-8 -9,-4 7,-5 5,6 -9,-6 -4,-1 6,-7 8,-2 0,1 -4,-9 -5,2 -3,0 6,8 -6)),'
                                         '((-4 -5,-10 8,-1 -1,-5 -7,-5 5,0 6,10 1,6 -9,8 -4,6 7,-10 2,10 -8,0 -7)),'
                                         '((4 -9,7 -5,3 -6)),'
                                         '((-8 -4,5 4,-3 8,-10 -2,-3 -3,5 -8,9 -8,3 7,8 -1,8 4)))'),
            ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                  'LINESTRING(0 1,8 -9,-1 0,-9 -3,-9 10,-9 2,1 -4,-6 1,1 9,-9 -6,5 -7,3 10,2 -1,8 -4),'
                                  'POINT(4 8))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMTEXT('MULTILINESTRING((3 -.7),(4 -1032.34324),(2 1,8 7),(7 5,-4 8,2.2 8,2 8,6 7))'),
            ST_GEOMFROMTEXT('POLYGON((5 2,+.1 0,5 2))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMTEXT('POLYGON((5 3,6 7,-2.0 4,0 1,7 -0,5 3),(5 6,9 5,5 6))',10),ST_GEOMFROMTEXT('POINT(8 9)',10)));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_UNION(
            ST_GEOMFROMWKB(POLYGON(LINESTRING(POINT(9,0),POINT(7,1),POINT(9,0)))),
            ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('MULTIPOINT(8 9,-9.9 6,7 8,7 5,1 -4)')))));

DO (SELECT ST_ASTEXT(ST_SYMDIFFERENCE(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                                            'POINT(-6 -5),'
                                                            'LINESTRING(-6 -5,-6 -3,4 0,2 -7,-10 -3,0 -5,-10 -3,0 8,-6 -2,6 -9))'),
                                      ST_GEOMFROMTEXT('MULTIPOLYGON(((9 -3,-7 9,5 -7)),((-7 9,8 -5,3 7,-3 -9,-4 -10,-1 9,-3 4,-4 10,1 5,0 3)))'))));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMWKB(
        MULTIPOLYGON(
            POLYGON(
                LINESTRING(POINT(1,5),POINT(-.1,6),POINT(6.9,2),POINT(1,5),POINT(9,-8.8),POINT(4,9),POINT(7,8),POINT(1,5)),
                LINESTRING(POINT(2,2),POINT(0,-.3),POINT(2,2)),
                LINESTRING(POINT(6,1),POINT(4,0.4),POINT(4,9),POINT(2,8),POINT(8,4),POINT(-9.8,-2.4),POINT(9.9,6),
                           POINT(1,7),POINT(7,6),POINT(6,0),POINT(6,1)))),10),
    ST_GEOMFROMWKB(
        MULTILINESTRING(
            LINESTRING(POINT(1,2),POINT(3,8),POINT(2,9),POINT(7,+.5)),
            LINESTRING(POINT(2,0),POINT(9,6),POINT(7,4),POINT(.1,7),POINT(3,2),POINT(2.4,2),POINT(-1.1,5)),
            LINESTRING(POINT(8,5.1),POINT(-7.2,5),POINT(-.6,-.7),POINT(5,8),POINT(-4.0,4),POINT(9,4),POINT(2,7),POINT(7,7),POINT(3,8),POINT(2,3),
                       POINT(8.8,7),POINT(.9,8),POINT(3,1),POINT(1,9),POINT(5,4),POINT(4,0),POINT(4,9),POINT(2,0),POINT(6,6)),
            LINESTRING(POINT(8,8),POINT(+.8,+.1),POINT(+.6,-3.1),POINT(8,0),POINT(5,8),POINT(4,9),POINT(9,6)),
            LINESTRING(POINT(1,7),POINT(7,7),POINT(0,4),POINT(5,8)),
            LINESTRING(POINT(-.6,6)),
            LINESTRING(POINT(7,3),POINT(3,0),POINT(2,8),POINT(7,3),POINT(7,2),POINT(0,5),POINT(9,0))),10)));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMWKB(
        POLYGON(
            LINESTRING(POINT(6,3),POINT(6,8),POINT(6,3)),
            LINESTRING(POINT(9,3),POINT(0,-.1),POINT(8,2),POINT(2.4,1),POINT(9,2),POINT(8,1.9),POINT(1,0),
                       POINT(5,9),POINT(8.1,-.5),POINT(0,-4.3),POINT(8,3),POINT(9,3)))),
    ST_GEOMFROMTEXT('POINT(0 +.3)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(POLYGON(LINESTRING(POINT(2,8),POINT(2,5),POINT(2,8))),10),
                                 ST_GEOMFROMTEXT('LINESTRING(6 6,-8 9,-4 4,1 2)',10)));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMWKB(
        POLYGON(
            LINESTRING(POINT(6,7),POINT(+.3,1),POINT(6,7)))),
    ST_GEOMFROMWKB(
        LINESTRING(POINT(3,5),POINT(3,9),POINT(-2.5,-3.9),POINT(9,8),POINT(5,0),POINT(3,1),POINT(+.3,1.9),POINT(-.3,9),POINT(0,-3.3)))));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('MULTILINESTRING((5 7,0.8 2,9 3,5 7),(5 3,-3 1))'))),
                                 ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POLYGON((1 5,+.8 -0.7654,1 5))')))));

--error ER_BOOST_GEOMETRY_OVERLAY_INVALID_INPUT_EXCEPTION
SELECT ST_ASTEXT(
    ST_SYMDIFFERENCE(
        ST_GEOMFROMTEXT('POLYGON((0 4,-8 -1,1 9))'),
        ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                            'GEOMETRYCOLLECTION(),'
                            'GEOMETRYCOLLECTION(),'
                            'MULTIPOINT(-7 -6,-6 -3,5 -1,-8 7,-5 -4,-3 7,7 -7,7 -8,5 -1),'
                            'MULTIPOLYGON(((10 -1,-10 -8,-5 9))),'
                            'MULTILINESTRING((1 -8,1 -4,-10 -8,-4 5,-4 0,-10 5,6 0,6 3,5 7,10 -8,-4 -3,-8 4,-7 6,-5 -7),'
                                            '(10 9,4 4,-2 6,8 4,-4 1,2 3,-7 8,-6 -3,3 8,-7 -10,-10 -1,-5 -7,2 1,-10 5)),'
                            'POLYGON((0 7,-3 4,-7 6,-6 9,2 -10)),'
                            'GEOMETRYCOLLECTION('
                                'MULTILINESTRING((3 10,-1 -2,8 4,-1 5,-6 0,9 0,-6 -2,8 9),'
                                                '(-4 -8,-4 -7,-2 7,8 -6,-2 -9,-6 -8,-7 -2,-7 6),'
                                                '(-4 0,1 10,4 3,-4 0,7 -1,-1 5,5 -8,5 1,5 -6),'
                                                '(-9 10,-4 1,-5 3,-6 6,-5 9,4 9,10 5,5 0),'
                                                '(4 10,3 -5,-1 5,-8 -3,0 -5,-7 5,3 0,3 -10,-7 0,5 1,1 5,3 -4,-10 7,-1 10,-8 0))),'
                            'MULTILINESTRING((-6 2,5 4,9 1,9 9)),'
                            'MULTILINESTRING((6 -5,-3 3,-6 8,9 -7,3 10,-9 -9,1 2,8 -9),'
                                            '(5 -10,6 -10,9 10,-1 -5,-8 4,-7 1,8 1,-2 9,3 5,-10 3,6 5,-9 7,-7 -7,-2 2,1 5),'
                                            '(-6 0,10 -1,2 4,9 3,1 -5),(6 8,-10 1,-3 3,10 6)),POINT(-3 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POLYGON((1 3,+.5 -1032.34324,1 3))')),10),
            ST_GEOMFROMWKB(GEOMETRYCOLLECTION(POINT(2,.1),
                                              LINESTRING(POINT(4,7),POINT(3,5),POINT(-5.1,7),POINT(5,-3.6)),
                                              LINESTRING(POINT(6,3),POINT(5,3),POINT(0,1),POINT(8,7))),10)));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMWKB(
                  POLYGON(
                        LINESTRING(POINT(4,6),POINT(9,9),POINT(2,0),POINT(4,4),POINT(4,6)),
                        LINESTRING(POINT(7,5),POINT(4,2),POINT(4,5),POINT(-.8,5),POINT(7,5)),
                        LINESTRING(POINT(4,1),POINT(6,0),POINT(3,3),POINT(-1.8,4),POINT(4,1)),
                        LINESTRING(POINT(6,7),POINT(2,7),POINT(2,-.0),POINT(.1,-.4),POINT(4,5),POINT(6,7)),
                        LINESTRING(POINT(2,5),POINT(2,.6),POINT(4,3),POINT(3,8),POINT(2,5))),10),
            ST_GEOMFROMTEXT('LINESTRING(-.7 -.3,0 5,8 0,9 7)',10)));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_INTERSECTION(
            ST_GEOMFROMTEXT(
                  'GEOMETRYCOLLECTION('
                        'POLYGON((3 1,5 2,3 1),(8 5,4 9,-4.6 6,2.0 0,4 -1032.34324,8 5)),'
                        'LINESTRING(0 +.6),'
                        'LINESTRING(4 189.7654,9 5,0 +.8,3 9))',10),
            ST_GEOMFROMWKB(
                  MULTIPOLYGON(
                        POLYGON(
                              LINESTRING(POINT(6,3),POINT(4,-.3),POINT(9,2),POINT(5,9),POINT(0,8),POINT(6,3))),
                        POLYGON(
                              LINESTRING(POINT(1,6),POINT(3,8),POINT(9,1),POINT(7,6),POINT(6,1),POINT(0,-.4),POINT(6,2),
                                         POINT(0,4),POINT(0,9),POINT(3,4),POINT(4,+.0),POINT(4,2),POINT(4,7),POINT(1,6))),
                        POLYGON(
                              LINESTRING(POINT(3,1),POINT(2,3),POINT(3,1)),
                              LINESTRING(POINT(6,7),POINT(2,4),POINT(6,7))),
                        POLYGON(
                              LINESTRING(POINT(1,0),POINT(8,3),POINT(3,7),POINT(4,3),POINT(9,5),POINT(1,0))),
                        POLYGON(
                              LINESTRING(POINT(6,4),POINT(-3.0,1),POINT(5,8),POINT(8,4),POINT(3,7),POINT(8,9),POINT(5,6),POINT(6,4)),
                               LINESTRING(POINT(5,5),POINT(2,0),POINT(1.3,9),POINT(+.2,9),POINT(6,6),POINT(.5,9),POINT(7,0),
                                          POINT(9,-.9),POINT(9,4),POINT(3,1),POINT(4,7),POINT(9,0),POINT(-.5,4),POINT(3,1),POINT(5,5)))),10)));

--echo ######################################################################################################
--echo # BUG#20445979 : ASSERTION `RESULT->LENGTH() == 0' FAILED
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_UNION(
            ST_GEOMFROMWKB(
                  ST_ASWKB(
                        ST_GEOMFROMTEXT('MULTILINESTRING((3 189.7654, 0 0, 10.0002 1, -1.2 0),'
                                                        '(3 4, 10.0002 6,2.7 2.232432, 8 6, 0 3),'
                                                        '(7.1 9, -4 -.8, -0.7654 7, 1 5, -0.7654 5,-6.7 -0.7654, 6 2.232432, 0 2.232432),'
                                                        '(8 3.9, 2 3, 3 8, 0 7, 1 6),'
                                                        '(8 3, 5 3, 9 4.4, 4 2.4),'
                                                        '(9 2.232432, -1032.34324 2.232432, -1.9 9),'
                                                        '(2.232432 6, 9 189.7654, 8 7, 5 6, 10.0002 8),'
                                                        '(2.232432 -6.3, 189.7654 9,3 3, 10.0002 -8.7, 3 -0.7654),'
                                                        '(5 -.3, 5 1, 6 2, 2.232432 5, 1 1, 9 10.0002,9 3, -1032.34324 1),'
                                                        '(1 7, 4 -0.7654, 3 7, -0.7654 8))'))),
                        ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                              'MULTIPOINT(0.8 2.232432, 6 -2, 2 -5, -9.06),'
                                              'MULTIPOINT(5 8, 9.3 7),'
                                              'POLYGON((4 1, -3.9 2, 1 0.6, 1 1, 4 1)),'
                                              'POINT(9 +.7),'
                                              'LINESTRING(189.7654 2, 4 -1032.34324, 9 0, 9 8),'
                                              'POLYGON((1 1, 0 +.0, 2 4, 7 9,9 -3, 3 -0.7654, 10.0002 7, 8 -1032.34324, 1 1)))')));

--echo ######################################################################################################
--echo # BUG#20445765 : ASSERTION `MLS != __NULL' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(
                                       'GEOMETRYCOLLECTION(LINESTRING(9 -0.7654,3 -1032.34324,6 0))'),
                                 ST_GEOMFROMTEXT(
                                        'LINESTRING(0 1,-.7 6,9 6,-8.0 -.0,4 7)')));

--echo ######################################################################################################
--echo # BUG#20462935 : WL#7225 : MYSQLD GOT SIGNAL 11
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_UNION(
    ST_GEOMFROMTEXT('POINT(8 0.8)'),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'POLYGON((7 2, 1 4, 5 6, +.3 -1032.34324, 7 2),'
                                '(7 4, 2 0, +.6 -1.4, -9 9, 8 7, 7 4),'
                                '(2 0, -.9 5, 2.232432 9, 2 4, 2.232432 1, 0 -1032.34324, 2 0)),'
                        'MULTIPOINT(-0.7654 2.232432,+.9 +.1, 8 3, 189.7654 -6, 4 -.5),'
                        'MULTIPOLYGON(((7 0, 7 1, 6 -9, 7 0))),'
                        'POLYGON((2 9, 9 2.232432, 1 189.7654, 2.232432 6, +.4 9, 189.7654 3, 6 2, 2 9),'
                                '(1 9, 3 -1, 189.7654 -0.7654, 1 9)),'
                        'MULTIPOINT(1 10.0002, 0 6, 8 3, 5 -0.7654),'
                        'POLYGON((6 3, -6.5 189.7654, -8 -1032.34324, +.4 3,-.2 1, -0.7654 -.0, 6 3)))')));

--echo ######################################################################################################
--echo # BUG#20462858 : ASSERTION `GEOTYPE == GTYPE || GEOTYPE == 0' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_UNION(
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTIPOINT(8 1, 5 9, 2.232432 2.232432, -1032.34324 7, 10.0002 6, 2 0.6))'),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTIPOINT(2.232432 -1032.34324, 2.232432 2.232432, 0.6 1, -0.7654 -.5),'
                        'POLYGON((6 5, 4 -1032.34324, 189.7654 -.5, 6 5)),'
                        'POLYGON((4 6, 7 1, -0.7654 10.0002, 0 10.0002, -3.5 -7, 5 6, 3 -7.7,2.232432 9, 4 6)))')));

--echo ######################################################################################################
--echo # BUG#20379857 : ASSERTION `ENTER_COUNT == 0' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('POLYGON((-4 0,7 -8,-5 1,1 9,-9 -7,9 6,-6 -9))'),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTILINESTRING((5 8,-5 -8,3 -7,-2 -7,6 2,6 3,6 10,7 7,1 0,-6 -1,8 -4,-2 1,9 -10,4 -2)),'
                        'LINESTRING(-1 -2,10 -7,8 -5))')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('POLYGON((-4 0,7 -8,-5 1,1 9,-9 -7,9 6,-6 -9))'),
    ST_GEOMFROMTEXT('MULTILINESTRING((5 8,-5 -8,3 -7,-2 -7,6 2,6 3,6 10,7 7,1 0,-6 -1,8 -4,-2 1,9 -10,4 -2),(-1 -2,10 -7,8 -5))')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(ST_GEOMFROMTEXT('POLYGON((-4 0,7 -8,-5 1,1 9,-9 -7,9 6,-6 -9))'), ST_GEOMFROMTEXT('LINESTRING(-1 -2,10 -7,8 -5)')));

--echo ######################################################################################################
--echo # BUG#20422341 : ST_ISSIMPLE(MULTILINESTRING) RETURNS INCORRECT RESULT
--echo ######################################################################################################

SELECT ST_ISSIMPLE(ST_GEOMFROMTEXT('MULTILINESTRING((0 0,10 0,10 10,0 10,0 0))'));

SELECT ST_ISSIMPLE(ST_GEOMFROMTEXT('MULTILINESTRING((0 0,0 5,5 5,5 0,0 0))'));

--echo ######################################################################################################
--echo # BUG#20430837 : WL#7225: BOOST_ASSERT( ENTER_COUNT == 0 )
--echo ######################################################################################################

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('MULTIPOLYGON(((7 -6,-2 8,-5 -4,2 7,4 9,0 -9,8 2,5 -2,9 0,-6 1,10 -10)),'
                                 '((-7 -4,9 3,-9 8,0 -4,5 -9)),'
                                 '((-10 1,-5 -3,1 -1,-9 -5,10 -9,9 -7,-4 9,8 0,2 0)))'),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'POINT(-4 -1),'
                        'MULTIPOINT(3 1,-5 10,-5 -6,7 -10,5 -5,-10 -7,-8 7,9 0,6 -4,5 7),'
                        'LINESTRING(5 -8,-7 -6,-3 6,-3 1,-5 4,-1 0,8 5,5 1,-2 3,1 10,8 5,6 2,7 4),'
                        'MULTIPOINT(0 1,-7 -7,-3 -2,6 -1,-9 -9,2 6,-9 -6,-4 0,0 10))')));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_DIFFERENCE(
    ST_GEOMFROMTEXT('LINESTRING(5 -8,-7 -6,-3 6,-3 1,-5 4,-1 0,8 5,5 1,-2 3, 1 10,8 5,6 2,7 4)'),
    ST_GEOMFROMTEXT('MULTILINESTRING((1.9375 1.875,1.7441860465116283 1.9302325581395348,-0.7692307692307692 2.6483516483516487,'
                                     '-2 3,-1.0071942446043165 5.316546762589928))')));

--echo ######################################################################################################
--echo # BUG#20434940 : ASSERTION `IS_CLOSING_POINT_OF(TURN.POINT, LS1)' FAILED
--echo ######################################################################################################

SELECT ST_ISSIMPLE(ST_GEOMFROMTEXT('MULTILINESTRING((4 1,10 8,4 6,4 1,10 5,10 3))'));

--echo ######################################################################################################
--echo # BUG#20455380 : ASSERTION `ENTER_COUNT == 0' FAILURE WITH LINEAR GEOMETRIES
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('MULTILINESTRING((2 5,-0.7654 2),'
                                    '(-1032.34324 4,1 5,9 7,3 9,0.2 5,1 -0.3),'
                                    '(1 0.9,1 6,1 -0.6,2.232432 -0.7654,0.9 3,1 5,-0.7654 9,3 0.1,9 0,-6 8,-0.7 8,0 1,-1032.34324 0))'),
    ST_GEOMFROMTEXT('LINESTRING(1 5,4 2,1 -1.1,1 6,1 189.7654,2 5,-0.7654 3)')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('LINESTRING(0 -3,5 4,6 6,-3 2,-3 0,-3 -10,9 -2,9 5,5 -5,-4 -8,9 0)'),
    ST_GEOMFROMTEXT('LINESTRING(-3 6,-3 0,-3 5,2 -3,-6 10,5 0,2 8,-6 1,10 -6)')));

--echo ######################################################################################################
--echo # BUG#20463609 : ST_SYMDIFFERENCE : ASSERTION `ENTER_COUNT == 0' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('LINESTRING(-2 -2,-4 0,1 -8,-2 6,8 5,-7 -8,3 0,4 -1,-7 10,-4 10)'),
    ST_GEOMFROMTEXT('LINESTRING(-5 -4,3 0,4 -1,7 -4,2 -1,-4 -1,-2 6)')));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMWKB(
        ST_ASWKB(
            ST_GEOMFROMTEXT('MULTILINESTRING((1 5, -4.3 -.1),'
                                            '(0 6,8.6 6,189.7654 5,1 3,6 3,3 5,6 2.232432,0 4),'
                                            '(-6 5,1 2.232432),'
                                            '(3 -1032.34324,9 0,189.7654 1,-1.4 3,3 189.7654,+.3 10.0002,1 5,6 3,5 1,9 1,10.0002 -1032.34324,-0.7654 0,5 3, 3 4),'
                                            '(2.232432 2.232432,8.6 +.4,0.0 2.232432,4 0,-8.8 10.0002),'
                                            '(1 0,6 6,7 2,-0 8.4),'
                                            '(-0.7654 3,+.6 8,4 -1032.34324,1 6,0 4),'
                                            '(0 7,2 1,8 -7,7 -.7, -1032.34324 9), (5 0, 10.0002 4, 8 7, 3 3, -8.1 5))'))),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTIPOLYGON(((9 6,189.7654 10.0002,5.1 7,7 -0.7654,8 -.7,9 6),'
                                      '(3 7,10.0002 -1032.34324,5 5,2.232432 1,-.8 +.0,3 8,0 2.232432,3 7)),'
                                     '((7 5,1 3,1 0.8,2 -.5,3 6,6.6 3.7,2.232432 -1032.34324,+.2 10.0002,7 5),'
                                      '(0 8,10.0002 9,5 2,6 5,8 8,0 8)),'
                                     '((2 0,9 2.232432,9 -3,2 8,7 9,3 0,-1 -8.2,0 8,2 0),'
                                      '(5 2,2 3,9 5,6 1,10.0002 2.232432,-6.2 9,8 10.0002,9 3.0,5 -8.7,5 2))),'
                        'MULTILINESTRING((5 10.0002,2 7,-0.7654 0,5 3),'
                                        '(0 -0.7654,4 10.0002,4 +.1,-.8 3,-.1 8,10.0002 2,+.9 -1032.34324)))')));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMWKB(
        ST_ASWKB(
            ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                'MULTILINESTRING((1 4, 6 5, 2 -1032.34324, 6.9 6),'
                                                '(6 3, 4 2, 7 0.8, 2 5),'
                                                '(0 9, 9 4, -0.1 10.0002, 0 +.5, 4 8, -3 7),'
                                                '(2 7, 5 -6),'
                                               '(9 -1032.34324, 2 0, 6 3, 2 2, 4 -1032.34324, 6 2.232432)),'
                                'MULTILINESTRING((-0.7 2.232432, +.3 -.5),'
                                                '(0 2, 7 -.3, 2.4 5, +.8 2)),'
                                'POLYGON((8 9, 9 0, 189.7654 8, 8 9),'
                                        '(9 5, 5 2, 2.232432 -.3, 4 3, 2 2, 10.0002 1.6, 1 6, 8 8, 3 3, 9 5),'
                                        '(4 5, 7 4, 2.232432 2.232432, 0 -.9, 0 189.7654, 2 2, 4 5),'
                                        '(7 9, 1 -3.6, 2.232432 2.232432, 6 1, 2.232432 6, 0 2.232432, 7 9)))'))),
    ST_GEOMFROMWKB(
        ST_ASWKB(
            ST_GEOMFROMTEXT('LINESTRING(0 -5, 5 10.0002)')))));

SELECT ST_ASTEXT(ST_UNION(
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTIPOINT(1 1, 5 -3, 10.0002 1, -1032.34324 5, 9 1.1, 4.5 4, 5 0, -5.1 3),'
                        'MULTIPOINT(-1032.34324 5, 8 -1032.34324, -0.7654 3, -1032.34324 4, 1 1, 8 2),'
                        'POLYGON((7 2, 6.9 +.6, -0.7654 -.5, 2.4 7, 7 3, 7 2)))'),
    ST_GEOMFROMWKB(POLYGON(LINESTRING(POINT(7,9), POINT(7,3), POINT(7,6), POINT(0,6), POINT(7,9))))));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT
ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTIPOINT(4 2, 2 4, 4 1, 5 -3.9, 10.0002 3, 2.232432 2, 189.7654 -.9, 7 7),'
                        'POLYGON((8 3, -0.7654 -.0, 10.0002 8, 1 6, 189.7654 4, -1032.34324 4, 8 3),'
                                '(2 7, 2.232432 0.5, 9 2, 2.232432 1, 9 5, 6 8, 8 -1032.34324, -9.7 -.1, 9.9 2, 1 5, 1 -.6, 10.0002 -.7, 1 4, 7.0 9, 2 7)),'
                        'MULTILINESTRING((1 8, 9 -0.7654, 5 7, +.0 -0.7654, 8 7),'
                                        '(8 1.1, 6 4, -.4 10.0002, -.3 -1, +.3 8)))'),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'POINT(9 6.7),'
                        'MULTILINESTRING((5 0, 2.232432 -0.7654, 0 0, 10.0002 1),'
                                        '(9 0.6, -2.8 0, 2.232432 2.4),'
                                        '(1 -1032.34324, -1032.34324 -7.0, 1 0, 0 9, +.2 189.7654, 5 1),'
                                        '(-9.3 189.7654, 7 0, 10.0002 -1032.34324, 3 9.6, 9 10.0002),'
                                        '(1 8, 9 -0.7654, -0.7654 3, 8 5, 3 3)),'
                                        'POINT(-1032.34324 1))')));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('MULTILINESTRING((-.4 2, 2.232432 3, 6 9, 8 189.7654, -1032.34324 5.4, 2.232432 9),'
                                    '(-1032.34324 3, 8 -1.6),'
                                    '(0 -.2, 8 1, -.5 7, 6 +.2))'),
    ST_GEOMFROMWKB(MULTILINESTRING(
                       LINESTRING(POINT(-8,1), POINT(4.8,6), POINT(2,+.5)),
                       LINESTRING(POINT(10.0002,2), POINT(9,-1032.34324), POINT(.3,8), POINT(0,5), POINT(8,1), POINT(4,.4), POINT(2,8)),
                       LINESTRING(POINT(6,7), POINT(+.1,7), POINT(0,-.5))))));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMWKB(
        ST_ASWKB(
            ST_GEOMFROMTEXT(
                'GEOMETRYCOLLECTION('
                    'MULTILINESTRING((4 -0.7654, -1032.34324 -1032.34324, 8 8, 1 0, 6 7, -1032.34324 -.0, -1032.34324 189.7654, 9 2, -9.6 -1032.34324, 5 6, 0 9.0)),'
                    'POINT(7 4),'
                    'LINESTRING(1 -.0, 6 2, 0 1, -2 -8.4, 0 7, -1032.34324 2.3, 6 3, -1032.34324 -1032.34324),'
                    'MULTILINESTRING((1 4, 6 5, 2 -1032.34324, 6.9 6),'
                                    '(6 3, 4 2, 7 0.8, 2 5),'
                                    '(0 9, 9 4, -0.1 10.0002, 0 +.5, 4 8, -3 7),'
                                    '(2 7, 5 -6),'
                                    '(9 -1032.34324, 2 0, 6 3, 2 2, 4 -1032.34324, 6 2.232432)),'
                    'MULTILINESTRING((-9.0 2, -5 0.8),'
                                    '(9 189.7654, 9 4, 3 -9, 9 2),'
                                    '(189.7654 9, 7 3, 5 189.7654, -1032.34324 4, -5.9 9)),'
                                    'POINT(1 -.2),'
                                    'LINESTRING(7 8, 6 1),'
                                    'POINT(2 2),'
                                    'LINESTRING(1 8, 0 189.7654, 1 -1032.34324, 8 2),'
                                    'MULTIPOLYGON(((2 8, 4 0, 3 9, 5 -3, 0 6, 6 1, 2 8))),'
                                    'LINESTRING(-0.7654 -.8, 8 1),'
                                    'POINT(7 9),'
                                    'MULTILINESTRING((-0.7 2.232432, +.3 -.5),'
                                                    '(0 2, 7 -.3, 2.4 5, +.8 2)),'
                                    'LINESTRING(10.0002 6.4, 189.7654 4, 189.7654 8, 3 5, 9 -2, 2 -1032.34324),'
                                    'POLYGON((8 9, 9 0, 189.7654 8, 8 9),'
                                            '(9 5, 5 2, 2.232432 -.3, 4 3, 2 2, 10.0002 1.6, 1 6, 8 8, 3 3, 9 5),'
                                            '(4 5, 7 4, 2.232432 2.232432, 0 -.9, 0 189.7654, 2 2, 4 5),'
                                            '(7 9, 1 -3.6, 2.232432 2.232432, 6 1, 2.232432 6, 0 2.232432, 7 9)),'
                                    'LINESTRING(3 1.2, -9 +.2),'
                                    'POINT(-.0 0),'
                                    'MULTIPOINT(-0.7654 -1032.34324, 3 189.7654, 4 6, -2.7 +.2, -1032.34324 6.5, 10.0002 -0.7654, 7 9))'))),
    ST_GEOMFROMWKB(
        ST_ASWKB(
            ST_GEOMFROMTEXT(
                'GEOMETRYCOLLECTION('
                    'POINT(5 -3),'
                    'POINT(189.7654 7),'
                    'LINESTRING(0 -5, 5 10.0002))')))));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_UNION(
        ST_GEOMFROMTEXT('MULTIPOLYGON(((10 0,-10 -3,-10 6,-10 7,4 6,6 1,-9 -8)))'),
        ST_GEOMFROMTEXT('MULTILINESTRING((7 6,7 3,1 5,6 1,1 9,-6 -8,-7 -3,0 -3,7 -5,7 -2,-1 -9,-1 -6,7 7,-7 -10),'
                                        '(10 4,8 10,-3 8,2 3,9 2,9 7,-7 -4,-10 -7),'
                                        '(5 -3,-1 -3),'
                                        '(9 -9,-3 2,-1 -2,7 -1,9 9,-5 3,-8 5,-10 8,-2 -8,9 1))')),
    ST_UNION(
        ST_GEOMFROMTEXT('LINESTRING(-1 -6,-2 9,-9 -5,0 -6,10 -1,-2 3,4 -10)'),
        ST_GEOMFROMTEXT('POINT(2 -1)'))));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_UNION(ST_GEOMFROMTEXT('POINT(7 -8)'),
             ST_GEOMFROMTEXT('MULTILINESTRING((-7 2,3 7,-5 9,-8 -10,-3 10,-8 6,-5 -10,3 -1),(5 6,3 2,9 -1,-7 -7,-10 -7,7 9,-9 2,7 10,-6 6))')),
    ST_UNION(ST_GEOMFROMTEXT('POINT(-9 5)'),
             ST_GEOMFROMTEXT('POLYGON((-7 -4,6 7,10 2,8 6,-2 8,-3 -7,-5 4,-1 10,7 -8,8 9,1 -8))'))));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_SYMDIFFERENCE(
        ST_GEOMFROMTEXT('LINESTRING(3 8,-10 -5,3 5,-2 -9,6 2,-1 6,4 5,-3 3,-1 8,-2 -7,6 10,-1 -2,-1 10)'),
        ST_GEOMFROMTEXT('MULTIPOLYGON(((-5 3,-10 -4,-6 9,7 1,8 -7,-4 -8,-10 3)),'
                                     '((8 -3,-5 -6,-9 9,9 10,-7 -7,6 -10,-1 -3,3 -5,6 2,-8 10,7 -9)),'
                                     '((6 10,-1 0,6 -8,-7 -1,6 -4,-2 7,8 -5,-6 10,9 -3,-1 -5,4 7,8 -3)))')),
    ST_UNION(
        ST_GEOMFROMTEXT('LINESTRING(5 -6,-6 -4,2 -2,4 -10,10 4,-7 4,7 3,1 -6,1 -2,5 -2,-5 8,-7 -2,2 8,3 -3,-7 -4)'),
        ST_GEOMFROMTEXT('MULTIPOINT(4 9,-7 -1,-9 1,-5 -3,8 -6,8 -7,10 5,9 8,-2 -8,3 -2,1 9)'))));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('MULTILINESTRING((-3 9,3 -4,7 9,4 5,2 -6,-2 -1,-6 2))'),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((-3 -8,0 -8,4 -8,0 -3,3 6,6 9,2 1,9 6,1 6,-8 -2,2 5,-1 5,-6 9)))')));

--error ER_BOOST_GEOMETRY_INCONSISTENT_TURNS_EXCEPTION
SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_SYMDIFFERENCE(
        ST_GEOMFROMTEXT('MULTIPOINT(10 -8,-2 6,-6 3,-3 7,7 -3,-8 -9,-3 9,-1 -7)'),
        ST_GEOMFROMTEXT('LINESTRING(-10 0,-4 4,9 5,-7 -8,3 -5,-9 5,0 -6,-9 -4,9 -1,0 -2,-9 4,-7 -8,4 0)')),
    ST_SYMDIFFERENCE(
        ST_GEOMFROMTEXT('MULTILINESTRING((6 -2,4 -9,3 3,0 -10,-10 -1,-4 0,0 1,-2 8,-3 -9),'
                                        '(7 0,10 -7,10 2,-2 9,-2 10,-7 -10,6 5,-3 10,7 6,2 -6,8 9,9 -4,3 -2,3 1))'),
        ST_GEOMFROMTEXT('MULTIPOLYGON(((-1 -1,7 4,1 10)),'
                                     '((-3 -9,2 8,5 6,3 -5,-5 4,-5 -7,-1 -7,3 5,-4 6,9 -4,-5 2,-5 9)))'))));

--echo ######################################################################################################
--echo # BUG#20462962 : ASSERTION `GEOMETRY::IS_VALID_GEOTYPE(GT)' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_INTERSECTION(
    ST_GEOMFROMWKB(GEOMETRYCOLLECTION(
                       MULTIPOINT(POINT(8,-6.0), POINT(9,2), POINT(9,1), POINT(-0,6), POINT(8,6), POINT(4,3), POINT(.7,6)),
                       MULTIPOINT(POINT(8,-0.7654), POINT(2,7), POINT(8,-0.7654), POINT(-.0,7), POINT(.0,6), POINT(.9,+.4), POINT(6,2.232432)),
                       POLYGON(
                           LINESTRING(POINT(8,6), POINT(-.4,3), POINT(-9.8,2.232432), POINT(-1032.34324,8), POINT(2.232432,.8), POINT(8,6))),
                       POLYGON(
                           LINESTRING(POINT(0,9), POINT(3,1), POINT(3,0), POINT(3,2), POINT(0,9))))),
    ST_GEOMFROMTEXT('MULTILINESTRING((-0.7654 2.232432, 7 2, -6 -1032.34324, 9 7, 2.8 4))')));

--echo ######################################################################################################
--echo # BUG#20408240 : ST_DIFFERENCE : ASSERTION `T1->RESULT_RANGE' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_DIFFERENCE(
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTIPOINT(-8 1,-8 1,-10 -3,-10 -1,-9 3),'
                        'POLYGON((8 -7,1 -7,-9 0,9 8,-9 7,-10 -2,5 3,8 -8,-10 0,-3 -8,2 9,-7 4,-2 -8)))'),
    ST_GEOMFROMTEXT('LINESTRING(-7 4,-7 4,9 3,1 -2,-10 2)')));

SELECT ST_ASTEXT(ST_SYMDIFFERENCE(
    ST_GEOMFROMTEXT('POLYGON((-10 -4,7 -3,7 4,-5 8,1 -7))'),
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'MULTIPOINT(6 6,3 -7,6 -10,2 8),'
                        'LINESTRING(0 -4,-2 2,-3 6,2 -3,-10 -4,5 -7,10 -1,-6 -1,7 4,-1 -4,6 0),'
                        'GEOMETRYCOLLECTION('
                            'MULTILINESTRING((8 8,4 8,2 -2,4 0,7 -7,-5 10,-6 -2,-7 -1,-1 5,-3 -1),'
                                            '(-7 10,1 0,-1 7,9 2,-2 6,-1 -1,-1 -1))))')));

--echo ######################################################################################################
--echo # BUG#20141918 : ASSERTION `CUR_SHAPE != GCALC_FUNCTION::SHAPE_POINT' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_DIFFERENCE(
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'POINT(-5 -4),'
                        'POLYGON((-5 1,7 -7,10 0,-10 8,-7 9)))'),
    ST_GEOMFROMTEXT('LINESTRING(5 3,7 -3,5 0,-6 -9,-4 9,-3 -8,10 1,10 -9,5 -3,4 -2,1 -3,-8 -5,4 -7,-2 -8)')));

SELECT ST_ASTEXT(ST_DIFFERENCE(
    ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                        'POINT(1 6),'
                        'GEOMETRYCOLLECTION('
                            'LINESTRING(-9 5,1 -4,-5 4,2 2,-3 7)),'
                        'LINESTRING(9 -4,-4 -10,-8 7,-6 8,-4 4,7 -5,-3 7,5 4,2 -1,8 6,9 5),'
                        'MULTIPOLYGON(((-3 -5,0 -10,6 8)),'
                                     '((1 -2,-6 1,-8 8,9 6,-10 9,7 9))))'),
    ST_GEOMFROMTEXT('MULTILINESTRING((5 -6,0 1,5 -6,5 -8,1 -1,4 -2),'
                                    '(-7 8,1 2,-8 8,10 -9,-2 4,-8 7,-8 -2,7 2,10 4,9 0,0 -2,8 2))')));

--echo ######################################################################################################
--echo # BUG#20106767 : CRASH WITH ST_ISVALID() FUNCTION
--echo ######################################################################################################

SELECT ST_ISVALID(
      ST_GEOMFROMTEXT(
            'GEOMETRYCOLLECTION('
                  'MULTILINESTRING((-7 -2,-9 3,-2 -8),(3 7,5 6,-7 -9,7 -1,-2 -8,2 9,4 6,-5 -5)),'
                  'MULTILINESTRING((2 -2,2 -3,2 -1,-10 7,1 -2,-2 0,-9 -2,10 5,-7 -8,-9 -1,1 -1,-2 3,5 -9,-8 -9,-10 -9)),'
                  'MULTIPOINT(-7 -5,6 9,7 4))'));

--echo ######################################################################################################
--echo # BUG#20112290 : HANG/INFINITE LOOP IN ST_ISVALID() FUNCTION WITH NESTED QUERIES
--echo ######################################################################################################

SELECT ST_ISVALID(
      ST_CONVEXHULL(
            ST_UNION(
                  ST_GEOMFROMTEXT('MULTILINESTRING((1 -4,-4 9,-8 1,2 2,5 1,8 4,-8 3,3 10,-3 -2,0 9),'
                                                  '(-9 10,-10 -8,4 2,-3 -3,-2 3,10 4,2 -7,-1 0,5 6,-9 -10,-7 -6,8 -8,-10 1,8 5,-7 -6),'
                                                  '(2 -4,-5 10,3 -1,6 0))'),
                  ST_GEOMFROMTEXT('POINT(-8 -10)'))));

SELECT ST_ASTEXT(
      ST_UNION(
            ST_GEOMFROMTEXT('MULTILINESTRING((1 -4,-4 9,-8 1,2 2,5 1,8 4,-8 3,3 10,-3 -2,0 9),'
                                            '(-9 10,-10 -8,4 2,-3 -3,-2 3,10 4,2 -7,-1 0,5 6,-9 -10,-7 -6,8 -8,-10 1,8 5,-7 -6),'
                                            '(2 -4,-5 10,3 -1,6 0))'),
            ST_GEOMFROMTEXT('POINT(-8 -10)')));

--echo ######################################################################################################
--echo # BUG#20112707 : ST_VALIDATE() DOES NOT RETURN ANY VALUE WITH VALID GEOMETRY INPUT
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_VALIDATE(ST_GEOMFROMTEXT('POINT(0 0)')));

SELECT ST_ASTEXT(ST_VALIDATE(ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--echo ######################################################################################################
--echo # BUG#20112849 : ST_ISVALID() FUNCTION RETURNS 'FALSE' WITH VALID POLYGON/MULTIPOLYGON INPUT
--echo ######################################################################################################

SELECT ST_ISVALID(ST_GEOMFROMTEXT('POLYGON((0 0,0 5,5 5,5 0,0 0))'));

SELECT ST_ISVALID(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_ISVALID(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)))'));

SELECT ST_ISVALID(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((14 14,14 16,16 16,16 14,14 14)))'));

--echo ######################################################################################################
--echo # BUG#20119431 : ST_ISVALID() FUNCTION RETURNS 'FALSE' WITH VALID GEOMETRYCOLLECTION INPUT
--echo ######################################################################################################

SELECT ST_ISVALID(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0))'));

SELECT ST_ISVALID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0)))'));

SELECT ST_ISVALID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0,0 10))'));

SELECT ST_ISVALID(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'));

--echo ######################################################################################################
--echo # BUG#20135389 : ST_MAKEENVELOPE() RETURNS SAME SET OF SRID VALUES IN THE ERROR MESSAGE
--echo ######################################################################################################

--error ER_WRONG_ARGUMENTS
SELECT ST_ASTEXT(ST_MAKEENVELOPE(ST_GEOMFROMTEXT('POINT(0 1)', 4236), ST_GEOMFROMTEXT('POINT(0 0)', 0)));

--error ER_WRONG_ARGUMENTS
SELECT ST_ASTEXT(ST_MAKEENVELOPE(ST_GEOMFROMTEXT('POINT(0 1)', 1), ST_GEOMFROMTEXT('POINT(0 0)', 0)));

--error ER_WRONG_ARGUMENTS
SELECT ST_ASTEXT(ST_MAKEENVELOPE(ST_GEOMFROMTEXT('POINT(0 1)', 0), ST_GEOMFROMTEXT('POINT(0 0)', 100)));

--echo ######################################################################################################
--echo # BUG#20406722 : ST_ISVALID() DOES NOT PRINT THE FUNCTION NAME IN THE ERROR MESSAGE
--echo ######################################################################################################

--error ER_WRONG_ARGUMENTS
SELECT ST_ISVALID(ST_GEOMFROMTEXT('POINT(0 0)', -1));

--error ER_WRONG_ARGUMENTS
SELECT ST_ISVALID(ST_GEOMFROMTEXT('POINT(0 0)', 1));

--error ER_WRONG_ARGUMENTS
SELECT ST_ISVALID(ST_GEOMFROMTEXT('POINT(0 0)', 1000));

--echo ######################################################################################################
--echo # BUG#20406850 : WL#8034 : CRASH WITH ST_ISVAID() IN ITEM_FUNC_ISVALID::VAL_INT FUNCTION
--echo ######################################################################################################

SET @star_center= 'POINT(15 10)';
SET @star_all_points= 'MULTIPOINT(5 0,25 0,15 10,15 25)';

--error ER_WRONG_ARGUMENTS
SELECT ST_ISVALID(ST_GEOMFROMTEXT(@star_center,-1024));

--error ER_WRONG_ARGUMENTS
SELECT ST_ISVALID(ST_GEOMFROMTEXT(@star_all_points,-1));

--echo ######################################################################################################
--echo # BUG#20414966 : WL#8034 : CRASH WITH ST_VAIDATE() IN ITEM_FUNC_VALIDATE::VAL_STR
--echo ######################################################################################################

SET @star_center= 'POINT(15 10)';
SET @star_all_points= 'MULTIPOINT(5 0,25 0,15 10,15 25)';

--error ER_WRONG_ARGUMENTS
SELECT ST_VALIDATE(ST_GEOMFROMTEXT(@star_center,-1024));

--error ER_WRONG_ARGUMENTS
SELECT ST_VALIDATE(ST_GEOMFROMTEXT(@star_all_points,-1));

--echo ######################################################################################################
--echo # BUG#20430521 : WL#8034 : CRASH WITH ST_SIMPLIFY() IN ITEM_FUNC_SIMPLIFY::VAL_STR
--echo ######################################################################################################

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_ASTEXT(ST_SIMPLIFY(0x000000000200000000000000000000000000000000, 1));

--echo ######################################################################################################
--echo # BUG#20452274 : WL#8034 : SERVER IS HANGING WITH ST_VALIDATE() FUNCTION
--echo ######################################################################################################>>>>

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(
      ST_VALIDATE(
            ST_UNION(
                  ST_GEOMFROMTEXT('MULTIPOLYGON(((-7 -9,-3 7,0 -10,-6 5,10 10,-3 -4,7 9,2 -9)),((1 -10,-3 10,-2 5)))'),
                  ST_GEOMFROMTEXT('POLYGON((6 10,-7 10,-1 -6,0 5,5 4,1 -9,1 3,-10 -7,-10 8))'))));

--echo ######################################################################################################
--echo # BUG#20454073 : ASSERTION `M_GEO_VECT && GET_GEOTYPE() != GEOMETRY::WKB_POLYGON' FAILED
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_SIMPLIFY(ST_GEOMFROMTEXT('MULTIPOINT(19 -4,-2 -6,-8 2)'), 1));

--echo ######################################################################################################
--echo # BUG#20534576 : WL#7929 : ST_BUFFER() : ASSERTION FAILURE IN SPATIAL.H FILE 
--echo ######################################################################################################

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(
      ST_BUFFER(
            ST_GEOMFROMTEXT('MULTILINESTRING((15 0,1 -18,-17 -13),(-10 -1,-5 -4,-15 4,1 -9,-5 1))'),
            61958,
            ST_BUFFER_STRATEGY('join_miter', 199)));

SELECT ST_ISVALID(
      ST_BUFFER(
            ST_GEOMFROMTEXT('MULTILINESTRING((15 0,1 -18,-17 -13),(-10 -1,-5 -4,-15 4,1 -9,-5 1))'),
            61958,
            ST_BUFFER_STRATEGY('join_miter', 199)));

SELECT ST_ISVALID(
	ST_BUFFER(
		ST_SYMDIFFERENCE(
			ST_GEOMFROMTEXT('LINESTRING(-2 0,-17 -11,12 1,-19 -12,-1 0)'),
			ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,-7 -6,11 0,18 13,-14 11,0 0),(6 9,4 -2,-1 3,6 9)))')),
		41751));

# COMMENTED OUT BECAUSE IT TAKES VERY LONG TIME TO FINISH
#SELECT ST_ASTEXT(
#	ST_BUFFER(
#		ST_INTERSECTION(
#			ST_GEOMFROMTEXT('POLYGON((3 5,-18 18,-6 -13,-11 0,-5 -6,3 5)))'),
#			ST_GEOMFROMTEXT('MULTILINESTRING((-6 -16,-11 -7,-5 -14,7 -2,-15 -1,-15 9),(16 -12,5 -14,7 5,4 -2,14 -15),(18 8,13 -12,2 12,8 -19),(8 -7,18 8,-7 1,-7 -7,11 12,-19 -17),(-2 5,-12 12,-11 -1,19 20,8 18,17 -2),(19 8,-7 -16,3 11,19 15,-19 -2,-12 -18))')),
#		79610));

#SELECT ST_ASTEXT(
#	ST_BUFFER(
#		ST_UNION(
#			ST_GEOMFROMTEXT('MULTILINESTRING((1 18, 7 -2, 7 -8, 16 7, -1 -18, -16 19, 8 14), (1 -10, 15 12), (19 10, -17 -7, -1 -10, 15 6, -11 -18, -9 -9), (-4 -2, -15 -15, -3 -17, -16 -8, 18 -8), (2 -19, -10 7, 4 1, 7 -3, 5 3, -6 6, -12 -8, 4 16, 1 -6, -3 -16))'),
#			ST_GEOMFROMTEXT('POLYGON((3 8, -16 8, -11 -18, 11 3, 20 5, 3 8))')),
#		96375));

#SELECT ST_ASTEXT(
#	ST_BUFFER(
#		ST_INTERSECTION(
#			ST_GEOMFROMTEXT('MULTILINESTRING((-15 2, -15 -17, -6 11, 13 9), (-15 0, -8 9, 2 0, 0 19, 10 -16, -14 -19, -12 -12), (0 10, 3 3), (-4 1, -10 -17, -16 -6, -9 7))'),
#			ST_GEOMFROMTEXT('POLYGON((5 5, 9 -4, -7 7, -10 -5, -8 -3, 12 14, 5 5), (6 3, -1 16, -6 -13, 15 0, 0 1, 16 -3, 0 0, 6 3))')),
#		59772));

--echo ######################################################################################################
--echo # BUG#20518038 : WL#7929 : ST_BUFFER() IS PRODUCING NON-CLOSED POLYGONS
--echo ######################################################################################################

--replace_regex /([0-9]*\.[0-9]{2})[0-9]+(e.+)/\1\2/ /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('LINESTRING(0 0,0 1)'), 1));

--echo ######################################################################################################
--echo # BUG#19894465 : WL#7929 : BOOST GEOMETRY BUFFER BUGS
--echo ######################################################################################################

--echo # Scenario 1
SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('LINESTRING(0 0,0 1)'), 1)) > 0;

--replace_regex /([0-9]*\.[0-9]{2})[0-9]+(e.+)/\1\2/ /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('LINESTRING(0 0,0 1)'), 1));

--echo # Scenario 2
SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('LINESTRING(1 1,1 1)'), 1)) > 0;

--error ER_GIS_INVALID_DATA
SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON(1 1,1 1,1 1,1 1)'), 1)) > 0;

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('LINESTRING(1 1,1 1)'), 1));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON(1 1,1 1,1 1,1 1)'), 1));

--echo # Scenario 3
SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0, 0 8, 8 8, 8 10, -10 10, -10 0, 0 0))'), 1)) > 0;

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0, 0 8, 8 8, 8 10, -10 10, -10 0, 0 0))'), 1));

--echo # Scenario 4
SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,10 10,0 8,0 0))'), 1)) > 0;

SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((1 1,10 10,0 8,1 1))'), 1)) > 0;

--replace_regex /([0-9]*\.[0-9]{2})[0-9]+(e.+)/\1\2/ /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,10 10,0 8,0 0))'), 1));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((1 1,10 10,0 8,1 1))'), 1));

--echo # Scenario 5
SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((2 2,2 8,8 8,8 2,2 2))'), 1)) > 0;

SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((2 2,8 2,8 8,2 8,2 2))'), 1)) > 0;

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((2 2,2 8,8 8,8 2,2 2))'), 1));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((2 2,8 2,8 8,2 8,2 2))'), 1));

--echo ######################################################################################################
--echo # BUG#20510010 : ST_BUFFER() : MYSQLD GOT SIGNAL 11
--echo ######################################################################################################

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(
    ST_BUFFER(
        ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                            'MULTILINESTRING((12 -12,-15 19),(2 -9,-4 -8,18 3,-9 -8),(13 11,-15 9,-16 6,-17 5)),'
                            'LINESTRING(14 -16,-3 18,-13 -7,-10 1))'), 6561));

--echo ######################################################################################################
--echo # BUG#20510359 : ST_BUFFER() RETURNS NULL INSTEAD OF AN EMPTY GEOMETRY
--echo ######################################################################################################

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0))'), -10));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0))'), -8));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0))'), -6));

--echo ######################################################################################################
--echo # BUG#20517621 : ASSERTION `GEOMETRY::IS_VALID_GEOTYPE(GT)' FAILED
--echo ######################################################################################################

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_ASTEXT(ST_BUFFER(0x000000000200000000000000000000000000000000, 1));

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_ASTEXT(ST_BUFFER(0x010100000001000000010100000000000000000000, 1));

--error ER_GIS_DATA_WRONG_ENDIANESS
SELECT ST_ASTEXT(ST_BUFFER(0x010100000002000000000000000000000000000000, 1));

--echo ######################################################################################################
--echo # BUG#20558289 : ST_BUFFER() RETURNS EMPTY GEOMETRY WITH [MULTI]LINESTRING GEOMETRY
--echo ######################################################################################################

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('LINESTRING(0 0,10 10,10 0,0 10)'), 20, ST_BUFFER_STRATEGY('end_flat')));

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('MULTILINESTRING((0 0,10 10),(10 0,0 10))'), 50, ST_BUFFER_STRATEGY('end_flat')));

--echo ######################################################################################################
--echo # BUG#20558350 : ST_BUFFER RETURNS INCORRECT RESULT WITH NEGATIVE DISTANCE AND POLYGON WITH HOLE
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'), -5));

SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'), -10));

SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'), -10));

--echo ######################################################################################################
--echo # BUG#20594425 : WL#7929 : HANG/INFINITE LOOP WITH ST_BUFFER() FUNCTION
--echo ######################################################################################################

# COMMENTED OUT BECAUSE IT TAKES LONG TIME TO FINISH (minutes in debug build, and seconds in release build)
#SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('MULTIPOINT(-9 19,9 -6,-4 4,16 -14,-3 16,14 9)'), 6051788, ST_BUFFER_STRATEGY('point_circle', 83585)));

#SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('MULTIPOINT(-2 11,-15 3,6 4,-14 0,20 -7,-17 -1)'), 5666962, ST_BUFFER_STRATEGY('point_circle', 46641)));

#SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('MULTIPOINT(-9 19,9 -6,-4 4,16 -14,-3 16,14 9)'), 6051788, ST_BUFFER_STRATEGY('point_circle', 8358))) > 115058662050000;

#SELECT ST_AREA(ST_BUFFER(ST_GEOMFROMTEXT('MULTIPOINT(-2 11,-15 3,6 4,-14 0,20 -7,-17 -1)'), 5666962, ST_BUFFER_STRATEGY('point_circle', 4664))) > 100891001120000;

--echo ######################################################################################################
--echo # BUG#20558379 : ST_BUFFER() RETURNS AN ERROR WITH VALID GEOMETRYCOLLECTION INPUT
--echo ######################################################################################################

SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)), POLYGON((10 10,10 20,20 20,20 10,10 10)))'), -1));

SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 5,5 5,5 0,0 0)), POLYGON((10 10,10 20,20 20,20 10,10 10)))'), -1));

--echo ######################################################################################################
--echo # BUG#20607166 : SERVER IS HANGING WITH MULTIPOINT GEOMETRY AND '1' AS POINT_PER_CIRCLE' VALUE
--echo ######################################################################################################

--replace_regex /([0-9]+\.[0-9]{4})[0-9]*/\1/
SELECT ST_ASTEXT(ST_BUFFER(ST_GEOMFROMTEXT('MULTIPOINT(5 13,9 -10,12 -7,-1 -16,-18 15,-13 -10,-1 5,12 -7)'), 1, ST_BUFFER_STRATEGY('point_circle',1)));

--echo ######################################################################################################
--echo # BUG#20451555 : ASSERTION FAILED: INDEX >= 0 && UNSIGNED(INDEX) < INFO.COUNT
--echo ######################################################################################################

--error ER_GIS_INVALID_DATA
SELECT ST_DISJOINT(
	ST_GEOMFROMTEXT('LINESTRING(-2305843009213693956 4611686018427387906, -33 -92, 78 83)'),
	ST_GEOMFROMTEXT('MULTILINESTRING((20 100, 31 -97, -46 57, -20 -4),(-71,-4))'));

SELECT ST_DISJOINT(
	ST_GEOMFROMTEXT('LINESTRING(-2305843009213693956 4611686018427387906, -33 -92, 78 83)'),
	ST_GEOMFROMTEXT('LINESTRING(20 100, 31 -97, -46 57, -20 -4)'));
