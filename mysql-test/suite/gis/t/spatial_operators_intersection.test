###############################################################################
#                                                                             #
# This test is aimed to focus on Operators creating Geometry objects.         #
#                                                                             #
# These operators take 2 geometries as input parameters and return            #
# a new geometry object.                                                      #
#                                                                             #
# Creation Date: 2014-02-20                                                   #
# Author : Horst Hunger                                                       #
#                                                                             #
###############################################################################


############################################################################################
# Creating the spatial objects                                                             #
############################################################################################

--echo #Creating the spatial Geometry object
USE test;

CREATE TABLE gis_geometrycollection (fid INTEGER NOT NULL PRIMARY KEY, g GEOMETRY);

############################################################################################
# Inserting the values specific to the spatial objects                                     #
############################################################################################

# Geometric elements constructing a star and some of its elememts as base
SET @star_elem_vertical= 'POLYGON((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal= 'POLYGON((25 0,0 15,30 15,22 10,25 0))';
SET @star_center= 'POINT(15 10)';
SET @star_top= 'POINT(15 25)';
SET @star_bottom_left= 'POINT(5 0)';
SET @star_bottom_right= 'POINT(25 0)';
SET @star_bottom_points= 'MULTIPOINT(5 0,25 0)';
SET @star_all_points= 'MULTIPOINT(5 0,25 0,15 10,15 25)';
SET @star_line_horizontal= 'LINESTRING(10 15,20 15)';
SET @star_line_vertical= 'LINESTRING(15 5,15 25)';
SET @star_top_to_center= 'LINESTRING(15 25,15 10)';
SET @star_lines_near_horizontal= 'MULTILINESTRING((25 0,0 15,15 30,0 5))';
SET @star_lines_near_vertical= 'MULTILINESTRING((0 5,15 25,0 25))';
SET @star= 'POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))';
SET @star_elem_vertical_val= '((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal_val= '((25 0,0 15,30 15,22 10,25 0))';
SET @star_of_elems='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
# star_collection_elems contains at least one invalid geometry.
SET @star_collection_elems='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';
# star_collection_multilinestr contains at least one invalid geometry.
SET @star_collection_multilinestr='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),MULTILINESTRING((25 0,0 15,15 30,0 5)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';

# Star identical to the base star 
SET @star_elem_vertical_1= 'POLYGON((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal_1= 'POLYGON((25 0,0 15,30 15,22 10,25 0))';
SET @star_center_1= 'POINT(15 10)';
SET @star_top_1= 'POINT(15 25)';
SET @star_bottom_left_1= 'POINT(5 0)';
SET @star_bottom_right_1= 'POINT(25 0)';
SET @star_bottom_points_1= 'MULTIPOINT(5 0,25 0)';
SET @star_all_points_1= 'MULTIPOINT(5 0,25 0,15 10,15 25)';
SET @star_line_horizontal_1= 'LINESTRING(10 15,20 15)';
SET @star_line_vertical_1= 'LINESTRING(15 5,15 25)';
SET @star_top_to_center_1= 'LINESTRING(15 25,15 10)';
SET @star_lines_near_horizontal_1= 'MULTILINESTRING((25 0,0 15,15 30,0 5))';
SET @star_lines_near_vertical_1= 'MULTILINESTRING((0 5,15 25,0 25))';
SET @star_1= 'POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))';
SET @star_elem_vertical_val_1= '((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal_val_1= '((25 0,0 15,30 15,22 10,25 0))';
SET @star_of_elems_1='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
SET @star_collection_elems_1='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';

# Star like the base star, but shifted to right by 10 on X to overlap base star
SET @star_elem_vertical_2= 'POLYGON((15 0,25 25,35 0,25 5,15 0))';
SET @star_elem_horizontal_2= 'POLYGON((35 0,10 15,40 15,32 10,35 0))';
SET @star_center_2= 'POINT(25 10)';
SET @star_top_2= 'POINT(25 25)';
SET @star_bottom_left_2= 'POINT(15 0)';
SET @star_bottom_right_2= 'POINT(35 0)';
SET @star_bottom_points_2= 'MULTIPOINT(15 0,35 0)';
SET @star_all_points_2= 'MULTIPOINT(15 0,35 0,35 10,25 25)';
SET @star_line_horizontal_2= 'LINESTRING(20 15,30 15)';
SET @star_line_vertical_2= 'LINESTRING(25 5,25 25)';
SET @star_top_to_center_2= 'LINESTRING(25 25,25 10)';
SET @star_lines_near_horizontal_2= 'MULTILINESTRING((35 0,10 15,25 30,10 5))';
SET @star_lines_near_vertical_2= 'MULTILINESTRING((10 5,25 25,10 25))';
SET @star_2= 'POLYGON((15 0,17 10,10 15,20 15,25 25,30 15,40 15,32 10,35 0,25 5,15 0))';
SET @star_elem_vertical_val_2= '((15 0,25 25,35 0,25 5,15 0))';
SET @star_elem_horizontal_val_2= '((35 0,10 15,40 15,32 10,35 0))';
SET @star_of_elems_2='MULTIPOLYGON(((15 0,25 25,35 0,25 5,15 0)),((35 0,10 15,40 15,32 10,35 0)))';
SET @star_collection_elems_2='GEOMETRYCOLLECTION(MULTIPOLYGON(((15 0,25 25,35 0,25 5,15 0)),((35 0,10 15,40 15,32 10,35 0))),POLYGON((15 0,17 10,10 15,20 15,25 25,30 15,40 15,32 10,35 0,25 5,15 0)),LINESTRING(25 25,25 10),MULTIPOINT(15 0,35 0),POINT(25 25))';

# Star like the base star, but shifted to right by 60 on X to be completly separate
SET @star_elem_vertical_3= 'POLYGON((65 0,75 25,85 0,75 5,65 0))';
SET @star_elem_horizontal_3= 'POLYGON((85 0,60 15,90 15,82 10,85 0))';
SET @star_center_3= 'POINT(75 10)';
SET @star_top_3= 'POINT(75 25)';
SET @star_bottom_left_3= 'POINT(65 0)';
SET @star_bottom_right_3= 'POINT(85 0)';
SET @star_bottom_points_3= 'MULTIPOINT(65 0,85 0)';
SET @star_all_points_3= 'MULTIPOINT(65 0,85 0,75 10,75 25)';
SET @star_line_horizontal_3= 'LINESTRING(70 15,80 15)';
SET @star_line_vertical_3= 'LINESTRING(75 5,75 25)';
SET @star_top_to_center_3= 'LINESTRING(75 25,75 10)';
SET @star_lines_near_horizontal_3= 'MULTILINESTRING((85 0,60 15,85 30,60 5))';
SET @star_lines_near_vertical_3= 'MULTILINESTRING((60 5,75 25,60 25))';
SET @star_3= 'POLYGON((65 0,67 10,60 15,70 15,75 25,80 15,90 15,82 10,85 0,75 5,65 0))';
SET @star_elem_vertical_val_3= '((65 0,75 25,85 0,75 5,65 0))';
SET @star_elem_horizontal_val_3= '((85 0,60 15,90 15,82 10,85 0))';
SET @star_of_elems_3='MULTIPOLYGON(((65 0,75 25,85 0,75 5,65 0)),((85 0,60 15,90 15,82 10,85 0)))';
SET @star_collection_elems_3='GEOMETRYCOLLECTION(MULTIPOLYGON(((65 0,75 25,85 0,75 5,65 0)),((85 0,60 15,90 15,82 10,85 0))),POLYGON((65 0,67 10,60 15,70 15,75 25,80 15,90 15,82 10,85 0,75 5,65 0)),LINESTRING(75 25,75 10),MULTIPOINT(65 0,85 0),POINT(75 25))';

--echo #INSERT base star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (100,ST_GEOMFROMTEXT(@star)),
 (101,ST_GEOMFROMTEXT(@star_elem_vertical)),
 (102,ST_GEOMFROMTEXT(@star_elem_horizontal)),
 (103,ST_GEOMFROMTEXT(@star_of_elems)),
 (104,ST_GEOMFROMTEXT(@star_top)),
 (105,ST_GEOMFROMTEXT(@star_center)),
 (106,ST_GEOMFROMTEXT(@star_bottom_left)),
 (107,ST_GEOMFROMTEXT(@star_bottom_right)),
 (108,ST_GEOMFROMTEXT(@star_bottom_points)),
 (109,ST_GEOMFROMTEXT(@star_all_points)),
 (110,ST_GEOMFROMTEXT(@star_line_horizontal)),
 (111,ST_GEOMFROMTEXT(@star_line_vertical)),
 (112,ST_GEOMFROMTEXT(@star_top_to_center)),
 (113,ST_GEOMFROMTEXT(@star_lines_near_horizontal)),
 (114,ST_GEOMFROMTEXT(@star_lines_near_vertical)),
 (115,ST_GEOMFROMTEXT(@star_collection_elems));
--enable_warnings

--echo #INSERT identical (to base) star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (200,ST_GEOMFROMTEXT(@star_1)),
 (201,ST_GEOMFROMTEXT(@star_elem_vertical_1)),
 (202,ST_GEOMFROMTEXT(@star_elem_horizontal_1)),
 (203,ST_GEOMFROMTEXT(@star_of_elems_1)),
 (204,ST_GEOMFROMTEXT(@star_top_1)),
 (205,ST_GEOMFROMTEXT(@star_center_1)),
 (206,ST_GEOMFROMTEXT(@star_bottom_left_1)),
 (207,ST_GEOMFROMTEXT(@star_bottom_right_1)),
 (208,ST_GEOMFROMTEXT(@star_bottom_points_1)),
 (209,ST_GEOMFROMTEXT(@star_all_points_1)),
 (210,ST_GEOMFROMTEXT(@star_line_horizontal_1)),
 (211,ST_GEOMFROMTEXT(@star_line_vertical_1)),
 (212,ST_GEOMFROMTEXT(@star_top_to_center_1)),
 (213,ST_GEOMFROMTEXT(@star_lines_near_horizontal_1)),
 (214,ST_GEOMFROMTEXT(@star_lines_near_vertical_1)),
 (215,ST_GEOMFROMTEXT(@star_collection_elems_1));
--enable_warnings

--echo #INSERT overlapping star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (300,ST_GEOMFROMTEXT(@star_2)),
 (301,ST_GEOMFROMTEXT(@star_elem_vertical_2)),
 (302,ST_GEOMFROMTEXT(@star_elem_horizontal_2)),
 (303,ST_GEOMFROMTEXT(@star_of_elems_2)),
 (304,ST_GEOMFROMTEXT(@star_top_2)),
 (305,ST_GEOMFROMTEXT(@star_center_2)),
 (306,ST_GEOMFROMTEXT(@star_bottom_left_2)),
 (307,ST_GEOMFROMTEXT(@star_bottom_right_2)),
 (308,ST_GEOMFROMTEXT(@star_bottom_points_2)),
 (309,ST_GEOMFROMTEXT(@star_all_points_2)),
 (310,ST_GEOMFROMTEXT(@star_line_horizontal_2)),
 (311,ST_GEOMFROMTEXT(@star_line_vertical_2)),
 (312,ST_GEOMFROMTEXT(@star_top_to_center_2)),
 (313,ST_GEOMFROMTEXT(@star_lines_near_horizontal_2)),
 (314,ST_GEOMFROMTEXT(@star_lines_near_vertical_2)),
 (315,ST_GEOMFROMTEXT(@star_collection_elems_2));
--enable_warnings

--echo #INSERT separate star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (400,ST_GEOMFROMTEXT(@star_3)),
 (401,ST_GEOMFROMTEXT(@star_elem_vertical_3)),
 (402,ST_GEOMFROMTEXT(@star_elem_horizontal_3)),
 (403,ST_GEOMFROMTEXT(@star_of_elems_3)),
 (404,ST_GEOMFROMTEXT(@star_top_3)),
 (405,ST_GEOMFROMTEXT(@star_center_3)),
 (406,ST_GEOMFROMTEXT(@star_bottom_left_3)),
 (407,ST_GEOMFROMTEXT(@star_bottom_right_3)),
 (408,ST_GEOMFROMTEXT(@star_bottom_points_3)),
 (409,ST_GEOMFROMTEXT(@star_all_points_3)),
 (410,ST_GEOMFROMTEXT(@star_line_horizontal_3)),
 (411,ST_GEOMFROMTEXT(@star_line_vertical_3)),
 (412,ST_GEOMFROMTEXT(@star_top_to_center_3)),
 (413,ST_GEOMFROMTEXT(@star_lines_near_horizontal_3)),
 (414,ST_GEOMFROMTEXT(@star_lines_near_vertical_3)),
 (415,ST_GEOMFROMTEXT(@star_collection_elems_3));
--enable_warnings

CREATE TABLE gis_geometrycollection_2 SELECT fid as fid2,g as g2 FROM gis_geometrycollection;

--echo #Checking the integrity of the above create/insert statements 

--echo #64 rows. 
SELECT count(ST_ASTEXT(g) != 'NULL') FROM gis_geometrycollection;
--echo #64 rows. 
SELECT count(ST_ASTEXT(g2) != 'NULL') FROM gis_geometrycollection_2;

############################################################################################
# Checking the spatial operator functions                                                  #
############################################################################################

--echo #####################################################################################
--echo # ST_INTERSECTION(g1,g2)
--echo #####################################################################################
--echo #====================================================================================
--echo # point,point
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_center),ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('POINT(15 10)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('POINT(15 10)')) FROM gis_geometrycollection WHERE fid=105;

--echo #====================================================================================
--echo # point,multipoint
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_bottom_left),ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('POINT(5 0)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_center),ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('POINT(5 0)')) FROM gis_geometrycollection WHERE fid=106;

--echo #====================================================================================
--echo # point,linestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_bottom_left),ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=104;

--echo #====================================================================================
--echo # point,multilinestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_center),ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=104;

--echo #====================================================================================
--echo # point,polygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top_3),ST_GEOMFROMTEXT(@star)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=104;

--echo #====================================================================================
--echo # point,multipolygon
--echo #====================================================================================
--echo #====================================================================================
--echo # point,geometrycollection
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top_3),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=104;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_collection_multilinestr)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(0 0)),GEOMETRYCOLLECTION())')),ST_GEOMFROMTEXT('POINT(0 0)'));

--echo #====================================================================================
--echo # multipoint,point
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_top)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_bottom_points),ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_bottom_left)),ST_GEOMFROMTEXT('POINT(5 0)')) FROM gis_geometrycollection WHERE fid=108;

--echo #====================================================================================
--echo # multipoint,multipoint
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_bottom_points),ST_GEOMFROMTEXT(@star_all_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_all_points_1)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_all_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(25 0))')) FROM gis_geometrycollection WHERE fid=108;

--echo #====================================================================================
--echo # multipoint,linestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(15 25))')) FROM gis_geometrycollection WHERE fid=109;

--echo #====================================================================================
--echo # multipoint,multilinestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_lines_near_horizontal)),ST_GEOMFROMTEXT('POINT(25 0)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_lines_near_horizontal)),ST_GEOMFROMTEXT('POINT(25 0)')) FROM gis_geometrycollection WHERE fid=109;

--echo #====================================================================================
--echo # multipoint,polygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_elem_horizontal)),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_elem_horizontal)),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(25 0))')) FROM gis_geometrycollection WHERE fid=109;

--echo #====================================================================================
--echo # multipoint,multipolygon
--echo #====================================================================================
--echo #====================================================================================
--echo # multipoint,geometrycollection
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOINT(0 0,0 30,30 25)'),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))')) FROM gis_geometrycollection WHERE fid=109;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_collection_multilinestr)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOINT(0 0,10 10)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOINT(0 0,10 10)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(0 0)),'
                                                                                              'GEOMETRYCOLLECTION())')),ST_GEOMFROMTEXT('POINT(0 0)'));

--echo #====================================================================================
--echo # linestring,point
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top_to_center),ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('POINT(15 10)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING(15 25,15 10)'),ST_GEOMFROMTEXT('POINT(15 10)')),ST_GEOMFROMTEXT('POINT(15 10)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top_to_center),ST_GEOMFROMTEXT(@star_bottom_left)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,g2),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY')) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=110 and fid2=105;

--echo #====================================================================================
--echo # linestring,multipoint
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_vertical),ST_GEOMFROMTEXT('MULTIPOINT(15 10,15 25)')),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_vertical),ST_GEOMFROMTEXT(@star_all_points)),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT('MULTIPOINT(15 10,15 25)')),ST_GEOMFROMTEXT('MULTIPOINT((15 10),(15 25))')) FROM gis_geometrycollection WHERE fid=111;

--echo #====================================================================================
--echo # linestring,linestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_vertical),ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('LINESTRING(15 10,15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top_to_center),ST_GEOMFROMTEXT(@star_line_vertical)),ST_GEOMFROMTEXT('LINESTRING(15 25,15 10)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top_to_center),ST_GEOMFROMTEXT(@star_top_to_center_1)),ST_GEOMFROMTEXT('LINESTRING(15 25,15 10)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('LINESTRING(15 10,15 25)')) FROM gis_geometrycollection WHERE fid=111;

--echo #====================================================================================
--echo # linestring,multilinestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_lines_near_horizontal)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_lines_near_horizontal)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY')) FROM gis_geometrycollection WHERE fid=110;

--echo #====================================================================================
--echo # linestring,polygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT('POLYGON((11 15,19 15,19 10,11 15))')),ST_GEOMFROMTEXT('LINESTRING(11 15,19 15)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_elem_horizontal)),ST_GEOMFROMTEXT('LINESTRING(10 15,20 15)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT('POLYGON((11 15,19 15,19 10,11 15))')),ST_GEOMFROMTEXT('LINESTRING(11 15,19 15)')) FROM gis_geometrycollection WHERE fid=110;

--echo #====================================================================================
--echo # linestring,multipolygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT('MULTIPOLYGON(((11 15,19 15,19 25,11 15)))')),ST_GEOMFROMTEXT('LINESTRING(11 15,19 15)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT('MULTIPOLYGON(((11 15,19 15,19 25,11 15)),((25 0,0 15,25 10,25 0)))')),ST_GEOMFROMTEXT('LINESTRING(11 15,19 15)')) FROM gis_geometrycollection WHERE fid=110;

--echo #====================================================================================
--echo # linestring,geometrycollectionn
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_collection_elems_3)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                                                                              'GEOMETRYCOLLECTION(POLYGON((5 5,15 5,15 15,5 5))))')),ST_GEOMFROMTEXT('LINESTRING(5 5,10 10)'));

--echo #====================================================================================
--echo # multilinestring,point
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_top)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_top)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=114;

--echo #====================================================================================
--echo # multilinestring,multipoint
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_all_points)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY')) FROM gis_geometrycollection WHERE fid=114;

SELECT ST_EQUALS(ST_INTERSECTION(g,g2),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY')) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=114 and fid2=108;

--echo #====================================================================================
--echo # multilinestring,linestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_line_vertical)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_line_horizontal)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_line_vertical)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=114;

--echo #====================================================================================
--echo # multilinestring,multilinestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT('MULTILINESTRING((0 5,15 25,0 15))')),ST_GEOMFROMTEXT('LINESTRING(0 5,15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_lines_near_horizontal)),ST_GEOMFROMTEXT('MULTIPOINT((0 5),(5.172413793103448 11.89655172413793),(10 25),(12 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT('MULTILINESTRING((0 5,15 25,0 15))')),ST_GEOMFROMTEXT('LINESTRING(0 5,15 25)')) FROM gis_geometrycollection WHERE fid=114;

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_line_vertical)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=114;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTILINESTRING((0 0, 1 1), (10 10, 11 11), (20 20, 21 21))'),
ST_GEOMFROMTEXT('MULTILINESTRING((0 0, 1 1), (10 10, 11 11), (20 20, 19 19))')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(20 20),MULTILINESTRING((0 0,1 1),(10 10,11 11)))'));

--echo #====================================================================================
--echo # multilinestring,polygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_elem_horizontal)),ST_GEOMFROMTEXT('LINESTRING(5.172413793103448 11.89655172413793,7.5 15)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=114;

--echo #====================================================================================
--echo # multilinestring,multipolygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTILINESTRING((0 25,25 0,25 30))'),ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('LINESTRING(10.714285714285715 14.285714285714286,25 0)'));

--echo #====================================================================================
--echo # multilinestring,geometrycollection
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTILINESTRING((0 25,25 0,25 30))'),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('MULTILINESTRING((10 15,25 0),(25 11.875,25 15))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTILINESTRING((4.883720930232558 11.511627906976745,7.5 15)),POINT(15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTILINESTRING((4.883720930232558 11.511627906976745,7.5 15)),POINT(15 25))')) FROM gis_geometrycollection WHERE fid=114;

# geometry @star_collection_multilinestr is invalid
#SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_lines_near_horizontal),ST_GEOMFROMTEXT(@star_collection_multilinestr)),ST_GEOMFROMTEXT('MULTILINESTRING((25 0,0 15),(6 15,4.2 12),(0 15,15 30,6 15),(4.2 12,0 5))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTILINESTRING((0 0,10 10),(5 5,15 15))'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTILINESTRING((0 0,10 10))'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                                                                                     'GEOMETRYCOLLECTION(POLYGON((5 5,15 5,15 15,5 5))))')),ST_GEOMFROMTEXT('LINESTRING(5 5,10 10)'));

--echo #====================================================================================
--echo # polygon,point
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('POINT(15 10)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT('POINT(0 0)')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_center)),ST_GEOMFROMTEXT('POINT(15 10)')) FROM gis_geometrycollection WHERE fid=100;

--echo #====================================================================================
--echo # polygon,multipoint
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_all_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT('MULTIPOINT(0 0,30 25)')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_all_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))')) FROM gis_geometrycollection WHERE fid=100;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_all_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(15 10),(15 25),(25 0))'));

--echo #====================================================================================
--echo # polygon,linestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_line_vertical)),ST_GEOMFROMTEXT('LINESTRING(15 5,15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star_line_horizontal)),ST_GEOMFROMTEXT('LINESTRING(11 15,19 15)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_line_vertical)),ST_GEOMFROMTEXT('LINESTRING(15 5,15 25)')) FROM gis_geometrycollection WHERE fid=100;

SELECT ST_EQUALS(ST_INTERSECTION(g,g2),ST_GEOMFROMTEXT('LINESTRING(15 5,15 25)')) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=100 and fid2=111;

--echo #====================================================================================
--echo # polygon,multilinestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTILINESTRING((4.883720930232558 11.511627906976745,7.5 15)),POINT(15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star_lines_near_horizontal)),ST_GEOMFROMTEXT('LINESTRING(25 0,8.870967741935484 9.67741935483871)'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTILINESTRING((4.883720930232558 11.511627906976745,7.5 15)),POINT(15 25))')) FROM gis_geometrycollection WHERE fid=100;

--echo #====================================================================================
--echo # polygon,polygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('POLYGON((15 25,5 0,15 5,25 0,15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star)),ST_GEOMFROMTEXT('POLYGON((15 25,5 0,15 5,25 0,15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('POLYGON((15 25,5 0,15 5,25 0,15 25))')) FROM gis_geometrycollection WHERE fid=100;

--echo #====================================================================================
--echo # polygon,multipolygon
--echo #====================================================================================
--echo #====================================================================================
--echo # polygon,geomertycollection
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_collection_elems_3)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))')) FROM gis_geometrycollection WHERE fid=100;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_collection_multilinestr)),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((0 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((5 5,15 5,15 15,5 5)))')),ST_GEOMFROMTEXT('POLYGON((10 10,5 5,10 5,10 10))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION('
                                                                                                                         'POLYGON((4 4,4 6,6 6,6 4,4 4)))')),ST_GEOMFROMTEXT('LINESTRING(4 4,4 6,6 6,6 4,4 4)'));

--echo #====================================================================================
--echo # multipolygon,point
--echo #====================================================================================
--echo #====================================================================================
--echo # multipolygon,multipoint
--echo #====================================================================================
--echo #====================================================================================
--echo # multipolygon,linestring
--echo #====================================================================================
--echo #====================================================================================
--echo # multipolygon,multilinestring
--echo #====================================================================================
--echo #====================================================================================
--echo # multipolygon,polygon
--echo #====================================================================================
--echo #====================================================================================
--echo # multipolygon,multipolygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)),((5 5,5 10,10 10,10 5,5 5)))'),
ST_GEOMFROMTEXT('MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3)),((9 9,9 15,15 15,15 9,9 9)))')),ST_GEOMFROMTEXT('MULTIPOLYGON(((3 5,3 3,5 3,5 5,3 5)),((5 7,5 5,7 5,7 7,5 7)),((9 10,9 9,10 9,10 10,9 10)))'));

--echo #====================================================================================
--echo # multipolygon,geometrycollectionn
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(g,g2),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))')) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=115 and fid2=115;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,10 10,10 0,0 0)))'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)))'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((5 5,15 5,15 15,5 5)))')),ST_GEOMFROMTEXT('POLYGON((10 10,5 5,10 5,10 10))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)),((4 4,4 6,6 6,6 4,4 4)))'),
ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((4 4,4 6,6 6,6 4,4 4)))')),ST_GEOMFROMTEXT('POLYGON((4 6,4 4,6 4,6 6,4 6))'));

--echo #====================================================================================
--echo # geometrycollection,point
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_top)),ST_GEOMFROMTEXT('POINT(15 25)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('POINT(30 30)')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_top)),ST_GEOMFROMTEXT('POINT(15 25)')) FROM gis_geometrycollection WHERE fid=115;

--echo #====================================================================================
--echo # geometrycollection,multipoint
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(25 0))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('MULTIPOINT(30 30,0 35)')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_bottom_points)),ST_GEOMFROMTEXT('MULTIPOINT((5 0),(25 0))')) FROM gis_geometrycollection WHERE fid=115;

--echo #====================================================================================
--echo # geometrycollection,linestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('LINESTRING(15 25,15 10)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('LINESTRING(30 30,0 35)')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_top_to_center)),ST_GEOMFROMTEXT('LINESTRING(15 25,15 10)')) FROM gis_geometrycollection WHERE fid=115;

--echo #====================================================================================
--echo # geometrycollection,multilinestring
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTILINESTRING((4.883720930232558 11.511627906976745,7.5 15)),POINT(15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('MULTILINESTRING((0 30,30 30,0 35))')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTILINESTRING((4.883720930232558 11.511627906976745,7.5 15)),POINT(15 25))')) FROM gis_geometrycollection WHERE fid=115;

--echo #====================================================================================
--echo # geometrycollection,polygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star)),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('POLYGON((15 25,5 0,15 5,25 0,15 25))')) FROM gis_geometrycollection WHERE fid=115;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_elem_vertical)),ST_GEOMFROMTEXT('POLYGON((15 25,5 0,15 5,25 0,15 25))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('POLYGON((0 0,15 25,35 0,0 0))')),ST_GEOMFROMTEXT('POLYGON((6.3 10.5,7 10,5 0,15 5,25 0,22 10,25.333333333333332 12.083333333333334,23 15,20 15,15 25,10 15,9 15,6.3 10.5))'));

--echo #====================================================================================
--echo # geometrycollection,multipolygon
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 5,5 5,0 0)))')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(g,ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))')) FROM gis_geometrycollection WHERE fid=115;

SELECT ST_EQUALS(ST_INTERSECTION(g,g2),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))')) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=115 and fid2=215;

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0),LINESTRING(3 3,6 6))'),
ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)),((5 5,5 10,10 10,10 5,5 5)))')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0),MULTILINESTRING((3 3,5 5),(5 5,6 6)))'));

--echo #====================================================================================
--echo # geometrycollection,geometrycollectionn
--echo #====================================================================================
SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_collection_elems_3)),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_multilinestr),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_collection_elems)),ST_GEOMFROMTEXT('POLYGON((7 10,5 0,15 5,25 0,22 10,30 15,20 15,15 25,10 15,0 15,7 10))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0),LINESTRING(1 1,2 2))'),
ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0),POINT(5 5))')),ST_GEOMFROMTEXT('POINT(0 0)'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(2 2),POLYGON((0 0,0 5,5 5,5 0,0 0)))'),
ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(0 0,5 5))')),ST_GEOMFROMTEXT('MULTIPOINT((0 0),(5 5))'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'),
ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())))')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

SELECT ST_EQUALS(ST_INTERSECTION(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'),
ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(1 1), GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())))')),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION EMPTY'));

--echo #####################################################################################
--echo # Testing ST_INTERSECTION() with 2 geometries of same SRID
--echo #####################################################################################
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,0),ST_GEOMFROMTEXT(@star_center,0)));

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,4145),ST_GEOMFROMTEXT(@star_center,4145)));

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,2000),ST_GEOMFROMTEXT(@star_center,2000)));

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,4135),ST_GEOMFROMTEXT(@star_center,4135)));

--error ER_DATA_OUT_OF_RANGE
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,-1),ST_GEOMFROMTEXT(@star_center,-1)));

--error ER_DATA_OUT_OF_RANGE
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,-1024),ST_GEOMFROMTEXT(@star_center,-1024)));

--error ER_DATA_OUT_OF_RANGE
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,4294967295000),ST_GEOMFROMTEXT(@star_center,4294967295000)));

--echo #####################################################################################
--echo # Invalid function calls
--echo #####################################################################################
--error ER_GIS_DIFFERENT_SRIDS
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_center,4326)));

--error ER_GIS_DIFFERENT_SRIDS
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,4145),ST_GEOMFROMTEXT(@star_center,4326)));

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,0),ST_GEOMFROMTEXT(@star_center,0)));

--error ER_DATA_OUT_OF_RANGE
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_top,-1),ST_GEOMFROMTEXT(@star_center,-1)));

SELECT ST_ASTEXT(ST_INTERSECTION(NULL,ST_GEOMFROMTEXT(@star_top)));

--echo # Invalid geometry in input
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_of_elems),NULL));

--echo # Invalid geometry in input
SELECT ST_ASTEXT(ST_INTERSECTION(g,NULL)) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

SELECT ST_ASTEXT(ST_INTERSECTION(NULL,NULL));

--echo # Invalid geometry in input
SELECT ST_ASTEXT(ST_INTERSECTION(fid,NULL)) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--echo # Invalid geometry in input
--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(fid,ST_GEOMFROMTEXT(@star_top))) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--echo # Invalid geometry in input
--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_of_elems),fid)) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(a 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(! 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_PARSE_ERROR
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT('!' 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(12,34 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING(a 0,10 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING(0 0,! 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_PARSE_ERROR
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING('!' 0,10 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('LINESTRING(12,34 0,10 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((a 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((0 0,! 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_PARSE_ERROR
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON(('!' 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((12,34 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((12,34 0,10 10,10 0,0 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((0 0,10 10,0 0))'),ST_GEOMFROMTEXT('MULTILINESTRING((0 0,0 10,10 10,0 0))')));

--error ER_GIS_INVALID_DATA
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('MULTILINESTRING((34 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,10 10,0 0)))')));

--error ER_PARSE_ERROR
SELECT ST_ASTEXT(ST_INTERSECTION(,));

--echo # Invalid geometry in input
--error ER_PARSE_ERROR
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_of_elems),));

--error ER_PARSE_ERROR
SELECT ST_ASTEXT(ST_INTERSECTION(,ST_GEOMFROMTEXT(@star_top)));

SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star_collection_elems)));

# Test with all combinations of geometry types, including types inside
# geometry collections. These queries are for coverage of code
# paths. The results have not been verified.

CREATE TABLE t1 (pk INT PRIMARY KEY, g GEOMETRY NOT NULL);

INSERT INTO t1 VALUES (1, ST_GEOMFROMTEXT('POINT(1 1)'));
INSERT INTO t1 VALUES (2, ST_GEOMFROMTEXT('LINESTRING(1 1, 2 2)'));
INSERT INTO t1 VALUES (3, ST_GEOMFROMTEXT(
  'POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))'));
INSERT INTO t1 VALUES (4, ST_GEOMFROMTEXT(
  'POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (4 4, 4 6, 6 6, 6 4, 4 4))'));
INSERT INTO t1 VALUES (5, ST_GEOMFROMTEXT('MULTIPOINT(1 1, 2 2)'));
INSERT INTO t1 VALUES (6, ST_GEOMFROMTEXT('MULTILINESTRING((1 1, 2 2),'
  '(3 3, 4 4))'));
INSERT INTO t1 VALUES (7, ST_GEOMFROMTEXT(
  'MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)),((5 5, 10 5, 10 10, 5 10, 5 5)))'));
INSERT INTO t1 VALUES (8, ST_GEOMFROMTEXT(
  'MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)), ((5 5, 10 5, 10 10, 5 10, 5 5), '
  '(6 6, 6 7, 7 7, 7 6, 6 6)))'));
INSERT INTO t1 VALUES (9, ST_GEOMFROMTEXT(
  'MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)), ((1 1, 10 1, 10 10, 1 10, 1 1), '
  '(4 4, 4 6, 6 6, 6 4, 4 4)))'));
INSERT INTO t1 VALUES (10, ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(1 1))'));
INSERT INTO t1 VALUES (11, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(LINESTRING(1 1, 2 2))'));
INSERT INTO t1 VALUES (12, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(POLYGON((0 0, 1 0, 1 1, 0 1, 0 0)))'));
INSERT INTO t1 VALUES (13, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), '
  '(4 4, 4 6, 6 6, 6 4, 4 4)))'));
INSERT INTO t1 VALUES (14, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(MULTIPOINT(1 1, 2 2))'));
INSERT INTO t1 VALUES (15, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(MULTILINESTRING((1 1, 2 2), (3 3, 4 4)))'));
INSERT INTO t1 VALUES (16, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)), '
  '((5 5, 10 5, 10 10, 5 10, 5 5))))'));
INSERT INTO t1 VALUES (17, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)), '
  '((5 5, 10 5, 10 10, 5 10, 5 5), (6 6, 6 7, 7 7, 7 6, 6 6))))'));
INSERT INTO t1 VALUES (18, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)), '
  '((1 1, 10 1, 10 10, 1 10, 1 1), (4 4, 4 6, 6 6, 6 4, 4 4))))'));
INSERT INTO t1 VALUES (19, ST_GEOMFROMTEXT(
  'GEOMETRYCOLLECTION(POINT(1 1),LINESTRING(1 1, 2 2),'
  'POLYGON((0 0, 1 0, 1 1, 0 1, 0 0)),'
  'POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (4 4, 4 6, 6 6, 6 4, 4 4)),'
  'MULTIPOINT(1 1, 2 2),MULTILINESTRING((1 1, 2 2), (3 3, 4 4)),'
  'MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)), ((5 5, 10 5, 10 10, 5 10, 5 5))),'
  'MULTIPOLYGON(((0 0, 1 0, 1 1, 0 1, 0 0)), ((5 5, 10 5, 10 10, 5 10, 5 5), '
  '(6 6, 7 6, 7 7, 6 7, 6 6))))'));
INSERT INTO t1 VALUES(20,
  GEOMETRYCOLLECTION(POINT(1,1),LINESTRING(POINT(1,1),POINT(2,2)),
  POLYGON(LINESTRING(POINT(0,0),POINT(1,0),POINT(1,1),POINT(0,1),POINT(0,0))),
  POLYGON(LINESTRING(POINT(0,0),POINT(10,0),POINT(10,10),POINT(0,10),
  POINT(0,0)),LINESTRING(POINT(4,4),POINT(6,4),POINT(6,6),POINT(4,6),
  POINT(4,4))),MULTIPOINT(POINT(1,1),POINT(2,2)),
  MULTILINESTRING(LINESTRING(POINT(1,1),POINT(2,2)),LINESTRING(POINT(3,3),
  POINT(4,4))),MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0),POINT(1,0),POINT(1,1),
  POINT(0,1),POINT(0,0))),POLYGON(LINESTRING(POINT(5,5),POINT(10,5),
  POINT(10,10),POINT(5,10),POINT(5,5)))),
  MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0),POINT(1,0),POINT(1,1),POINT(0,1),
  POINT(0,0))),POLYGON(LINESTRING(POINT(5,5),POINT(10,5),POINT(10,10),
  POINT(5,10),POINT(5,5)),LINESTRING(POINT(6,6),POINT(6,7),POINT(7,7),
  POINT(7,6),POINT(6,6)))),GEOMETRYCOLLECTION(POINT(1,1)),
  GEOMETRYCOLLECTION(LINESTRING(POINT(1,1),POINT(2,2))),
  GEOMETRYCOLLECTION(POLYGON(LINESTRING(POINT(0,0),POINT(1,0),POINT(1,1),
  POINT(0,1),POINT(0,0)))),GEOMETRYCOLLECTION(POLYGON(LINESTRING(POINT(0,0),
  POINT(10,0),POINT(10,10),POINT(0,10),POINT(0,0)),LINESTRING(POINT(4,4),
  POINT(4,6),POINT(6,6),POINT(6,6),POINT(4,4)))),
  GEOMETRYCOLLECTION(MULTIPOINT(POINT(1,1),POINT(2,2))),
  GEOMETRYCOLLECTION(MULTILINESTRING(LINESTRING(POINT(1,1),POINT(2,2)),
  LINESTRING(POINT(3,3),POINT(4,4)))),
  GEOMETRYCOLLECTION(MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0),POINT(1,0),
  POINT(1,1),POINT(0,1),POINT(0,0))),POLYGON(LINESTRING(POINT(5,5),POINT(10,5),
  POINT(10,10),POINT(5,10),POINT(5,5))))),
  GEOMETRYCOLLECTION(MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0),POINT(1,0),
  POINT(1,1),POINT(0,1),POINT(0,0))),POLYGON(LINESTRING(POINT(5,5),POINT(10,5),
  POINT(10,10),POINT(5,10),POINT(5,5)),LINESTRING(POINT(6,6),POINT(6,7),
  POINT(7,7),POINT(7,6),POINT(6,6)))))));
INSERT INTO t1 VALUES (21,
  GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(1,1)),
  GEOMETRYCOLLECTION(LINESTRING(POINT(1,1),POINT(2,2))),
  GEOMETRYCOLLECTION(POLYGON(LINESTRING(POINT(1,1), POINT(10,1), POINT(10,10),
  POINT(1,10), POINT(1,1)), LINESTRING(POINT(4,4),POINT(4,6),POINT(6,6),
  POINT(6,4),POINT(4,4))))));

CREATE TABLE intersection_results (pk INT PRIMARY KEY AUTO_INCREMENT, g GEOMETRY NOT NULL);

INSERT INTO intersection_results(g)
VALUES
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 5,6 4))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(4 6,6 6,6 4,4 4,4 6))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10))),POINT(1 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(7 6,6 6,6 7,7 7,7 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(7 6,6 6,6 7,7 7,7 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6))),POINT(1 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 5,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 4,4 4,4 6)))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 5,6 4))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(4 6,6 6,6 4,4 4,4 6))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10))),POINT(1 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(7 6,6 6,6 7,7 7,7 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(7 6,6 6,6 7,7 7,7 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6))),POINT(1 1))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 5,6 4)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 1,0 0,1 0,1 1,0 1)),((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 4,4 4,4 6)))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 5,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 5,6 4,4 4,4 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(6 4,4 4,4 6,6 6,6 5,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 5,6 4,4 4,4 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('POLYGON((10 10,0 10,0 0,10 0,10 10),(5 5,6 5,6 4,4 4,4 6,5 6,5 5))')),
(ST_GEOMFROMTEXT('POLYGON((10 10,0 10,0 0,10 0,10 10),(5 5,6 5,6 4,4 4,4 6,5 6,5 5))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 5,6 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(4 6,6 6,6 4,4 4,4 6))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 4,4 4,4 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POLYGON((0 1,0 0,1 0,1 1,0 1))')),
(ST_GEOMFROMTEXT('POLYGON((0 10,0 0,10 0,10 10,0 10),(4 6,6 6,6 4,4 4,4 6))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((5 10,5 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('MULTIPOLYGON(((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 4,4 4,4 6)),((1 0,1 1,0 1,0 0,1 0)))')),
(ST_GEOMFROMTEXT('POLYGON((10 10,0 10,0 0,10 0,10 10),(5 6,5 5,6 5,6 4,4 4,4 6,5 6))')),
(ST_GEOMFROMTEXT('POLYGON((10 10,0 10,0 0,10 0,10 10),(5 6,5 5,4 4,4 6,5 6))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 4,4 4,4 6))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10))),POINT(1 1))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6))),POINT(1 1))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2)')),
(ST_GEOMFROMTEXT('POINT(1 1)')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('MULTIPOINT((1 1),(2 2))')),
(ST_GEOMFROMTEXT('MULTILINESTRING((1 1,2 2),(3 3,4 4))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10))),POINT(1 1))')),
(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOLYGON(((5 10,5 6,6 6,6 5,10 5,10 10,5 10),(6 6,6 7,7 7,7 6,6 6))),POINT(1 1))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 5,6 4))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(4 6,6 6,6 4,4 4,4 6))')),
(ST_GEOMFROMTEXT('POLYGON((1 10,1 1,10 1,10 10,1 10),(6 4,4 4,4 6,6 6,6 4))'));

CREATE TABLE intersection (pk INT PRIMARY KEY AUTO_INCREMENT, g GEOMETRY NOT NULL);

INSERT INTO intersection SELECT 0, ST_INTERSECTION(a.g, b.g) FROM t1 AS a JOIN t1 AS b ORDER BY a.pk, b.pk;

SELECT SUM(ST_EQUALS(a.g, b.g)) FROM intersection AS a, intersection_results AS b WHERE a.pk = b.pk;

--echo #clean up
DROP TABLE gis_geometrycollection;
DROP TABLE gis_geometrycollection_2;
DROP TABLE t1;
DROP TABLE intersection;
DROP TABLE intersection_results;

--echo #
--echo # Bug#21927558 ST_INTERSECTION(POLYGON, POLYGON) RETURNS SELF
--echo # INTERSECTING POLYGON
--echo #
# BOOST upgrade (from 1.77 to 1.84)
# Small differences between Boost 1.77.0 and Boost 1.84.0. One extra point with Boost 1.84.0. Both results seem wrong.
SELECT ST_ASTEXT(ST_INTERSECTION(ST_GEOMFROMTEXT('POLYGON((6 7,18
14,-8 1,0 0,18 -8,6 7),(6 0,-4 3,5 3,6 0))'),
ST_GEOMFROMTEXT('MULTIPOLYGON(((2 3,-3 5,-10 -1,2 3)))')));

--echo #
--echo # WL#8579 Spatial Reference Systems
--echo #

--echo # SRID 0 (should pass)
SELECT ST_ASTEXT(ST_INTERSECTION(
  ST_GEOMFROMTEXT('POINT(0 0)', 0),
  ST_GEOMFROMTEXT('POINT(0 0)', 0)
));

--echo # Projected SRS (should pass)
SELECT ST_ASTEXT(ST_INTERSECTION(
  ST_GEOMFROMTEXT('POINT(0 0)', 2000),
  ST_GEOMFROMTEXT('POINT(0 0)', 2000)
));

--echo # Geographic SRS (should pass)
SELECT ST_ASTEXT(ST_INTERSECTION(
  ST_GEOMFROMTEXT('POINT(0 0)', 4326),
  ST_GEOMFROMTEXT('POINT(0 0)', 4326)
));

--echo #
--echo # Bug #25510403 SRID OF RESULT OF SET OPERATION IS DIFFERENT FROM INPUT
--echo # GEOMETRIES
--echo #

SELECT ST_SRID(ST_Intersection(
  ST_GeomFromText('LINESTRING(0 0, 10 10)', 2000),
  ST_GeomFromText('POINT(5 5)', 2000)
)) AS result;

SELECT ST_SRID(ST_Intersection(
  ST_GeomFromText('LINESTRING(0 0, 10 10)', 2000),
  ST_GeomFromText('LINESTRING(5 5, 15 15)', 2000)
)) AS result;

SELECT ST_SRID(ST_Intersection(
  ST_GeomFromText('LINESTRING(0 0,10 10)', 2000),
  ST_GeomFromText('POLYGON((20 20,20 25,25 25,25 20,20 20))', 2000)
)) AS result;

SELECT ST_SRID(ST_Intersection(
  ST_GeomFromText('LINESTRING(0 0, 10 10)', 2000),
  ST_GeomFromText('MULTIPOINT(5 5, 15 15)', 2000)
)) AS result;

SELECT ST_SRID(ST_Intersection(
  ST_GeomFromText('LINESTRING(0 0,10 10)', 2000),
  ST_GeomFromText('MULTILINESTRING((-5 -5,0 0),(0 0,10 10))', 2000)
)) AS result;

SELECT ST_SRID(ST_Intersection(
  ST_GeomFromText('LINESTRING(0 0,10 10)', 2000),
  ST_GeomFromText('MULTIPOLYGON(((20 20,20 25,25 25,25 20,20 20)))', 2000)
)) AS result;

SELECT ST_SRID(ST_Intersection(
  ST_GeomFromText('LINESTRING(0 0, 10 10)', 2000),
  ST_GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 1,1 1,0 0)))', 2000)
)) AS result;

--echo #
--echo # WL#11096 Don't do Cartesian computations on geographic geometries
--echo #

--echo # Assume SRID 10 is not defined.
--error ER_SRS_NOT_FOUND
DO ST_INTERSECTION(
  x'0A000000010100000000000000000000000000000000000000',
  x'0A000000010100000000000000000000000000000000000000'
);
