RESET MASTER;
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
DROP TABLE t1;
set session session_track_gtids='own_gtid';
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:3

INSERT INTO t1 VALUES (1);
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:4

set session session_track_gtids='all_gtids';
SELECT * FROM t1;
c1
1
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-4

DROP TABLE t1;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-5

set session session_track_gtids='off';
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-5

RESET MASTER;
SELECT @@server_uuid;
@@server_uuid
00000000-1111-0000-1111-000000000000
SET SESSION SESSION_TRACK_GTIDS=OFF;
SET SESSION GTID_NEXT='11111111-AAAA-2222-BBBB-000000000000:1';
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
SET SESSION GTID_NEXT=AUTOMATIC;
SET SESSION SESSION_TRACK_GTIDS=OWN_GTID;
SET SESSION GTID_NEXT='11111111-AAAA-2222-BBBB-111111111111:1';
CREATE TABLE t2 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_GTIDS
-- 11111111-aaaa-2222-bbbb-111111111111:1

SET SESSION GTID_NEXT=AUTOMATIC;
SET SESSION SESSION_TRACK_GTIDS=ALL_GTIDS;
CREATE TABLE t3 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1,
11111111-aaaa-2222-bbbb-000000000000:1,
11111111-aaaa-2222-bbbb-111111111111:1

DROP TABLE t1, t2, t3;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-2,
11111111-aaaa-2222-bbbb-000000000000:1,
11111111-aaaa-2222-bbbb-111111111111:1

SET SESSION SESSION_TRACK_GTIDS= OFF;
RESET MASTER;
SET SESSION SESSION_TRACK_GTIDS=ALL_GTIDS;
RESET MASTER;
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1

BEGIN;
INSERT INTO t1 VALUES (1);
COMMIT;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-2

BEGIN;
INSERT INTO t1 VALUES (2);
CREATE TABLE t2 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-4

INSERT INTO t2 VALUES (1);
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-5

SELECT * FROM t1;
c1
1
2
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-5

BEGIN;
INSERT INTO t1 VALUES (2);
SAVEPOINT s;
INSERT INTO t1 VALUES (3);
ROLLBACK TO SAVEPOINT s;
ROLLBACK;
DROP TABLE t1, t2;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-6

SET SESSION SESSION_TRACK_GTIDS=OWN_GTID;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1-6

RESET MASTER;
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:1

BEGIN;
INSERT INTO t1 VALUES (1);
COMMIT;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:2

BEGIN;
INSERT INTO t1 VALUES (2);
CREATE TABLE t2 (c1 INT) Engine=InnoDB;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:3-4

INSERT INTO t2 VALUES (1);
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:5

SELECT * FROM t1;
c1
1
2
BEGIN;
INSERT INTO t1 VALUES (2);
SAVEPOINT s;
INSERT INTO t1 VALUES (3);
ROLLBACK TO SAVEPOINT s;
ROLLBACK;
DROP TABLE t1, t2;
-- Tracker : SESSION_TRACK_GTIDS
-- 00000000-1111-0000-1111-000000000000:6

SET SESSION SESSION_TRACK_GTIDS=OFF;
RESET MASTER;
CREATE TABLE t1 (c1 INT) Engine=InnoDB;
BEGIN;
INSERT INTO t1 VALUES (1);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES (2);
CREATE TABLE t2 (c1 INT) Engine=InnoDB;
INSERT INTO t2 VALUES (1);
SELECT * FROM t1;
c1
1
2
BEGIN;
INSERT INTO t1 VALUES (2);
SAVEPOINT s;
INSERT INTO t1 VALUES (3);
ROLLBACK TO SAVEPOINT s;
ROLLBACK;
DROP TABLE t1, t2;
